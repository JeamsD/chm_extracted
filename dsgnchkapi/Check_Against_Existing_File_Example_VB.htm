<html>

<head>
<title>Check Against Existing File Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title></title>
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,design checks">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Check Against Existing File Example (VBA)</h1>
<p>This example shows how to use the Design Checker API to check against an 
existing file.</p>

<p class="APICODE">
'----------------------------------------------------------------------------<br>
' Preconditions:</p>
<p class="APICODE">'&nbsp; 1. Load the SOLIDWORKS Design Checker add-in<br>
'&nbsp;&nbsp;&nbsp;&nbsp; (click <b>Tools &gt; Add-ins &gt; SOLIDWORKS Design Checker</b>).<br>
'&nbsp; 2. Open a part document.<br>
'&nbsp; 3. Reference the SOLIDWORKS Design Checker type library<br>
'&nbsp;&nbsp;&nbsp;&nbsp; (in the IDE, click <b>Tools &gt; References &gt; SOLIDWORKS 
Design<br>
'&nbsp;&nbsp;&nbsp;&nbsp; Checker </b> <i>&lt;version&gt;</i><b> Type Library</b>).<br>
'&nbsp; 4. Open the Immediate window.<br>
'<br>
' Postconditions:<br>
'&nbsp; 1. Select <b>Drawing (*.drw;*.slddrw)</b> and<br>
'&nbsp;&nbsp;&nbsp;&nbsp; <i>public_documents</i><b>\samples\tutorial\advdrawings\FoodProcessor.slddrw<br>
</b>'&nbsp;&nbsp;&nbsp;&nbsp; from the pop-up file 
dialog.<br>
'&nbsp; 2. Check Builder launches and creates checks from the selected <br>
'&nbsp;&nbsp;&nbsp;&nbsp; drawing 
document.<br>
'&nbsp; 3. Design Checker uses the checks to validate the active document<br>
'&nbsp;&nbsp;&nbsp;&nbsp; and 
posts its results on a tab in the SOLIDWORKS Task Pane.<br>
'----------------------------------------------------------------------------</p>
<p class="APICODE">Option Explicit</p>
<p class="APICODE">Sub main()</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Dim swApp As SldWorks.SldWorks<br>
&nbsp;&nbsp;&nbsp; Dim swDCAddIn&nbsp; As DesignCheckerLib.SWDesignCheck</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; ' Get the SOLIDWORKS application<br>
&nbsp;&nbsp;&nbsp; Set swApp = Application.SldWorks</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; ' 
			Get the SOLIDWORKS Design Checker add-in<br>
&nbsp;&nbsp;&nbsp; ' Recommended to use the version-specific ProgID for your 
version of Design Checker<br>
&nbsp;&nbsp;&nbsp; ' e.g., &quot;SWDesignChecker.SWDesignCheck.<i>yyyy</i>&quot;; See the 
Remarks section in ISWDesignCheck help<br>
&nbsp;&nbsp;&nbsp; Set swDCAddIn = 
swApp.<b>GetAddInObject</b>(&quot;SWDesignChecker.SWDesignCheck&quot;)</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; If swDCAddIn Is Nothing Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print &quot;No 
SOLIDWORKS Design Checker add-in.&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<br>
&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; ' Select file, build checks, and validate 
the active document<br>
&nbsp;&nbsp;&nbsp; swDCAddIn.<b>CheckAgainstExistingFile</b><br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">End Sub</p>

</body>

</html>
