<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>ModelDoc::GetDependencies</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1969>
<meta name=layout-width content=731>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="../ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1>ModelDoc::GetDependencies</h1>

<p><font style="color: #ff0000;"
		color=#FF0000>This method is obsolete and has been superseded by 
 </font><a href="ModelDoc__GetDependencies2.htm">ModelDoc::GetDependencies2</a><font 
 style="color: #ff0000;"
	color=#FF0000>.</font></p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiDescriptionHeading>Description</p>

<p>This method gets all of the model's dependencies. </p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxOLEHeading>Syntax (OLE Automation)</p>

<p><span style="font-weight: bold;">retval = ModelDoc.GetDependencies ( 
 traverseflag, Unused)</span></p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(long) traverseflag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to traverse down into all dependent files, FALSE if 
 you want only the highest level within the dependencies</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(long) SearchFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to use the search rules to find dependencies, FALSE 
 looks where the documents were last saved</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Return:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(VARIANT) retval</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>VARIANT of type SafeArray of strings; there are two strings for each 
 document returned in this list of dependent files; the first is the file 
 name and the second is the filename with the complete path name; this 
 combination repeats itself for each dependent file found for this ModelDoc</td></tr>
</table>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxCOMHeading>Syntax (COM)</p>

<p><span style="font-weight: bold;">status = ModelDoc-&gt;IGetDependencies 
 ( traverseflag, Unused, &amp;retval )</span></p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(long) traverseflag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to traverse down into all dependent files, FALSE if 
 you want only the highest level within the dependencies</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(long) SearchFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to use the search rules to find dependencies, FALSE 
 looks where the documents were last saved</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Output:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(BSTR) retval</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>Array of strings; there are two strings for each document returned in 
 this list of dependent files; the first is the file name and the second 
 is the filename with the complete path name; this combination repeats 
 itself for each dependent file found for this ModelDoc</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Return:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(HRESULT) status</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>S_OK if successful</td></tr>
</table>

<p style="margin-left: 207.00pt; text-indent: -207.00pt;">&nbsp;</p>

<p style="margin-left: 207.00pt; text-indent: -207.00pt;">&nbsp;</p>

<p class=apiRemarksHeading>Remarks</p>

<p>Calling this method on a drawing document returns a list of all the 
 part and assemblies used in the drawing. If you set the traverseFlag to 
 TRUE, then each of the parts within the assembly file are also returned 
 in this array of strings.</p>

<p>Because a derived mirror part is generated from another part, the list 
 of model dependencies returned by this method would include the original 
 configuration the part used to generate the derived mirror part.</p>

<p>Library features are completely unassociated. They do not require the 
 library nor do they update when changes are made to the library feature. 
 Therefore, this method does not return library features.</p>

<p>For the COM implementation, call ModelDoc::GetNumDependencies first 
 to determine the number of strings to be returned.</p>

<p>If you use this methodwith an assembly that contains two documents, 
 <span style="font-style: italic;">Part1</span> and <span style="font-style: italic;">SubAssem1</span>, 
 an example of what might be returned is:</p>

<p>&nbsp;<span style="font-size: 14pt;">[</span> <span style="font-style: italic;">&quot;Part1&quot;, 
 &quot;C:\temp\Part1.SLDPRT&quot;, &quot;SubAssem1&quot;, &quot;c:\temp\SubAssem1.SLDASM&quot;</span> 
 <span style="font-size: 14pt;">]</span></p>

<p>If<span style="font-size: 14pt;"> </span>traverseFlag<span style="font-style: italic;"> 
 </span>is set to TRUE, then all of the documents contained in <span style="font-style: italic;">SubAssem1.ASM</span> 
 are <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->also 
 returned. Suppressed components are still recognized and returned by this 
 method as a dependent file.</p>

<p><span style="font-weight: bold;">NOTE:</span> The return value for file 
 references for assemblies containing suppressed or lightweight components 
 point to the as-saved component reference because the actual component 
 is not loaded into memory. Because the suppressed and lightweight components 
 are not actually loaded, SolidWorks does not apply current search criteria 
 to update the file references. Setting the SearchFlag argument to TRUE 
 vs. FALSE, causes this method to apply the current search criteria rules 
 to locate the particular reference and may result in a different return 
 value. Likewise, unsuppressing or resolving these components causes SolidWorks 
 to apply the current search criteria and update the assembly's component 
 references in memory, if necessary.</p>

<p>When calling this method with the seachFlag argument set to TRUE, you 
 may want to explicitly set the search folders first. This is important 
 because this method uses the current SolidWorks directory as its second 
 search criteria. Because the user may have interactively opened files 
 from some random directory, you cannot be certain that the current SolidWorks 
 directory is pointing at the desired location. You may want to set the 
 search folders to that of the document used. For example:</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p>// Get the current search folder settings so we can reset them later</p>

<p>&nbsp;VARIANT_BOOL currentSearchFolderSetting = FALSE;</p>

<p>&nbsp;BSTR currentSearchFolders = NULL;</p>

<p>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetUserPreferenceToggle 
 ( swUseFolderSearchRules, &amp;currentSearchFolderSetting );</p>

<p>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetSearchFolders ( swDocumentType, 
 &amp;currentSearchFolders );</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiCode>// Set the search folders to use the path of the document 
 </p>

<p class=apiCode>&nbsp;BSTR bdocName;</p>

<p class=apiCode>&nbsp;hres = pModelDoc-&gt;GetPathName(&amp;bdocName);</p>

<p class=apiCode>&nbsp;CString docName(bdocName);</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>&nbsp;VARIANT_BOOL ok = FALSE;</p>

<p class=apiCode>&nbsp;CString searchFolder = getFileLocation(docName);&nbsp;// 
 Function to extract directory from full filename</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, au2B(searchFolder), &amp;ok );&nbsp;&nbsp;</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>// Reset search folders to previous values</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetUserPreferenceToggle 
 ( swUseFolderSearchRules, currentSearchFolderSetting );</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, currentSearchFolders, &amp;ok );&nbsp;&nbsp;</p>

<p style="margin-bottom: 0;">
<!--Metadata type="DesignerControl" startspan
<object classid="clsid:A2F1FA63-C1E6-11d2-9140-006DC83B9955"
		type="application/x-oleobject"
		id=RelatedTopic0>
<param name="_Version" value="65536" >
<param name="_ExtentX" value="1323" >
<param name="_ExtentY" value="556" >
<param name="_StockProps" value="13" >
<param name="ForeColor" value="0" >
<param name="BackColor" value="13160660" >
<param name="UseButton" value="0" >
<param name="ControlLabel" value="See Also" >
<param name="UseIcon" value="0" >
<param name="Items" value="ModelDoc_Object$$**$$ZReferences$$**$$" >
<param name="Image" value="" >
<param name="FontInfo" value="MS Sans Serif,8,0,," >
<param name="_CURRENTFILEPATH" value="C:\Home\Oneill\sw2003\ModelDoc\ModelDoc__GetDependencies.htm" >
<param name="_ID" value="RelatedTopic0" >
<param name="DialogDisplay" value="0" >
<param name="Frame" value="" >
<param name="Window" value="" >
<param name="ChmFile" value="" >
<param name="DisableJump" value="0" >
</object>--><OBJECT
  CLASSID="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"
  ID="RelatedTopic0"  TYPE="application/x-oleobject">
  <PARAM  NAME="Command"  VALUE="ALink">
  <PARAM  NAME="Font"  VALUE="MS Sans Serif,8,0,,">
  <PARAM  NAME="Frame"  VALUE="">
  <PARAM  NAME="Item1"  VALUE="">
  <PARAM  NAME="Item2"  VALUE="ModelDoc_Object">
  <PARAM  NAME="Item3"  VALUE="ZReferences">
</OBJECT>
<!--Metadata type="DesignerControl" endspan-->
 
<!--Metadata type="DesignerControl" startspan
<object classid="clsid:A2F1FA63-C1E6-11d2-9140-006DC83B9955"
		type="application/x-oleobject"
		id=RelatedTopic1>
<param name="_Version" value="65536" >
<param name="_ExtentX" value="1217" >
<param name="_ExtentY" value="556" >
<param name="_StockProps" value="13" >
<param name="ForeColor" value="0" >
<param name="BackColor" value="13160660" >
<param name="UseButton" value="0" >
<param name="ControlLabel" value="See Also" >
<param name="UseIcon" value="0" >
<param name="Items" value="Get_Dependent_Documents_Example$$**$$Get_File_Dependencies_Example$$**$$" >
<param name="Image" value="" >
<param name="FontInfo" value="MS Sans Serif,8,0,," >
<param name="_CURRENTFILEPATH" value="C:\Home\Oneill\sw2003\ModelDoc\ModelDoc__GetDependencies.htm" >
<param name="_ID" value="RelatedTopic1" >
<param name="DialogDisplay" value="0" >
<param name="Frame" value="" >
<param name="Window" value="" >
<param name="ChmFile" value="" >
<param name="DisableJump" value="0" >
</object>--><OBJECT
  CLASSID="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"
  ID="RelatedTopic1"  TYPE="application/x-oleobject">
  <PARAM  NAME="Command"  VALUE="ALink">
  <PARAM  NAME="Font"  VALUE="MS Sans Serif,8,0,,">
  <PARAM  NAME="Frame"  VALUE="">
  <PARAM  NAME="Item1"  VALUE="">
  <PARAM  NAME="Item2"  VALUE="Get_Dependent_Documents_Example">
  <PARAM  NAME="Item3"  VALUE="Get_File_Dependencies_Example">
</OBJECT>
<!--Metadata type="DesignerControl" endspan-->
 </p>

</body>

</html>
