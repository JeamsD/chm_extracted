<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>ModelDoc::GetDependencies2</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1997>
<meta name=layout-width content=731>


<!--(Links)=========================================================-->

<link rel=StyleSheet href="../ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1>ModelDoc::GetDependencies2</h1>

<p style="margin-top: 0; margin-bottom: 0;"><font style="color: #ff0000;"
													color=#FF0000>This 
 method is obsolete and has been superseded by </font><a href="sldworksAPI.chm::/ModelDoc2/ModelDoc2__GetDependencies2.htm">ModelDoc2::GetDependencies2</a>.</p>

<p class=apiDescriptionHeading>Description</p>

<p class=apiDescriptionText>This method gets all of the model dependencies. 
 </p>

<p class=apiDescriptionText
	style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxOLEHeading>Syntax (OLE Automation)</p>

<p class=apiSyntaxOLE>retval = ModelDoc.GetDependencies2 ( <font style="color: #000000;"
	color=#000000>traverseFlag, searchFlag, addReadOnlyInfo </font>)</p>

<p style="margin-left: 4.50pt;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(BOOL) traverseFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to traverse down into all dependent files, FALSE if 
 you want only the highest level within the dependencies</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(BOOL) searchFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to use the search rules to find dependencies, FALSE 
 looks where the documents were last saved</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(BOOL) addReadOnlyInfo</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to show read-only information in the returned strings</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Return:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(VARIANT) retval</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>VARIANT of type SafeArray of strings; there will be two strings for 
 each document returned in this list of dependent files; the first is the 
 file name and the second is the filename with the complete path name; 
 this combination repeats itself for each dependent file found for this 
 ModelDoc</td></tr>
</table>

<p class=apiParametersOLE
	style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxCOMHeading>Syntax (COM)</p>

<p class=apiSyntaxCOM>status = ModelDoc-&gt;IGetDependencies2 ( traverseflag, 
 searchflag, addReadOnlyInfo, retval )</p>

<p style="margin-left: 4.50pt;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(VARIANT_BOOL) traverseFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to traverse down into all dependent files, FALSE if 
 you want only the highest level within the dependencies</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(VARIANT_BOOL) searchFlag</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to use the search rules to find dependencies, FALSE 
 looks where the documents were last saved</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Input:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(VARIANT_BOOL) addReadOnlyInfo</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>TRUE if you wish to show read-only information in the returned strings</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Output:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(BSTR*) retval</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>Array of strings; there will be two strings for each document returned 
 in this list of dependent files; the first is the file name and the second 
 is the filename with the complete path name; this combination repeats 
 itself for each dependent file found for this ModelDoc</td></tr>

<tr style="x-cell-content-align: top;"
	valign=top>
<td style="width: 77px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=77px>
<p>Return:</td>
<td style="width: 192px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=192px>
<p>(HRESULT) status</td>
<td style="width: 443px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=443px>
<p>S_OK if successful</td></tr>
</table>

<p class=apiParametersCOM
	style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiRemarksHeading>Remarks</p>

<p class=apiRemarksText>Calling this method on a drawing document returns 
 a list of all the part and assemblies used in the drawing. If you set 
 the traverseFlag to TRUE, then each of the parts within the assembly file 
 are also returned in this array of strings.</p>

<p>Because a derived mirror part is generated from another part, the list 
 of model dependencies returned by this method would include the original 
 configuration the part used to generate the derived mirror part.</p>

<p>Library features are completely unassociated. They do not require the 
 library nor do they update when changes are made to the library feature. 
 Therefore, this method does not return library features.</p>

<p>For the COM implementation, call ModelDoc::GetNumDependencies first 
 to determine the number of strings to be returned.</p>

<p>If you use this methodwith an assembly that contains two documents, 
 <span style="font-style: italic;">Part1</span> and <span style="font-style: italic;">SubAssem1</span>, 
 an example of what might be returned is:</p>

<p>&nbsp;<span style="font-size: 14pt;">[</span> <span style="font-style: italic;">&quot;Part1&quot;, 
 &quot;C:\temp\Part1.SLDPRT&quot;, &quot;SubAssem1&quot;, &quot;c:\temp\SubAssem1.SLDASM&quot;</span> 
 <span style="font-size: 14pt;">]</span></p>

<p>If<span style="font-size: 14pt;"> </span>traverseFlag<span style="font-style: italic;"> 
 </span>is set to TRUE, then all of the documents contained in <span style="font-style: italic;">SubAssem1.ASM</span> 
 are <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->also 
 returned. Suppressed components are still recognized and returned by this 
 method as a dependent file.</p>

<p><span style="font-weight: bold;">NOTE:</span> The return value for file 
 references for assemblies containing suppressed or lightweight components 
 point to the as-saved component reference because the actual component 
 is not loaded into memory. Because the suppressed and lightweight components 
 are not actually loaded, SolidWorks does not apply current search criteria 
 to update the file references. Setting the SearchFlag argument to TRUE 
 vs. FALSE, causes this method to apply the current search criteria rules 
 to locate the particular reference and may result in a different return 
 value. Likewise, unsuppressing or resolving these components causes SolidWorks 
 to apply the current search criteria and update the assembly's component 
 references in memory, if necessary.</p>

<p>When calling this method with the seachFlag argument set to TRUE, you 
 may want to explicitly set the search folders first. This is important 
 because this method uses the current SolidWorks directory as its second 
 search criteria. Because the user may have interactively opened files 
 from some random directory, you cannot be certain that the current SolidWorks 
 directory is pointing at the desired location. You may want to set the 
 search folders to that of the document used. For example:</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p>// Get the current search folder settings so we can reset them later</p>

<p>&nbsp;VARIANT_BOOL currentSearchFolderSetting = FALSE;</p>

<p>&nbsp;BSTR currentSearchFolders = NULL;</p>

<p>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetUserPreferenceToggle 
 ( swUseFolderSearchRules, &amp;currentSearchFolderSetting );</p>

<p>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetSearchFolders ( swDocumentType, 
 &amp;currentSearchFolders );</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiCode>// Set the search folders to use the path of the document 
 </p>

<p class=apiCode>&nbsp;BSTR bdocName;</p>

<p class=apiCode>&nbsp;hres = pModelDoc-&gt;GetPathName(&amp;bdocName);</p>

<p class=apiCode>&nbsp;CString docName(bdocName);</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>&nbsp;VARIANT_BOOL ok = FALSE;</p>

<p class=apiCode>&nbsp;CString searchFolder = getFileLocation(docName);&nbsp;// 
 Function to extract directory from full filename</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, au2B(searchFolder), &amp;ok );&nbsp;&nbsp;</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>// Reset search folders to previous values</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetUserPreferenceToggle 
 ( swUseFolderSearchRules, currentSearchFolderSetting );</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, currentSearchFolders, &amp;ok );</p>

</body>

</html>
