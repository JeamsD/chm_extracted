<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>ModelDoc2::GetDependencies</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=date content="06 26, 2002 3:54:52 PM">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1980>
<meta name=layout-width content=731>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="../ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1 style="margin-bottom: 0;"><!--Interface::PropertyOrMethod-->ModelDoc2::GetDependencies</h1>

<p class=apiSeeAlsoEtcHeading
	style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0;
			margin-bottom: 0;
			color: #ff0000;">This method is obsolete and has been superseded 
 by <a href="../ModelDoc/ModelDoc__GetDependencies2.htm">ModelDoc2::GetDependencies2</a>.</p>

<p class=apiDescriptionHeading>Description</p>

<p>This method gets all the model dependencies. </p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxOLEHeading>Syntax (OLE Automation)</p>

<p><span style="font-weight: bold;">retval = ModelDoc2.GetDependencies 
 ( traverseflag, Unused)</span></p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>
<col>
<col style="width: 145px;">
<col style="width: 491px;">

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Input:</td>
<td style="width: 145px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=145px>
<p>(long) traverseflag</td>
<td style="width: 491px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=491px>
<p>TRUE to traverse down into all dependent files, FALSE for only the highest 
 level within the dependencies</td></tr>

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Input:</td>
<td style="width: 145px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=145px>
<p>(long) SearchFlag</td>
<td style="width: 491px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=491px>
<p>TRUE to use the search rules to find dependencies, FALSE looks where 
 the documents were last saved</td></tr>

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Return:</td>
<td style="width: 145px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=145px>
<p>(VARIANT) retval</td>
<td style="width: 491px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=491px>
<p>VARIANT of type SafeArray of strings; there are two strings for each 
 document returned in this list of dependent files:</p>
<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p><p>first string is the file name </p></li>
	
	<li class=kadov-p><p>second string is the filename with the complete 
 pathname</p></li>
</ul>
<p>This combination repeats itself for each dependent file found for this 
 ModelDoc2.</td></tr>
</table>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=apiSyntaxCOMHeading>Syntax (COM)</p>

<p class=apiSyntaxCOM><span style="font-weight: bold;">status = ModelDoc2-&gt;IGetDependencies 
 ( traverseflag, Unused, &amp;retval )</span></p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="width: 712px;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=712>
<col>
<col style="width: 147px;">
<col style="width: 487px;">

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Input:</td>
<td style="width: 147px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=147px>
<p>(long) traverseflag</td>
<td style="width: 487px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=487px>
<p>TRUE to traverse down into all dependent files, FALSE for only the highest 
 level within the dependencies</td></tr>

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Input:</td>
<td style="width: 147px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=147px>
<p>(long) SearchFlag</td>
<td style="width: 487px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=487px>
<p>TRUE to use the search rules to find dependencies, FALSE looks where 
 the documents were last saved</td></tr>

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Output:</td>
<td style="width: 147px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=147px>
<p>(BSTR) retval</td>
<td style="width: 487px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=487px>
<p>VARIANT of type SafeArray of strings; there are two strings for each 
 document returned in this list of dependent files:</p>
<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p><p>first string is the file name </p></li>
	
	<li class=kadov-p><p>second string is the filename with the complete 
 path name</p></li>
</ul>
<p>This combination repeats itself for each dependent file found for this 
 ModelDoc2.</td></tr>

<tr>
<td style="padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;">
<p>Return:</td>
<td style="width: 147px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=147px>
<p>(HRESULT) status</td>
<td style="width: 487px;
			padding-left: 1px;
			padding-top: 1px;
			padding-right: 1px;
			padding-bottom: 1px;"
	width=487px>
<p>S_OK if successful</td></tr>
</table>

<p style="margin-left: 207.00pt; text-indent: -207.00pt;">&nbsp;</p>

<p style="margin-left: 207.00pt; text-indent: -207.00pt;">&nbsp;</p>

<p class=apiRemarksHeading>Remarks</p>

<p>Calling this method on a drawing document returns a list of all the 
 parts and assemblies used in the drawing. If you set traverseFlag to TRUE, 
 then each of the parts within the Assembly file is also returned in this 
 array of strings.</p>

<p>Because a derived mirror part is generated from another part, the list 
 of model dependencies returned by this method would include the original 
 the part used to generate the derived mirror part.</p>

<p>Library features are completely unassociated. They do not require the 
 library nor do they update when changes are made to the Library feature. 
 Therefore, this method does not return Library features.</p>

<p>For the COM implementation, see ModelDoc2::GetNumDependencies to determine 
 the number of strings to return.</p>

<p>If you use this method with an assembly that contains two documents, 
 Part1 and SubAssem1, an example of what might be returned is:</p>

<p>&nbsp;<span style="font-size: 14pt;">[</span> &quot;Part1&quot;, &quot;C:\temp\Part1.SLDPRT&quot;, 
 &quot;SubAssem1&quot;, &quot;c:\temp\SubAssem1.SLDASM&quot; <span style="font-size: 14pt;">]</span></p>

<p>If<span style="font-size: 14pt;"> </span>traverseFlag is<span style="font-style: italic;"> 
 </span>set to TRUE, then all the documents contained in SubAssem1.ASM 
 are returned. Also, suppressed components are recognized and returned 
 by this method as a dependent file.</p>

<p><span style="font-weight: bold;">NOTE</span><span style="font-weight: bold; font-style: italic;">:</span> 
 For assemblies containing suppressed or lightweight components, file references 
 (return value from this method) point to the as-saved component reference 
 because the actual component has not been loaded into memory. Because 
 the suppressed and lightweight components have not actually been loaded, 
 the current search criteria has not been applied to update the file references. 
 Setting SearchFlag to TRUE vs. FALSE, causes this method to apply the 
 current search criteria rules to locate the particular reference and may 
 result in a different return value. Likewise, unsuppressing or resolving 
 these components causes the current search criteria to be applied and 
 updates the assembly's component references in memory, if necessary.</p>

<p>When calling this method with SeachFlag set to TRUE, you can explicitly 
 set the search folders first. This is important because this method uses 
 the current SolidWorks directory as its second search criteria. Because 
 the user may have interactively opened files from some random directory, 
 you cannot be certain the current SolidWorks directory is pointing to 
 the desired location. You may want to consider setting the search folders 
 to that of the document being used in this method. For example:</p>

<p class=apiCode>// Get the current search folder settings so we can reset 
 them later</p>

<p class=apiCode>&nbsp;VARIANT_BOOL currentSearchFolderSetting = FALSE;</p>

<p class=apiCode>&nbsp;BSTR currentSearchFolders = NULL;</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetUserPreferenceToggle 
 ( swUseFolderSearchRules, &amp;currentSearchFolderSetting );</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;GetSearchFolders 
 ( swDocumentType, &amp;currentSearchFolders );</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>// Set the search folders to use the path of the document 
 being queried with GetDependencies</p>

<p class=apiCode>&nbsp;BSTR bdocName;</p>

<p class=apiCode>&nbsp;hres = pModelDoc2-&gt;GetPathName(&amp;bdocName);</p>

<p class=apiCode>&nbsp;CString docName(bdocName);</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>&nbsp;VARIANT_BOOL ok = FALSE;</p>

<p class=apiCode>&nbsp;CString searchFolder = getFileLocation(docName);&nbsp;// 
 function to extract directory from full filename</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, au2B(searchFolder), &amp;ok );&nbsp;&nbsp;</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>// Reset search folders to previous values</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetUserPreferenceToggle 
 ( swUseFolderSearchRules, currentSearchFolderSetting );</p>

<p class=apiCode>&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;SetSearchFolders 
 ( swDocumentType, currentSearchFolders, &amp;ok );&nbsp;&nbsp;</p>

<p style="margin-bottom: 0;">
<!--Metadata type="DesignerControl" startspan
<object classid="clsid:A2F1FA63-C1E6-11d2-9140-006DC83B9955"
		type="application/x-oleobject"
		id=RelatedTopic2
		style="width: 1px; height: 1px;"
		width=1
		height=1>
<param name="_Version" value="65536" >
<param name="_ExtentX" value="26" >
<param name="_ExtentY" value="26" >
<param name="_StockProps" value="13" >
<param name="ForeColor" value="0" >
<param name="BackColor" value="13160660" >
<param name="UseButton" value="0" >
<param name="ControlLabel" value="See Also" >
<param name="UseIcon" value="0" >
<param name="Items" value="ZReleaseNotes2001Plus$$**$$" >
<param name="Image" value="" >
<param name="FontInfo" value="MS Sans Serif,8,0,," >
<param name="_CURRENTFILEPATH" value="D:\APIHelp\sw2003\ModelDoc2\ModelDoc2__GetDependencies.htm" >
<param name="_ID" value="RelatedTopic2" >
<param name="DialogDisplay" value="0" >
<param name="Frame" value="" >
<param name="Window" value="" >
<param name="ChmFile" value="" >
<param name="DisableJump" value="0" >
</object>-->
<OBJECT
  CLASSID="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"
  ID="RelatedTopic2"  TYPE="application/x-oleobject">
  <PARAM  NAME="Command"  VALUE="ALink">
  <PARAM  NAME="Font"  VALUE="MS Sans Serif,8,0,,">
  <PARAM  NAME="Frame"  VALUE="">
  <PARAM  NAME="Item1"  VALUE="">
  <PARAM  NAME="Item2"  VALUE="ZReleaseNotes2001Plus">
</OBJECT>

<!--Metadata type="DesignerControl" endspan-->
 
<!--Metadata type="DesignerControl" startspan
<object classid="clsid:A2F1FA63-C1E6-11d2-9140-006DC83B9955"
		type="application/x-oleobject"
		id=RelatedTopic1
		style="width: 1px; height: 1px;"
		width=1
		height=1>
<param name="_Version" value="65536" >
<param name="_ExtentX" value="26" >
<param name="_ExtentY" value="26" >
<param name="_StockProps" value="13" >
<param name="ForeColor" value="0" >
<param name="BackColor" value="13160660" >
<param name="UseButton" value="0" >
<param name="ControlLabel" value="See Also" >
<param name="UseIcon" value="0" >
<param name="Items" value="ModelDoc2_Object$$**$$" >
<param name="Image" value="" >
<param name="FontInfo" value="MS Sans Serif,8,0,," >
<param name="_CURRENTFILEPATH" value="D:\APIHelp\sw2003\ModelDoc2\ModelDoc2__GetDependencies.htm" >
<param name="_ID" value="RelatedTopic1" >
<param name="DialogDisplay" value="0" >
<param name="Frame" value="" >
<param name="Window" value="" >
<param name="ChmFile" value="" >
<param name="DisableJump" value="0" >
</object>-->
<OBJECT
  CLASSID="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"
  ID="RelatedTopic1"  TYPE="application/x-oleobject">
  <PARAM  NAME="Command"  VALUE="ALink">
  <PARAM  NAME="Font"  VALUE="MS Sans Serif,8,0,,">
  <PARAM  NAME="Frame"  VALUE="">
  <PARAM  NAME="Item1"  VALUE="">
  <PARAM  NAME="Item2"  VALUE="ModelDoc2_Object">
</OBJECT>

<!--Metadata type="DesignerControl" endspan-->
 </p>

</body>

</html>
