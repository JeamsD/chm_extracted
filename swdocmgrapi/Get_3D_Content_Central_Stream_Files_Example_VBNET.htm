<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Get 3D Content Central Stream Files Example (VB.NET)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta NAME=MS-HKWD CONTENT="VB.NET examples,XML stream">
<meta NAME=MS-HKWD CONTENT="VB.NET examples,documents">
<meta NAME=MS-HKWD CONTENT="VB.NET examples,3DCC XML stream">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1865>
<meta name=layout-width content=1395>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1 class=APICODE><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS 
 Document Manager API Help</span></h1>

<h1>Get 3D Content Central Stream Files Example (VB.NET)</h1>

<p><font face="Verdana">This example builds a design table and configuration 
rules into a SOLIDWORKS document and then demonstrates how to get the configuration rules out in two XML formats:</font></p>

<p><font face="Verdana">&nbsp;<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->* 
 original (3DCC) format</font></p>

<p><font face="Verdana">&nbsp;<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->* 
 generic (multi-use) format</font></p>

<p>&nbsp;</p>
<p><font face="Courier New" size="2">'------------------------------------------------------------------------</font></p>

<p><font face="Courier New" size="2">' Preconditions:</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->1. 
 Read the SOLIDWORKS Document Manager API <b>Getting Started </b></font></p>
<p><font face="Courier New" size="2"><b>'&nbsp;&nbsp;&nbsp;&nbsp; </b>topic and ensure 
 that the required DLLs have been registered.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->&nbsp;2. 
 Ensure that the latest <span style="font-weight: bold;">SolidWorks.Interop.swdocumentmgr.dll</span> 
 </font> </p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; 
 interop assembly is loaded in the project. </font> </p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->
&nbsp;&nbsp;&nbsp;&nbsp;(Right-click the project in Project Explorer, click <b>Add Reference</b>, </font> </p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->click 
 the interop assembly on the .NET tab, or browse for </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; the DLL in
<span 
 style="font-style: italic;">install_dir</span><span style="font-weight: bold;">\api\redist.</span>)</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;3. 
 Open the document specified in <span style="font-weight: bold;">sDocFileName</span> 
 below </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; and add a design 
table (<b>Insert &gt; Tables &gt; Design Table</b>).</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->4. 
 Click the green check mark to accept the design table defaults.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->5. 
 Multi-select the dimensions or parameters in the document </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; to use in the 
 design table.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;6. 
 Click the <b>ConfigurationManager</b> tab and right-click the </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; configuration 
 name at the top.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->7. 
 Select <b>Configuration Publisher </b>on the shortcut menu. </font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->8. 
 Create rules that are functions of design table parameters, </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; setting values 
 as appropriate.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;(To 
 learn how to create rules, read the 3D Content Central online </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; help: <b>http://www.3dcontentcentral.com.</b>)</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->9. 
 Click <b>Apply</b> and <b>Close</b>.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->10. 
 Save the document to another name.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;NOTE: 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Because 
 the specified document is used in SOLIDWORKS </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; tutorials, do not save changes 
 to the original file name.</font></p>

<p><font face="Courier New" size="2">' 11. 
 Update the <span style="font-weight: bold;">sDocFileName</span> in the 
 code below to reference the </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; new document.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{</spaces>}}-->12. 
 Update <span style="font-weight: bold;">sLicenseKey</span> in the code 
 below with your license key.</font></p>

<p><font face="Courier New" size="2">'</font></p>

<p><font face="Courier New" size="2">' Postconditions:</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;1. 
 Inspect the Immediate window error codes.</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->2. 
 If error codes are 0, inspect the directory where </font></p>
<p><font face="Courier New" size="2">'&nbsp;&nbsp;&nbsp;&nbsp; the part is located 
 to find</font></p>

<p><font face="Courier New" size="2">' <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}--><b>motor casing_generic.xml</b> and 
<b>motor casing.xml</b>.</font></p>

<p><font face="Courier New" size="2">'------------------------------------------------------------------</font></p>

<p><font face="Courier New" size="2">Imports SolidWorks.Interop.sldworks</font></p>

<p><font face="Courier New" size="2">Imports SolidWorks.Interop.swconst</font></p>

<p><font face="Courier New" size="2">Imports SolidWorks.Interop.swdocumentmgr</font></p>

<p><font face="Courier New" size="2">Imports System</font></p>

<p><font face="Courier New" size="2">Imports System.Diagnostics</font></p>

<p><font face="Courier New" size="2">Partial Class SolidWorksMacro</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Sub 
 main()</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Const 
 <span style="font-weight: bold;">sLicenseKey</span> As String = &quot;<span 
 style="font-style: italic;">your_license_key</span>&quot; 'Specify your 
 license key</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Const 
 <span style="font-weight: bold;">sDocFileName</span> As String = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 
2018\samples\tutorial\advdrawings\motor casing.SLDASM&quot;</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swClassFact As SwDMClassFactory</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swDocMgr As SwDMApplication</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swDoc As SwDMDocument14</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 nDocType As SwDmDocumentType</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 sPathName As String</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 gPathName As String</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 nRetVal As Integer</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Determine type of SOLIDWORKS file based on file extension</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->If 
 InStr(LCase(sDocFileName), &quot;sldprt&quot;) &gt; 0 Then</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->nDocType 
 = SwDmDocumentType.swDmDocumentPart</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->ElseIf 
 InStr(LCase(sDocFileName), &quot;sldasm&quot;) &gt; 0 Then</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->nDocType 
 = SwDmDocumentType.swDmDocumentAssembly</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->ElseIf 
 InStr(LCase(sDocFileName), &quot;slddrw&quot;) &gt; 0 Then</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->nDocType 
 = SwDmDocumentType.swDmDocumentDrawing</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Else</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Probably not a SW file</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->nDocType 
 = SwDmDocumentType.swDmDocumentUnknown</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 So cannot open</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Exit 
 Sub</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->End 
 If</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Strip off SOLIDWORKS file extension (sldxxx)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 and add XML extension (xml)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->sPathName 
 = Left(sDocFileName, Len(sDocFileName) - 7)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->sPathName 
 = sPathName + &quot;.xml&quot;</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->gPathName 
 = Left(sDocFileName, Len(sDocFileName) - 7)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->gPathName 
 = gPathName + &quot;_generic.xml&quot;</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swClassFact 
 = CreateObject(&quot;SwDocumentMgr.SwDMClassFactory&quot;)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swDocMgr 
 = swClassFact.GetApplication(sLicenseKey)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swDoc 
 = swDocMgr.GetDocument(sDocFileName, nDocType, False, nRetVal)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 Err As SwDmXmlDataError</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Err 
 = swDoc.<span style="font-weight: bold;">Get3DCCStreamFile(</span>sPathName<span 
 style="font-weight: bold;">)</span></font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Debug.Print(&quot;Original 
 (3DCC) format SwDmXmlDataError: &quot; &amp; Err)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Err 
 = swDoc.<span style="font-weight: bold;">Get3DCCGenericStreamFile(</span>gPathName<span 
 style="font-weight: bold;">)</span></font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Debug.Print(&quot;Generic 
 format SwDmXmlDataError: &quot; &amp; Err)</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swDoc.CloseDoc()</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->End 
 Sub</font></p>

<p><font face="Courier New" size="2"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Public 
 swApp As SldWorks</font></p>

<p><font face="Courier New" size="2">End Class</font></p>

</body>

</html>
