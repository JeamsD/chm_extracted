<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Write Parasolid Partition Stream to File Example (C++)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta NAME=MS-HAID CONTENT=EXWritePartitionStreamCPlusPlus>
<meta NAME=MS-HKWD CONTENT="C++ examples,Parasolid partition stream">
<meta NAME=MS-HKWD CONTENT="C++ examples">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1190>
<meta name=layout-width content=916>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS Document Manager API Help</span></h1>
<h1>Write Parasolid Partition Stream to File Example (C++)</h1>

<p>This example shows how to write a Parasolid partition stream to a file 
 using the SOLIDWORKS Document Manager API. </p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode>#import 'C:\Program Files\Common Files\SOLIDWORKS Shared\swdocumentmgr.dll' 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->raw_interfaces_only, 
 raw_native_types, no_namespace, named_guids //Change as necessary</p>

<p><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode>wchar_t* filename = &quot;87-part.sldprt&quot;</p>

<p class=apiCode>wchar_t* outputDir = &quot;c:\\caddocs\\&quot;;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode>ISwDMClassFactoryPtr swClassFact;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->swClassFact.CreateInstance( 
 </p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->__uuidof(SwDMClassFactory) 
 );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->if 
 (!(ISwDMClassFactory*)swClassFact)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->return 
 0;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->ISwDMApplicationPtr 
 swDocMgr( </p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->swClassFact-&gt;<span 
 style="font-weight: bold;">GetApplication</span>(&quot;<span style="font-style: italic;">your_license_key</span>&quot;) 
 ); //Specify your license 
 key</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->if 
 (!(ISwDMApplication*)swDocMgr)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->return 
 0;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->SwDmDocumentOpenError 
 error;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->ISwDMDocumentPtr 
 swDoc( swDocMgr-&gt;<span style="font-weight: bold;">GetDocument</span>( 
 </p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->filename, 
 swDmDocumentPart, TRUE, &amp;error ) );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->if 
 (!(ISwDMDocument*)swDoc)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->return 
 0;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->ISwDMConfigurationMgrPtr 
 swCfgMgr( </p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->swDoc-&gt;<span 
 style="font-weight: bold;">ConfigurationManager</span> );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->if 
 (!(ISwDMConfigurationMgr*)swCfgMgr)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->return 
 0;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->_variant_t 
 names( swCfgMgr-&gt;<span style="font-weight: bold;">GetConfigurationNames</span>() 
 );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->SAFEARRAY* 
 nameArray = names.parray;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->for 
 (int i=0; i&lt;nameArray-&gt;rgsabound[0].cElements; ++i)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->{</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->_bstr_t 
 str( ((BSTR*)(nameArray-&gt;pvData))[i] );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->ISwDMConfigurationPtr 
 swCfg( </p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->swCfgMgr-&gt;<span 
 style="font-weight: bold;">GetConfigurationByName</span>(str) );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->ISwDMConfiguration2* 
 pswCfg2;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->if 
 (swCfg)</p>

<p class=apiCode
	style="margin-left: 49px;">swCfg-&gt;QueryInterface( __uuidof(ISwDMConfiguration2), 
 (void **)&amp;pswCfg2 );</p>

<p class=apiCode
	style="margin-left: 24px;">else</p>

<p class=apiCode
	style="margin-left: 24px;">return 0;</p>

<p class=apiCode
	style="margin-left: 24px;">&nbsp;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->{</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->CString 
 dir( outputDir );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->dir 
 += &quot;\\&quot;;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->dir 
 += str;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->dir 
 += &quot;.xmp_bin&quot;;</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->pswCfg2-&gt;<span 
 style="font-weight: bold;">GetPartitionStream</span>( (LPCTSTR)dir );</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->}</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->}</p>

</body>

</html>
