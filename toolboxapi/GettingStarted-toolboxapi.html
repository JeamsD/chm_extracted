<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <title>Getting Started</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link>
    <link rel="stylesheet" type="text/css" href="ApiHelp.css"></link>
    <script src="script/helpstudio.js" type="text/javascript"></script>
    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
    <style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: #CCCCFF}</style>
    <style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: #000069}</style>
	
    
    
</head>
<body id="hsbody">
	
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        SOLIDWORKS Toolbox Browser API
                    </span>
                </td>
                <td align="right" rowspan="2">
                    
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        Getting Started
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		
            		<span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: GettingStarted-toolboxapi.html">Send Feedback</a></span>
            	</td>
            </tr>
        </table>
        
        
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<A id=#top name=#top></A>The SOLIDWORKS Toolbox Browser API&nbsp;is designed specifically to&nbsp;allow third-party PDMs&nbsp;to&nbsp;interact with the&nbsp;SOLIDWORKS Toolbox Browser&nbsp;and the Toolbox Configurator. The SOLIDWORKS Toolbox Browser API includes: 
<DIV style="MARGIN-LEFT: 2em">
<UL>
<LI>SOLIDWORKS Toolbox Browser API&nbsp;(<STRONG>SOLIDWORKS.Interop.swbrowser.dll</STRONG>): 
<UL>
<LI><A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IApplication.html">IApplication</A> 
<LI><A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager.html">IPDMDocManager</A></LI></UL>
<LI>SOLIDWORKS Toolbox Configurator API&nbsp;(<STRONG>SOLIDWORKS.Interop.sldtoolboxconfigureaddin.dll</STRONG>): 
<UL>
<LI><A href="SOLIDWORKS.Interop.sldtoolboxconfigureaddin~SOLIDWORKS.Interop.sldtoolboxconfigureaddin.IToolboxConfiguratorAddin.html">IToolboxConfiguratorAddin</A> 
<LI><A href="SOLIDWORKS.Interop.sldtoolboxconfigureaddin~SOLIDWORKS.Interop.sldtoolboxconfigureaddin.IToolBoxConfiguratorApplication.html">IToolBoxConfiguratorApplication</A></LI></UL></LI></UL></DIV>
<P>&nbsp;&nbsp;</P>
<H5>Use the SOLIDWORKS Toolbox Browser API to Access the SOLIDWORKS Toolbox Browser</H5>
<OL style="MARGIN-RIGHT: 0px" dir=ltr>
<LI>Set up a third-party PDM vault to contain the SOLIDWORKS Toolbox. See the PDM Administration Guide and the SOLIDWORKS Toolbox Help. 
<LI>Create a SOLIDWORKS add-in using one of the add-in templates in the SOLIDWORKS API SDK. 
<LI>In the add-in's ConnectToSW(): 
<OL>
<LI>Call&nbsp;<A href="ms-its:sldworksapi.chm::/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.ISldWorks~GetAddInObject.html">ISldWorks::GetAddInObject</A>, passing in the GUID of the SOLIDWORKS Toolbox Browser add-in type library (<STRONG>Registry Editor &gt;</STRONG>&nbsp;<STRONG>Computer\HKEY_CLASSES_ROOT\TypeLib\{ED783340-D5DB-11d4-BD5A-00C04F019809}</STRONG>), to get a Dispatch pointer to the IApplication object and connect to the SOLIDWORKS Toolbox Browser. 
<P dir=ltr>For example, in COM:</P>
<P dir=ltr>LPDISPATCH pDisp = NULL;<BR>HRESULT hres = pSldWorks-&gt;GetAddInObject("{ED783340-D5DB-11d4-BD5A-00C04F019809}" , &amp;pDisp);&nbsp;</P>
<LI>Cast the Dispatch pointer to <STRONG>SOLIDWORKS.Interop.swbrowser.IApplication</STRONG> to gain access to the SOLIDWORKS Toolbox Browser API.</LI></OL>
<LI>Implement and attach to PDMDocManager event handlers&nbsp;that control access to the PDM-managed SOLIDWORKS Toolbox Browser part documents. 
<LI>Run the add-in. The SOLIDWORKS Toolbox Browser add-in is registered and loaded. 
<LI>Open a document in SOLIDWORKS. 
<LI>To open the SOLIDWORKS Toolbox Browser, select <STRONG>Toolbox</STRONG> from the SOLIDWORKS menu. 
<LI>The add-in connects to the SOLIDWORKS Toolbox Browser.</LI></OL>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P dir=ltr>&nbsp;</P></BLOCKQUOTE></BLOCKQUOTE>
<H5>Use the SOLIDWORKS Toolbox Browser API to Access the SOLIDWORKS Toolbox Configurator</H5>
<OL style="MARGIN-RIGHT: 0px" dir=ltr>
<LI>Set up a third-party PDM vault to contain the SOLIDWORKS Toolbox. See the PDM Administration Guide and the SOLIDWORKS Toolbox Help. 
<LI>Create a SOLIDWORKS add-in using one of the add-in templates in the SOLIDWORKS API SDK. 
<LI>Use&nbsp;Microsoft Visual Studio 2010 <STRONG>Tools &gt; Create GUID</STRONG> to create a GUID.&nbsp; 
<LI>Add a class of type IToolboxConfiguratorAddin to the add-in, assigning the new GUID to the class. 
<LI>Implement all of the methods of IToolboxConfiguratorAddin. 
<LI>Implement and&nbsp;attach to&nbsp;PDMDocManager event handlers that control access to&nbsp;the PDM-managed SOLIDWORKS Toolbox Configurator part documents. 
<LI>In the add-in's Connect(), cast the return variable, pTbcApplication, to <STRONG>SOLIDWORKS.Interop.sldtoolboxconfigureaddin.IToolBoxConfiguratorApplication</STRONG> to gain access to the SOLIDWORKS Toolbox Configurator API. 
<LI>Debug&nbsp;the add-in. The Toolbox Configurator add-in is registered and loaded.&nbsp; 
<LI>To open the Toolbox Configurator from SOLIDWORKS, select <STRONG>Tools &gt; Options &gt; Hole Wizard/Toolbox &gt; Configure</STRONG>. 
<LI>The add-in connects to the Toolbox Configurator. 
<LI>In Visual Studio 2010 select <STRONG>Debug &gt; Attach to Process &gt; SldToolboxConfigure.exe</STRONG>.</LI></OL>
<H5>Examples</H5>
<P>Download from the&nbsp;SOLIDWORKS API Forum working add-ins that show how to use the SOLIDWORKS Toolbox Browser API to access the SOLIDWORKS Toolbox Browser, access the Toolbox Configurator, and handle PDM-managed documents. You must be a SOLIDWORKS subscription customer to access the SOLIDWORKS API Forum documents.</P>
<OL>
<LI>Open https://forum.solidworks.com/docs/DOC-2301. 
<LI>Log in. 
<LI>Click&nbsp;<STRONG>API/Macros</STRONG> in the SPACES/GROUPS sidebar. 
<LI>Click <STRONG>API Examples</STRONG> in the QUICK LINKS sidebar. 
<LI>Click the Documents tab. 
<LI>Type "Toolbox Manager"&nbsp;in the search field. 
<LI>Locate and download the <STRONG>SOLIDWORKS Toolbox Manager Example (VB.NET, C#).</STRONG></LI></OL>
<P align=center><A href="#top">Back to top</A></P>
<H5>SOLIDWORKS Toolbox Browser API Use Cases<A id=DragDropStd name=DragDropStd></A></H5>
<H6>Drag and Drop Standard SOLIDWORKS Toolbox Parts</H6>
<OL>
<LI>After the user releases the mouse button to drop a SOLIDWORKS Toolbox Browser part onto the assembly,&nbsp;SOLIDWORKS fires the <A href="ms-its:sldworksapi.chm::/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.DAssemblyDocEvents_FileDropPreNotifyEventHandler.html">FileDropPreNotify event</A>, passing the path name of the dropped file. 
<LI>In the FileDropPreNotify event handler, the PDM application must call <A href="ms-its:sldworksapi.chm::/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IAssemblyDoc~SetDroppedFileName.html">IAssemblyDoc::SetDroppedFileName</A>, passing the path name of the PDM-managed version of the document (if it can be made writable) or a copy of the managed document that can be written to by SOLIDWORKS Toolbox Browser&nbsp;(if it cannot be made writable). 
<LI>If SOLIDWORKS Toolbox Browser determines that the dropped file needs to be written to, it fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_BeforeWritingToDocumentEventHandler.html">BeforeWritingToDocument event</A>, passing the path name of the PDM-managed version of the dropped file. 
<LI>In the BeforeWritingToDocument event handler, the PDM application must ensure that the file that was previously passed to IAssemblyDoc::SetDroppedFileName is writable and call <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager~SetDocumentStatus.html">IPDMDocManager::SetDocumentStatus</A>, passing <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.swPDMStatus_e.html">swPDMStatus_e.swPDMStatusKnownAndAvailable</A>. If the application passes any other status value, SOLIDWORKS Toolbox Browser generates an error and stops the file drop. 
<LI>After the application updates the document, SOLIDWORKS Toolbox Browser fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_AfterWritingToDocumentEventHandler.html">AfterWritingToDocument event</A>, passing the path name of the PDM-managed version of the document that was written to. 
<LI>In the AfterWritingToDocument event handler, the PDM application must copy the working document back to the PDM-managed location and change the file attribute of the PDM-managed version to read-only. 
<LI>SOLIDWORKS continues the file drop as usual.</LI></OL>
<P align=center><A href="#top">Back to top</A></P>
<H6><A id=Insert name=Insert></A>Insert SmartFastener</H6>
<OL>
<LI>After the user inserts a SmartFastener, SOLIDWORKS Toolbox Browser&nbsp;fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_PreInsertDocumentEventHandler.html">PreInsertDocument event</A>, passing the path name of the PDM-managed version of the SmartFastener. 
<LI>In the PreInsertDocument event handler, the PDM application must call <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager~SetManagedDocument.html">IPDMDocManager::SetManagedDocument</A>, passing the path name of the PDM-managed version of the document (if it can be made writable) or a copy of the managed document that can be written to by SOLIDWORKS Toolbox Browser&nbsp;(if it cannot be made writable). 
<LI>If it determines that the file needs to be written to, SOLIDWORKS Toolbox Browser fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_BeforeWritingToDocumentEventHandler.html">BeforeWritingToDocument event</A>, passing the path name of the PDM-managed version of the file. 
<LI>In the BeforeWritingToDocument event handler, the PDM application must ensure that the file that was previously passed to <A href="ms-its:sldworksapi.chm::/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IAssemblyDoc~SetDroppedFileName.html">IAssemblyDoc::SetDroppedFileName</A> is writable and call <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager~SetDocumentStatus.html">IPDMDocManager::SetDocumentStatus</A>, passing <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.swPDMStatus_e.html">swPDMStatus_e.swPDMStatusKnownAndAvailable</A>. If the application passes any other status value, SOLIDWORKS Toolbox Browser generates an error and stops the file drop. 
<LI>After the document is updated, SOLIDWORKS Toolbox Browser fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_AfterWritingToDocumentEventHandler.html">AfterWritingToDocument event</A>, passing the path name of the PDM-managed version of the file. 
<LI>In the AfterWritingToDocument event handler, the PDM application must copy the working document back to the&nbsp;PDM-managed location&nbsp;and change the file attribute of the PDM-managed version to read-only. 
<LI>SOLIDWORKS continues the insert as usual.</LI></OL>
<P align=center><A href="#top">Back to top</A></P>
<H5><A id=DragDropCopied name=DragDropCopied></A>SOLIDWORKS Toolbox Configurator API Use Case</H5>
<H6>Welcome to Toolbox Setup - Modify a Toolbox Part</H6>
<OL>
<LI>After the user clicks the Save button, SOLIDWORKS Toolbox Configurator fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_BeforeWritingToDocumentEventHandler.html">BeforeWritingToDocument event</A>, passing the path name of the PDM-managed version of the SOLIDWORKS Toolbox part being edited. 
<LI>In the BeforeWritingToDocument event handler, the PDM application must&nbsp;try to unset the read-only attribute of the PDM-managed version of the Toolbox part. (If it can't, it must copy&nbsp;the&nbsp;part&nbsp;to a working file that can be written to&nbsp;and call <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager~SetManagedDocument.html">IPDMDocManager::SetManagedDocument</A>, passing the path name of the working document.) It must then call <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.IPDMDocManager~SetDocumentStatus.html">IPDMDocManager::SetDocumentStatus</A>, passing <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.swPDMStatus_e.html">swPDMStatus_e.swPDMStatusKnownAndAvailable</A>&nbsp;before returning. If any other status value is passed, the&nbsp;SOLIDWORKS Toolbox Configurator generates an error. 
<LI>After SOLIDWORKS Toolbox Configurator updates the document, it fires the <A href="SOLIDWORKS.Interop.swbrowser~SOLIDWORKS.Interop.swbrowser.DPDMDocManagerEvents_AfterWritingToDocumentEventHandler.html">AfterWritingToDocument event</A>, passing the path name of the PDM-managed version of the SOLIDWORKS Toolbox part being edited. 
<LI>In the AfterWritingToDocument event handler, the PDM application must copy the working document back to the PDM-managed location. It must also change the file attribute of the PDM-managed version back to read-only.&nbsp;&nbsp;</LI></OL>
<P align=center><A href="#top">Back to top</A></P>
            <a name="seealsobookmark"></a>
            
        </div>
        
        <div id="pagefooter">
            
        </div>
        
    </div>
    
</body>
</html>