<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <title>AddToolbarImage Method (IEdmCmdMgr5)</title>
    <link href="stylesheets/dotnet2005.css" type="text/css" rel="stylesheet">
    <script src="script/dotnet2005.js" type="text/javascript">
</script><xml>
<MSHelp:Keyword Index="F" Term="EPDM.Interop.epdm.IEdmCmdMgr5.AddToolbarImage" />
<MSHelp:Attr Name="DevLang" Value="CSharp" />
<MSHelp:Attr Name="DevLang" Value="VB" />
<MSHelp:Attr Name="DevLang" Value="JScript" />
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="LinkGroup" Value="Help"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
<MSHelp:Attr Name="HelpPriority" Value="1"/>
</xml>

    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
</head>

<body id="dxBody" topmargin="0">
    <form>
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset"> <img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/collapse.gif"> <img id="expandImage"
        style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id="collapseAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
        src="dotnetimages/collapse.gif"> <img id="expandAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id=
        "dropDownImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown.gif"> <img id="dropDownHoverImage" style=
        "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown_orange.gif"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src=
        "dotnetimages/copycode.gif"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/copycodeHighlight.gif"> 
        
    </form>

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">SOLIDWORKS PDM Professional API Help</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmCmdMgr5~AddToolbarImage.html">Send Feedback</a></span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">AddToolbarImage Method (IEdmCmdMgr5)</span></td>
                </tr>

                <tr id="pagetoptable1row3">
                    <td colspan="2"><a onclick="javascript:openSectionById('seeAlsoSectionHeader');" href="#seealsobookmark">
                    See Also</a>&nbsp; 
                    </td>
                </tr>
            </tbody>
        </table>

        <table id="pagetoptable2" cellspacing="0" cellpadding="0" width="100%">
            <tbody>
                <tr>
                    <td><span id="toggleExpandedAll"><img class="toggleAll" id="toggleExpandedAllImage" src="dotnetimages/collapse.gif"> <label id=
                    "collapseAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">Collapse All</label> <label id="expandAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">
                    Expand All</label></span> <span id="languageFilterToolTip"
                    onmouseover='document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' style="CURSOR: default"
                    onfocusout='document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;' onclick=
                    "showBox('dxlanguagemenu',event,document.getElementById('languageFilterImage'))" onfocusin=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' onmouseout=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;'><img id="languageFilterImage" src=
                    "dotnetimages/drpdown.gif"> <label id="showAllLabel" style="DISPLAY: none" for="languageFilterImage">
                    Language Filter: All</label> <label id="multipleLabel" style=
                    "DISPLAY: none" for="languageFilterImage">Language Filter: Multiple</label> 
                    
<label id="VBLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label>
<label id="CSLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
<label id="CPP2005Label" for="languageFilterImage" style="display: none;">Language Filter: C++/CLI</label>
</span></td>
                </tr>
            </tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="EPDM.Interop.epdm~EPDM.Interop.epdm_namespace.html">EPDM.Interop.epdm Namespace</a>
 > <a href="EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmCmdMgr5.html">IEdmCmdMgr5 Interface</a>
 : AddToolbarImage Method (IEdmCmdMgr5)</td></tr></table>

        <div class="dxpopupbubble" id="dxlanguagemenu">
            
<input id="VBCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBCheckbox">
Visual Basic
</label>
<br /><input id="CSCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CSCheckbox">
C#
</label>
<br /><input id="CPP2005Checkbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CPP2005Checkbox">
C++/CLI
</label>

        </div>
<div id="lHandleOrResourceID_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>lHandleOrResourceID</I></DT>
<DD class="popupbubble">Resource ID if bIsHandle = false; handle to a bitmap (bIsIcon = false)&nbsp;or icon (bIsIcon = true)&nbsp;if bIsHandle = true</DD></DL>
</div>
<div id="lButtonCount_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>lButtonCount</I></DT>
<DD class="popupbubble">Number of buttons in the bitmap or icon</DD></DL>
</div>
<div id="eState_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>eState</I></DT>
<DD class="popupbubble">State of the toolbar button (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="bIsIcon_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>bIsIcon</I></DT>
<DD class="popupbubble">True if the image is an icon; false if it is a bitmap (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="bIsHandle_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>bIsHandle</I></DT>
<DD class="popupbubble">True if lHandleOrResourceID is a handle, false if it is a resource ID</DD></DL>
</div>
<div id="lBackgroundColorRGB_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>lBackgroundColorRGB</I></DT>
<DD class="popupbubble">RGB value of the background color (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="lImageID_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>lImageID</I></DT>
<DD class="popupbubble">ID of the image (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>

    </div>

    <div id="pagebody" valign="bottom">
        <a name="topBookmark"></a>

        <div id="mainbody">
            <div class="saveHistory" id="allHistory" onsave="saveAll()" onload="loadAll()"></div>
             <P>Registers an image with a toolbar button.</P>
<P><STRONG>NOTE:</STRONG> This method does not work in Windows Vista and later Windows operating systems.</P> 
             
             
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection"><DIV class=LanguageSpecific id=Syntax_VB><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>Sub AddToolbarImage( _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="lHandleOrResourceID" href="#" onclick="javascript:showParamBox(event);">lHandleOrResourceID</a></i> As System.Integer, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="lButtonCount" href="#" onclick="javascript:showParamBox(event);">lButtonCount</a></i> As System.Integer, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="eState" href="#" onclick="javascript:showParamBox(event);">eState</a></i> As <a href="EPDM.Interop.epdm~EPDM.Interop.epdm.EdmButtonState.html">EdmButtonState</a>, _
&nbsp;&nbsp;&nbsp;Optional ByVal <i><a class="parameter" id="bIsIcon" href="#" onclick="javascript:showParamBox(event);">bIsIcon</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;Optional ByVal <i><a class="parameter" id="bIsHandle" href="#" onclick="javascript:showParamBox(event);">bIsHandle</a></i> As System.Boolean, _
&nbsp;&nbsp;&nbsp;Optional ByVal <i><a class="parameter" id="lBackgroundColorRGB" href="#" onclick="javascript:showParamBox(event);">lBackgroundColorRGB</a></i> As System.Integer, _
&nbsp;&nbsp;&nbsp;Optional ByVal <i><a class="parameter" id="lImageID" href="#" onclick="javascript:showParamBox(event);">lImageID</a></i> As System.Integer _
) </pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CS><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C#</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>void AddToolbarImage( 
&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lHandleOrResourceID" href="#" onclick="javascript:showParamBox(event);">lHandleOrResourceID</a></i>,
&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lButtonCount" href="#" onclick="javascript:showParamBox(event);">lButtonCount</a></i>,
&nbsp;&nbsp;&nbsp;<a href="EPDM.Interop.epdm~EPDM.Interop.epdm.EdmButtonState.html">EdmButtonState</a> <i><a class="parameter" id="eState" href="#" onclick="javascript:showParamBox(event);">eState</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="bIsIcon" href="#" onclick="javascript:showParamBox(event);">bIsIcon</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="bIsHandle" href="#" onclick="javascript:showParamBox(event);">bIsHandle</a></i>,
&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lBackgroundColorRGB" href="#" onclick="javascript:showParamBox(event);">lBackgroundColorRGB</a></i>,
&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lImageID" href="#" onclick="javascript:showParamBox(event);">lImageID</a></i>
)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CPP2005><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C++/CLI</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>void AddToolbarImage( 
&&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lHandleOrResourceID" href="#" onclick="javascript:showParamBox(event);">lHandleOrResourceID</a></i>,
&&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lButtonCount" href="#" onclick="javascript:showParamBox(event);">lButtonCount</a></i>,
&&nbsp;&nbsp;&nbsp;<a href="EPDM.Interop.epdm~EPDM.Interop.epdm.EdmButtonState.html">EdmButtonState</a> <i><a class="parameter" id="eState" href="#" onclick="javascript:showParamBox(event);">eState</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="bIsIcon" href="#" onclick="javascript:showParamBox(event);">bIsIcon</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="bIsHandle" href="#" onclick="javascript:showParamBox(event);">bIsHandle</a></i>,
&&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lBackgroundColorRGB" href="#" onclick="javascript:showParamBox(event);">lBackgroundColorRGB</a></i>,
&&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="lImageID" href="#" onclick="javascript:showParamBox(event);">lImageID</a></i>
) </pre></tr></table></div>

            <h4 class=dxh4>Parameters</h4><DL><DT><I>lHandleOrResourceID</I></DT>
<DD>Resource ID if bIsHandle = false; handle to a bitmap (bIsIcon = false)&nbsp;or icon (bIsIcon = true)&nbsp;if bIsHandle = true</DD><DT><I>lButtonCount</I></DT>
<DD>Number of buttons in the bitmap or icon</DD><DT><I>eState</I></DT>
<DD>State of the toolbar button (see <STRONG>Remarks</STRONG>)</DD><DT><I>bIsIcon</I></DT>
<DD>True if the image is an icon; false if it is a bitmap (see <STRONG>Remarks</STRONG>)</DD><DT><I>bIsHandle</I></DT>
<DD>True if lHandleOrResourceID is a handle, false if it is a resource ID</DD><DT><I>lBackgroundColorRGB</I></DT>
<DD>RGB value of the background color (see <STRONG>Remarks</STRONG>)</DD><DT><I>lImageID</I></DT>
<DD>ID of the image (see <STRONG>Remarks</STRONG>)</DD></DL> 
             
            </div> 
             
             <a name="exampleBookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Example</span></h1><div id="exampleSection" class="section" name="collapseableSection"><P>For a more complete description of how to use this method, see <A href="vbmenuitem.htm">Creating a menu command</A>.</P>
<P>The following snippet creates a toolbar button and adds a command in the File Explorer Tools menu. The button uses one icon (resource ID=101) for the cold (standard) state and another one (resource ID=102) for the hot (focus) state. Both icon files must be added using Visual Basic's resource editor before running this snippet:</P>
<P><SPAN lang=EN-GB style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-GB; mso-fareast-language: EN-US; mso-bidi-language: AR-SA" xml:lang="EN-GB">Private Sub IEdmAddIn5_GetAddInInfo(poInfo As EdmAddInInfo, ByVal poVault As IEdmVault5, ByVal poCmdMgr As IEdmCmdMgr5)</SPAN></P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P><SPAN lang=EN-GB style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-GB; mso-fareast-language: EN-US; mso-bidi-language: AR-SA" xml:lang="EN-GB"><BR>...<BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">poCmdMgr.AddToolbarImage 101, 1, BState_Cold, True, False, 12632256, 1<BR>poCmdMgr.AddToolbarImage 102, 1, BState_Hot, True, False, 12632256, 1<BR>poCmdMgr.AddCmd 1, "My Command", EdmMenu_NeverInContextMenu Or EdmMenu_HasToolbarButton, "String to show in the statusbar", "Tooltip on my command", 0, 1<BR></SPAN></P></BLOCKQUOTE>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"><BR>End Sub</SPAN></P> 
            </div> 
            
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection"><P>Call this method from your add-in's implementation of <A href="EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmAddIn5~GetAddInInfo.html">IEdmAddIn5::GetAddInInfo</A> to create a toolbar button.</P>
<P>Images can be either bitmaps (*.BMP)&nbsp;or icons (*.ICO). A bitmap contains one or more buttons of the same size. An icon contains only one button.</P>
<P>Unlike icons, bitmaps do not contain transparent regions. In order to get transparency in bitmaps, specify in lBackgroundColorRGB the RGB color of the bitmap&nbsp;that should be replaced by the background color.</P>
<P>When you add "hot" buttons (eState = <A href="EPDM.Interop.epdm~EPDM.Interop.epdm.EdmButtonState.html">EdmButtonState</A>.BState_Hot), they must be assigned the same image ID as the corresponding "cold" buttons (eState = EdmButtonState.BState_Cold). Additionally, if the images contain several toolbar buttons, the buttons must be ordered the same way in both images.</P>
<P>Toolbar buttons in File Explorer can have several different sizes depending on the operating system version, Internet Explorer version, and user preferences. To make the image compatible, use this method to add several versions of an image using the same image ID but with different image sizes. SOLIDWORKS PDM Professional chooses the image that best matches the system settings. If the image doesn't exactly match the button size,&nbsp;PDM&nbsp;either resizes it&nbsp;(if the button is smaller than the image) or centers it in the button (if the button is bigger than the image).</P>
<P>After calling this method to create a toolbar button, call <A href="EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmCmdMgr5~AddCmd.html">IEdmCmdMgr5::AddCmd</A> setting lToolbarImageID to this method's lImageID.</P>
<P><A href="ReturnCodes.htm">Return codes</A>:</P>
<UL>
<LI>S_OK: The method successfully executed. 
<LI>S_FALSE: One of the arguments is invalid.&nbsp;</LI></UL></div>&nbsp;
            <a name="seealsobookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><h4 class="dxh4"></h4><a href="EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmCmdMgr5.html">IEdmCmdMgr5 Interface</a>
<br/><a href="EPDM.Interop.epdm~EPDM.Interop.epdm.IEdmCmdMgr5_members.html">IEdmCmdMgr5 Members</a>
</p>
</div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="availabilityToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Availability</span></h1><div id="availabilitySection" class="section" name="collapseableSection">SOLIDWORKS PDM Professional Version 5.2</div>
        </div>

        <div id="pagefooter"></div>
    </div>
</body>
</html>