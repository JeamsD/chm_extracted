<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <title>Getting Started</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link>
    <link rel="stylesheet" type="text/css" href="ApiHelp.css"></link>
    <script src="script/helpstudio.js" type="text/javascript"></script>
    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
    <style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: #CCCCFF}</style>
    
	
    
    
</head>
<body id="hsbody">
	
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        eDrawings API Help
                    </span>
                </td>
                <td align="right" rowspan="2">
                    
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        Getting Started
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		
            		<span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: GettingStarted-emodelapi.html">Send Feedback</a></span>
            	</td>
            </tr>
        </table>
        
        
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<H4><A id=top name=top></A>Using the eDrawings ActiveX control</H4>
<P>The eDrawings API is implemented as a Microsoft ActiveX control. This topic shows how to create Microsoft Visual Basic and C#&nbsp;Windows Forms applications that use this control to load eDrawings drawings.</P>
<H5>Prerequisites</H5>
<UL>
<LI>Microsoft Visual Studio 2010 or later&nbsp;is installed. (The instructions in the following&nbsp;procedures are specific to Microsoft Visual Studio 2015.) 
<LI>eDrawings 20<EM>nn</EM> is installed.</LI></UL>
<H6>eDrawings x64</H6>
<UL>
<LI><A href="#Modify">Modify SOLIDWORKS Forum eDrawings x64 Host Control C# example</A> 
<LI><A href="#Create">Create C# eDrawings x64 project</A></LI></UL>
<H3><A id=Modify name=Modify></A>Modify SOLIDWORKS Forum eDrawings x64 Host Control C# example</H3>
<P>You must manually generate the 64-bit&nbsp;primary interop assembly DLL needed by your&nbsp;Microsoft Visual Studio C# Windows Forms Application, because Microsoft Visual Studio is a 32-bit application.&nbsp;</P>
<P><A id=first name=first></A>To&nbsp;generate the 64-bit primary assembly DLL:</P>
<OL>
<LI>Install eDrawings 20<EM>nn</EM> x64 Edition, if it is not already installed on your computer. 
<LI>Locate <STRONG>tlbimp.exe</STRONG> on your computer For:&nbsp; 
<UL>
<LI>.NET Framework 4 and later, which use CLR 4.0, the path is <B>C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools.</B> 
<LI>.NET Framework 3.5 and earlier, which use CLR 2.0, the path is <B>C:\Program Files (x86)\Microsoft Visual Studio 8\SDK\v2.0\Bin.</B></LI></UL>
<LI>Open a command prompt window in the folder where <B>tlbimp.exe</B> resides and type:&nbsp;<BR><BR><STRONG>tlbimp.exe "C:\Program Files\SOLIDWORKS Corp\eDrawings\EModelView.dll"<BR><BR>NOTE:</STRONG> If eDrawings 20<I>nn</I> x64 Edition is installed elsewhere on your computer, then specify your path to <B>EModelView.dll</B>. 
<LI>Examine the command window to verify that <STRONG>Type library imported to EModelView.dll</STRONG> is returned. 
<LI>Type <STRONG>exit</STRONG>.&nbsp;</LI></OL>
<P><A id=second name=second></A>To&nbsp;modify the&nbsp;SOLIDWORKS Forum eDrawings x64 Host Control C# example:</P>
<OL>
<LI>Open and extract the&nbsp;<A href="http://forum.solidworks.com/docs/DOC-1603" target=_blank>eDrawings&nbsp;Host Control example</A>, <STRONG>eDrawings Example.zip</STRONG>, which includes two&nbsp;Microsoft Visual Studio projects written in C#.<BR><BR><STRONG>NOTE</STRONG>: You&nbsp;must be a SOLIDWORKS Subscription Service customer to access the example.<BR>
<LI>Unzip and extract <STRONG>eDrawingHostControl source project.zip</STRONG>, located in the <STRONG>HostControl</STRONG> folder. 
<LI>Open <STRONG>eDrawingHostControl.csproj</STRONG> in Microsoft Visual Studio and convert the project. 
<LI>Click the <STRONG>Show All Files</STRONG> button in the Solution Explorer and expand <STRONG>References</STRONG>. 
<LI>Remove the existing reference to <STRONG>EModelView</STRONG> and add a reference to <STRONG>EModelView.dll</STRONG>, which you created in the&nbsp;<A href="#first">previous procedure</A> and which resides in the same folder as <STRONG>tlbimp.exe</STRONG>. 
<LI>Click <B>Project &gt; eDrawingHostControl Properties</B>. 
<OL>
<LI>Click <B>Build</B> and change <B>Platform target</B> to <B>x64.</B> 
<LI>If you created <STRONG>EModelView.dll</STRONG> using .NET Framework 4 or later, click <STRONG>Application,&nbsp;</STRONG>change <B>Target framework</B> to .<B>NET Framework 4.</B><I>n,</I> and click <B>Yes.</B></LI></OL>
<LI>Start debugging. 
<LI>Click <STRONG>Yes</STRONG> when informed of different versions. 
<LI>Click <STRONG>Close</STRONG> on the form. 
<LI>Save and exit&nbsp;the project.&nbsp;</LI></OL>
<P>To modify the SOLIDWORKS Forum eDrawings example:</P>
<OL>
<LI>Open <STRONG>eDrawingsExample.csproj</STRONG> in Microsoft Visual Studio and convert the project.<BR><BR><STRONG>NOTE</STRONG>: This project is located in the <STRONG>eDrawingsExample</STRONG> folder.<BR>
<LI>Click <STRONG>Project &gt; eDrawingsExample Properties &gt; Build</STRONG>&nbsp; and change <STRONG>Platform target</STRONG> to <STRONG>x64</STRONG>. 
<LI>Click the <STRONG>Show All Files</STRONG> button in the Solution Explorer and expand <STRONG>References</STRONG>. 
<LI>Remove the existing <STRONG>eDrawingHostControl</STRONG> reference and add a reference to <STRONG>\bin\Debug\eDrawingHostControl.dll</STRONG>, which you created&nbsp;in the&nbsp;<A href="#second">previous procedure</A>.&nbsp;Check the date on the file to ensure that you are adding the DLL that you created. 
<LI>Remove the reference to <STRONG>Interop.EModelView</STRONG> and add a reference to <STRONG>EModelView.dll</STRONG>, which you<STRONG>&nbsp;</STRONG>created in the&nbsp;<A href="#first">first procedure</A>. 
<LI>Change the name of the SOLIDWORKS or eDrawings file to open in <STRONG>Form1.cs</STRONG> to a file that exists on your computer. 
<LI>Start debugging. 
<LI>Click&nbsp;<STRONG>Yes</STRONG> when informed of different versions. 
<LI>Click <STRONG>Open</STRONG> to open the file. 
<LI>Click <STRONG>OK</STRONG> to close the message box. 
<LI>Close the form, save, and exit the project.<A id=Create name=Create></A></LI></OL>
<H3>Create C# eDrawings x64 project</H3>
<P>To&nbsp;create a C# eDrawings x64 project:</P>
<OL>
<LI>Create an eDrawings x64 <STRONG>EModelView.dll</STRONG>. See the&nbsp;<A href="#first">first procedure</A> in <STRONG>Modify SOLIDWORKS Forum eDrawings x64 Host Control C# example</STRONG>. 
<LI>Download and modify the SOLIDWORKS Forum eDrawings x64 Host Control example's Host Control project. See the <A href="#second">second procedure</A> in&nbsp; <STRONG>Modify SOLIDWORKS Forum eDrawings x64 Host Control C# example</STRONG>. 
<LI>Open Microsoft Visual Studio. 
<LI>Create a C# <STRONG>Windows Forms Application</STRONG> project and name it <STRONG>WindowsFormsApplication1</STRONG>. 
<LI>Click <B>Project &gt;&nbsp;<STRONG>WindowsFormsApplication1</STRONG> Properties</B>. 
<OL>
<LI>Click <B>Build</B> and change <B>Platform target</B> to <B>x64.</B> 
<LI>If you created <STRONG>EModelView.dll</STRONG> using .NET Framework 4 or later,&nbsp;click <STRONG>Application</STRONG>, change <B>Target framework</B> to .<B>NET Framework 4.</B><I>n,</I> and click <B>Yes.</B></LI></OL>
<LI>Click the <STRONG>Show All Files</STRONG> button in the Solution Explorer and expand <STRONG>References</STRONG>. 
<LI>Add a reference to <STRONG>EModelView.dll</STRONG>,&nbsp;which you<STRONG>&nbsp;</STRONG>created in step 1. 
<LI>Add a reference to <B>\bin\Debug\eDrawingHostControl.dll</B>, which you created in step 2. Check the date on the file to ensure that you are adding the DLL that you created. 
<LI>Double-click <STRONG>Form1.cs</STRONG> in the Solution Explorer to show the form. 
<LI>Click <STRONG>View &gt; Toolbox</STRONG>, expand <STRONG>All Windows Forms</STRONG>, and drag a button onto the form. 
<LI>Double-click the button. 
<LI>Replace the code in <B>Form1.cs</B> with this code:<BR><BR><PRE>using System.Data;<BR>using System.Drawing;<BR>using System.Linq;<BR>using System.Text;<BR>using System.Threading.Tasks;<BR>using System.Windows.Forms;<BR>using eDrawingHostControl;
</PRE><PRE>namespace WindowsFormsApplication1<BR>{<BR>    public partial class Form1 : Form<BR>    {<BR>        eDrawingHostControl.eDrawingControl ctrl = null;
</PRE><PRE>        public Form1()
</PRE><PRE>        {<BR>            InitializeComponent();<BR>            if (null == ctrl)<BR>            {<BR>                ctrl = new eDrawingControl();<BR>            }
</PRE><PRE>            this.Controls.Add(ctrl);            
</PRE><PRE>        }
</PRE><PRE>        private void Form1_Load(object sender, System.EventArgs e)<BR>        {<BR>        }
</PRE><PRE>        private void button1_Click(object sender, System.EventArgs e)<BR>        {<BR>            if(ctrl != null)<BR>            {<BR>            ctrl.Location = new Point(0,0);<BR>            ctrl.Size = new System.Drawing.Size(this.Size.Width,this.Size.Height);<BR>            ctrl.eDrawingControlWrapper.OpenDoc("C:\\Users\\Public\\Documents\\SOLIDWORKS\\SOLIDWORKS 2020\\samples\\tutorial\\EDraw\\claw\\claw.sldprt", false, false, false, "");<BR>            }<BR>        }<BR>    }<BR>}
</PRE>
<LI>Start debugging to display the form. 
<LI>Click <STRONG>button1</STRONG>.<BR>If the file specified in&nbsp;<STRONG>button1_Click</STRONG> exists on your computer, it is displayed. If that file does not exist on your computer, then close the form, edit the file's path and file name in <STRONG>Form1.cs</STRONG> to specify a SOLIDWORKS or eDrawings file on your computer, and repeat steps 13 and 14. 
<LI>Close the form and save the project.</LI></OL>
<P>You can also download&nbsp;<A href=" https://forum.solidworks.com/docs/DOC-3335" target=_blank>Add eModelViewControl to a Windows.Forms Application at runtime (eDrawings ActiveX Control)</A>, which shows how to add instances of the eDrawings ActiveX control IEModelViewControl to a Window.Forms application at runtime. This technique allows Microsoft Visual Studio users to overcome the architecture mismatch that prevents the 32-bit Visual Studio Forms Editor from loading the 64-bit eDrawings library eModelView.dll.</P>
<P align=center><A href="GettingStarted-emodelapi.html#top">Back to top</A></P>
<H6>Instantiating the eDrawings Control</H6>
<P>You can instantiate the eDrawings control using&nbsp;version-specific&nbsp;or version-independent class IDs (CLSIDs).</P>
<P>To get your version-specific eDrawings control's CLSIDs:</P>
<OL>
<LI style="MARGIN-LEFT: 8px">Run the Windows Registry editor, regedit. 
<LI style="MARGIN-LEFT: 8px">Expand <STRONG>HKEY_CLASSES_ROOT</STRONG>. 
<LI style="MARGIN-LEFT: 8px">Locate and double-click <STRONG>EModelView.EModelViewControl</STRONG>.<EM>nn</EM>, where <EM>nn</EM> is the 2-digit release year of the version of eDrawings installed on your computer.&nbsp;For example, if eDrawings 2017 is installed on your computer, then nn is 17. 
<LI style="MARGIN-LEFT: 8px">Click <STRONG>CLSID</STRONG>. Make note of the CLSID. 
<LI style="MARGIN-LEFT: 8px">Locate and double-click EModelViewMarkup.EModelMarkupControl.nn. 
<LI style="MARGIN-LEFT: 8px">Click <STRONG>CLSID</STRONG>. Make note of&nbsp;the CLSID. 
<LI style="MARGIN-LEFT: 8px">Exit regedit.</LI></OL>
<P style="MARGIN-LEFT: 8px">The version-independent eDrawings CLSIDs are:</P>
<UL>
<LI>
<DIV style="MARGIN-LEFT: 8px">EModelNonVersionSpecificViewControl = 22945A69-1191-4DCF-9E6F-409BDE94D101 </DIV>
<LI>
<DIV style="MARGIN-LEFT: 8px">EModelNonVersionSpecificMarkupControl = 5BBBC05A-BD4D-4e3b-AD5B-51A79DFC522F </DIV></LI></UL>
<P style="MARGIN-LEFT: 8px">SOLIDWORKS&nbsp;recommends that you use version-specific CLSIDs,&nbsp;because Microsoft Visual Studio selects&nbsp;them by default. However, because CLSIDs are version specific, with each new release of eDrawings you must edit:</P>
<UL style="LIST-STYLE-TYPE: disc" type=disc>
<LI class=kadov-p>
<P style="MARGIN-LEFT: 8px">your application. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></P>
<LI class=kadov-p>
<P style="MARGIN-LEFT: 8px">any HTML pages that reference version-specific CLSIDs.</P></LI></UL>
<P style="MARGIN-LEFT: 8px">Although you do not need to edit your application when working with multiple versions of eDrawings when using the version-independent CLSID, if your application uses a newer API than present in an older version of eDrawings installed by your user, your application will not work properly. This scenario can be difficult to debug remotely, especially with HTML applications.</P>
<P align=center><A href="GettingStarted-emodelapi.html#top">Back to top</A></P>
            <a name="seealsobookmark"></a>
            
        </div>
        
        <div id="pagefooter">
            
        </div>
        
    </div>
    
</body>
</html>