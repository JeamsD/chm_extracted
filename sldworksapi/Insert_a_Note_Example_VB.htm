<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Insert a Note Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples,notes">
<meta name=MS-HKWD content="VBA examples,annotations">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=752>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Insert a Note Example (VBA)</h1>

<p>This example shows show to insert a geometric tolerance 
 symbol in an active drawing document.</p>

<p class="APICODE">
'----------------------------------------------------------------------------<br>
' Preconditions: Open <i>public_documents</i><b>\samples\tutorial\advdrawings\foodprocessor.slddrw</b>.<br>
'<br>
' Postconditions: <br>
' 1. Inserts a geometric tolerance symbol at the specified position.<br>
' 2. Examine the graphics area.<br>
'<br>
' NOTE: Because the model is used elsewhere, do not save changes.<br>
'----------------------------------------------------------------------------</p>
<p class="APICODE">Option Explicit</p>
<p class="APICODE">Sub main()</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Dim swApp As SldWorks.SldWorks<br>
&nbsp;&nbsp;&nbsp; Dim Part As SldWorks.ModelDoc2<br>
&nbsp;&nbsp;&nbsp; Dim Annotation As SldWorks.Annotation<br>
&nbsp;&nbsp;&nbsp; Dim swSelobj2 As Object<br>
&nbsp;&nbsp;&nbsp; Dim swSelMgr As SldWorks.SelectionMgr<br>
&nbsp;&nbsp;&nbsp; Dim Note As SldWorks.Note<br>
&nbsp;&nbsp;&nbsp; Dim boolstatus As Boolean<br>
&nbsp;&nbsp;&nbsp; Dim longstatus As Long<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set swApp = 
Application.<b>SldWorks</b><br>
&nbsp;&nbsp;&nbsp; Set Part = swApp.<b>ActiveDoc</b><br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set swSelMgr = Part.<b>SelectionManager</b><br>
&nbsp;&nbsp;&nbsp; boolstatus = Part.<b>Extension</b>.<b>SelectByID2</b>(&quot;&quot;, 
&quot;EDGE&quot;, 0.166288048468037, 0.223859686746988, -4.00000000013279E-04, False, 0, 
Nothing, 0)<br>
&nbsp;&nbsp;&nbsp; Set swSelobj2 = swSelMgr.<b>GetSelectedObject6</b>(1, -1)&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set Note = Part.<b>InsertNote</b>(&quot;&lt;MOD-CL&gt;&quot;)</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; If Not Note Is Nothing Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Note.<b>Angle</b> = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = Note.<b>SetBalloon</b>(0, 0)<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set Annotation = Note.<b>GetAnnotation</b>()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim AttEntArr(0) 
As Object<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set AttEntArr(0) = swSelobj2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim vAttEntArrIn As Variant<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vAttEntArrIn = AttEntArr</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = 
Annotation.<b>SetAttachedEntities</b>(vAttEntArrIn)</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not Annotation Is 
Nothing Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; longstatus = Annotation.<b>SetLeader3</b>(1, 
0, True, True, False, False)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolstatus = Annotation.<b>SetPosition2</b>(0.1038962799325, 
0.135343450253, 0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp; <br>
</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Part.<b>ClearSelection2</b> True<br>
&nbsp;&nbsp;&nbsp; Part.<b>WindowRedraw</b></p>
<p class="APICODE">End Sub</p>

</body>

</html>
