<html>

<head>
<title>Capture 3D View Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,3D views">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Capture 3D View Example (VBA)</h1>
<p>This example shows how to capture the 3D view of a part or assembly and get 
its properties.</p>

<p class="APICODE">
'----------------------------------------------------------------------------<br>
' Preconditions:<br>
' 1. Open a part or assembly.<br>
' 2. Open an Immediate window.<br>
'<br>
' Postconditions:<br>
' 1. Captures 3DView<i>n</i>.<br>
' 2. Prints out all of the 3D View names.<br>
' 3. Renames 3DView<i>n</i> to Aleph.<br>
' 4. Refreshes the model's 3D Views.<br>
' 5. Observe Aleph on the 3DViews tab.<br>
' 6. Inspect the Immediate window.<br>
' ---------------------------------------------------------------------------</p>
<p class="APICODE">Dim swApp As SldWorks.SldWorks<br>
Dim swDoc As ModelDoc2<br>
Dim swModelExt As ModelDocExtension<br>
Dim sw3DView As View3D<br>
Dim viewNames As Variant<br>
Dim v_counter As Long<br>
Dim modelBreakViewName As String</p>
<p class="APICODE">&nbsp;</p>
<p class="APICODE">Option Explicit<br>
Sub main()<br>
&nbsp;&nbsp;&nbsp; Set swApp = Application.<b>SldWorks</b><br>
&nbsp;&nbsp;&nbsp; Set swDoc = swApp.<b>ActiveDoc</b><br>
&nbsp;&nbsp;&nbsp; Set swModelExt = swDoc.<b>Extension</b><br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set sw3DView = swModelExt.<b>Capture3DView</b><br>
&nbsp;&nbsp;&nbsp; viewNames = swModelExt.<b>Get3DViewNames</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;3D Views:&quot;<br>
&nbsp;&nbsp;&nbsp; For v_counter = 0 To UBound(viewNames)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print &quot;&nbsp; &quot; &amp; 
viewNames(v_counter)<br>
&nbsp;&nbsp;&nbsp; Next<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; sw3DView.<b>Activate</b> (True)<br>
&nbsp;&nbsp;&nbsp; sw3DView.<b>Name</b> = &quot;Aleph&quot;<br>
&nbsp;&nbsp;&nbsp; swModelExt.<b>Refresh3DViews</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;Number of 3D Views: &quot; &amp; swModelExt.<b>Get3DViewCount<br>
&nbsp;&nbsp;&nbsp; </b>Debug.Print &quot;Name of active 3D View: &quot; &amp; sw3DView.<b>Name</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;Configuration: &quot; &amp; sw3DView.<b>ConfigurationName</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;Display state: &quot; &amp; sw3DView.<b>DisplayState</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;Display mode as defined in swDisplayMode_e: &quot; &amp; 
sw3DView.<b>DisplayMode</b><br>
&nbsp;&nbsp;&nbsp; Debug.Print &quot;Scale: &quot; &amp; sw3DView.<b>Scale<br>
</b>&nbsp;&nbsp;&nbsp; modelBreakViewName = sw3DView.<b>modelBreakViewName</b><br>
&nbsp;&nbsp;&nbsp; If modelBreakViewName = &quot;&quot; Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print &quot;No model break view&quot;<br>
&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print &quot;Model break view name: &quot; 
&amp; modelBreakViewName<br>
&nbsp;&nbsp;&nbsp; End If</p>
<p class="APICODE"><br>
End Sub</p>

</body>

</html>
