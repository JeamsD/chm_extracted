<html>

<head>
<title>Fire Notification When Changing a Table in a Drawing Document Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,tables">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;"><a name="Top"></a>SOLIDWORKS API 
 Help</span></h1>
<h1>Fire Notification When Changing a Table in a Drawing Document Example (VBA)</h1>
<p>This example shows how to fire a notification when a table is changed in a 
drawing document:</p>

<pre>'---------------------------------------------------------------
' Preconditions:
' 1. Open a drawing document.
' 2. Copy <a href="#Main">Main</a> to the main module.
' 3. Click <b>Insert &gt; Class Module</b> and copy <a href="#Class">Class</a> to that module.
' 4. Select a drawing view and click <b>Insert &gt; Tables &gt; Bill of Materials</b>.
' 5. Click <b>OK</b> in the Bill of Materials PropertyManager page.
' 6. Run this macro (press F5).
' 7. Right-click a column and select <b>Delete &gt; Column</b>.
'
' Postconditions:
' 1. Displays a message box informing you that the table was modified.
' 2. Click <b>OK</b> to close the message box.
'---------------------------------------------------------------</pre>

<h5><font face="Courier" size="2"><span style="font-weight: 400"><a name=Main></a>
</font><font size="2" face="Courier New">'Main</font><font face="Courier" size="2">
</font></span></h5>

<p class="APICODE">
Option Explicit</p>
<p class="APICODE">Dim swApp As SldWorks.SldWorks<br>
Dim swModel As SldWorks.ModelDoc2<br>
Dim swDraw As SldWorks.DrawingDoc<br>
Dim errorstatus As Long, warningstatus As Long<br>
Dim swDrawEvents As Class1</p>
<p class="APICODE">Sub main()</p>
<p class="APICODE">Set swApp = Application.SldWorks<br>
Set swModel = swApp.<b>ActiveDoc</b></p>
<p class="APICODE">'Set up events<br>
Set swDraw = swModel<br>
Set swDrawEvents = New Class1<br>
Set swDrawEvents.swDraw = swApp.<b>ActiveDoc</b></p>
<p class="APICODE">End Sub</p>

<p class=APICODE align="center"><a href="#Top">Back to top</a></p>

<h5><a name=Class></a><span style="font-weight: 400">
<font size="2" face="Courier New">'Class</font><font face="Courier" size="2">
</font></span></h5>

<p class="APICODE">Option Explicit</p>
<p class="APICODE">Public WithEvents swDraw As SldWorks.DrawingDoc<br>
</p>
<p class="APICODE">Private Function <b>swDraw_ModifyTableNotify</b>(ByVal 
TableAnnotation As SldWorks.ITableAnnotation, ByVal TableType As Long, ByVal 
reason As Long, ByVal RowInfo As Long, ByVal ColumnInfo As Long, ByVal DataInfo 
As String) As Long<br>MsgBox &quot;A table was modified. Title: &quot; &amp; TableAnnotation.<b>Title</b> &amp; &quot;, Type: &quot; &amp; 
TableType &amp; &quot;, Reason code: &quot; &amp; reason &amp; &quot;, RowInfo: &quot; &amp; RowInfo &amp; &quot;, ColumnInfo: 
&quot; &amp; ColumnInfo &amp; &quot;, DataInfo: &quot; &amp; DataInfo<br>End Function</p>
<div align="center">
<pre><a href="#Top">Back to top</a></pre>
</div>
<pre>&nbsp;</pre>

</body>

</html>
