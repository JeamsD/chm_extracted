<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Set Note Name Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta NAME=MS-HAID CONTENT=Set_Note_Name_Example>
<meta name=date content="10 11, 2002 4:22:13 PM">
<meta name=MS-HKWD content="Name,notes">
<meta name=MS-HKWD content="Note (see also INote Interface),names">
<meta name=MS-HKWD content="VBA examples,notes">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1382>
<meta name=layout-width content=750>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Set Note Name Example (VBA)</h1>

<p class=apiDescriptionText>This example shows how to set the name of a 
 selected note. You can combine this code with a dialog that prompts the 
 user for a desired name, or you can programmatically determine the new 
 note name.</p>

<p class=apiDescriptionText>&nbsp;</p>

<p class=apiCode>'------------------------------------------------------------------</p>

<p class=apiCode
	style="font-family: 'Courier New';">Sub SetNoteName( newNoteName As 
 String )</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Define variable used 
 to hold the SldWorks object</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Dim swApp As 
 Object &nbsp;&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Define variable used 
 to hold the ModelDoc object</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Dim Model As 
 Object &nbsp;&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Define variable used 
 to hold the SelectionMgr object</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Dim SelMgr As 
 Object &nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">Dim note As 
 Object</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">Dim checkNoteName 
 As String</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Const swSelNOTES 
 = 15 &nbsp;&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Const swDocDRAWING 
 = 3</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Attach to or open SOLIDWORKS 
 session</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Set swApp = 
 CreateObject(&quot;SldWorks.Application&quot;)&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Grab the current document</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">Set Model = 
 swApp.<span style="font-weight: bold;">ActiveDoc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Verify that the document 
 is a drawing</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">If (Model Is 
 Nothing) Or (Model.<span style="font-weight: bold;">GetType</span> &lt;&gt; 
 swDocDRAWING) Then</p>

<p class=apiCode
	style="margin-left: 89px; font-family: 'Courier New';">Exit Sub</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">End If</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">Set SelMgr = 
 Model.<span style="font-weight: bold;">SelectionManager</span></p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 72px; font-size: 10pt;">' Make sure a selection 
 exists</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 49px;">If (SelMgr.<span 
 style="font-weight: bold;">GetSelectedObjectCount</span> = 0) Then&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 89px; font-family: 'Courier New';">swApp.<span 
 style="font-weight: bold;">SendMsgToUser</span> &quot;Select a Note first...&quot;</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">Else&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 112px; font-size: 10pt;">' If selected object is 
 a note</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 89px;">If (SelMgr.<span 
 style="font-weight: bold;">GetSelectedObjectType</span>(1) = 15) Then&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 152px; font-size: 10pt;">' Get the Note object 
 from the selection list</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 129px;">Set note = 
 SelMgr.<span style="font-weight: bold;">GetSelectedObject2</span>(1)&nbsp;&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 152px; font-size: 10pt;">' Use the Note object 
 to change the note name</p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 129px;">res = note.<span 
 style="font-weight: bold;">SetName</span> (newNoteName)&nbsp;&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 129px; font-family: 'Courier New';">checkNoteName 
 = note.<span style="font-weight: bold;">GetName</span> </p>

<p class=apiCode
	style="margin-left: 129px;">&nbsp;</p>

<p class=apiCodeComment
	style="margin-left: 152px; font-size: 10pt;">' If note name does not 
 match<font style="font-family: 'Courier New';"
			face="Courier New"> </font></p>

<p class=apiCode
	style="font-family: 'Courier New'; margin-left: 129px;">If (checkNoteName 
 &lt;&gt; newNoteName) Then&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 169px; font-family: 'Courier New';">swApp.<span 
 style="font-weight: bold;">SendMsgToUser</span> &quot;Error changing note 
 name.&quot;&nbsp;&nbsp;</p>

<p class=apiCode
	style="margin-left: 129px; font-family: 'Courier New';">End If</p>

<p class=apiCode
	style="margin-left: 129px;">&nbsp;</p>

<p class=apiCode
	style="margin-left: 89px; font-family: 'Courier New';">End If</p>

<p class=apiCode
	style="margin-left: 89px;">&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px; font-family: 'Courier New';">End If</p>

<p class=apiCode
	style="margin-left: 49px;">&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New';">End Sub</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;</p>

</body>

</html>
