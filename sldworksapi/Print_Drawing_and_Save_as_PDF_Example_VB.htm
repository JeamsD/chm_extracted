<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Print Drawing and Save as PDF Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">

<meta name=MS-HKWD content="VBA examples,PDF">
<meta name=MS-HKWD content="VBA examples,drawings">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1030>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Print Drawing and Save as PDF Example (VBA)</h1>

<p>This example shows how to print a drawing document to your 
 default printer and save it as a PDF file.</p>
<pre>'---------------------------------------------
' Preconditions:
' 1. Open <i>public_documents</i><b>\samples\tutorial\api\2012-sm.slddrw</b>.
' 2. Verify that <b>C:\temp</b> exists.
' 3. Open the Immediate window.
'
' Postconditions:
' 1. Gets the name of your default printer.
' 2. Sets the page orientation to landscape.
' 3. Prints <b>2012-sm.slddrw</b> to your default printer.
' 4. Saves <b>2012-sm.slddrw</b> as <b>C:\temp\2012-sm.pdf</b>.
' 5. Examine the Immediate window, your default printer,
'    and <b>C:\temp</b>.
'---------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim Model As ModelDoc2</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = CreateObject(&quot;SldWorks.Application&quot;)
    Set Model = swApp.<b>ActiveDoc</b>
    Debug.Print Model.<b>Printer</b>    </pre>
<pre>    Dim ps As PageSetup
    Set ps = Model.<b>PageSetup</b>
    ps.<b>Orientation</b> = 2   ' 1=Portrait  '2 = Landscape    </pre>
<pre>    Dim pageArray(3) As Long
    pageArray(0) = 1
    pageArray(1) = 1
    pageArray(2) = 3
    pageArray(3) = 3    </pre>
<pre>    Dim vPageArray As Variant
    vPageArray = pageArray    </pre>
<pre>    Dim copies As Long
    copies = 1
    Dim collate As Boolean
    collate = True    </pre>
<pre>    ' Print to default printer
    Model.Extension.<b>PrintOut2</b> vPageArray, copies, collate, &quot;&quot;, &quot;&quot;    </pre>
<pre>    Dim e As Long
    Dim w As Long    </pre>
<pre>    ' Save to PDF
    Debug.Print Model.<b>SaveAs4</b>(&quot;C:\temp\2012-sm.pdf&quot;, 0, 0, e, w)</pre>
<pre>End Sub</pre>

</body>

</html>
