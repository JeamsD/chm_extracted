<html>

<head>
<title>Move Rollback Bar Using Feature Example(VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,rollback">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Move Rollback Bar Using Feature Example (VBA)</h1>
<p>This example shows how to move the rollback bar above and below a selected 
feature in a part document.</p>

<pre>'-------------------------------------------------------
'&nbsp;Preconditions: Verify that the part&nbsp;to&nbsp;open&nbsp;exists.
' 2. Run the macro.
'
'&nbsp;Postconditions:
'&nbsp;1.&nbsp;Opens&nbsp;the&nbsp;part&nbsp;document.
'&nbsp;2.&nbsp;Selects&nbsp;the&nbsp;Sweep1&nbsp;feature.
'&nbsp;3.&nbsp;Moves the rollback&nbsp;bar&nbsp;to&nbsp;feature&nbsp;above&nbsp;the
'&nbsp;&nbsp;&nbsp;&nbsp;Sweep1&nbsp;feature;&nbsp;i.e.,&nbsp;the&nbsp;Revolve1&nbsp;feature.
'&nbsp;4.&nbsp;Examine&nbsp;the&nbsp;graphics&nbsp;area&nbsp;to&nbsp;verify,&nbsp;then&nbsp;press
'&nbsp;&nbsp;&nbsp;&nbsp;F5
'&nbsp;5.&nbsp;Moves the rollback&nbsp;bar to&nbsp;below&nbsp;the&nbsp;Sweep1&nbsp;feature.
'-------------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim swModel As SldWorks.ModelDoc2
Dim swModelDocExt As SldWorks.ModelDocExtension
Dim swPart As SldWorks.PartDoc
Dim swFeatureMgr As SldWorks.FeatureManager
Dim fileName As String
Dim status As Boolean
Dim errors As Long, warnings As Long</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = Application.SldWorks
    fileName = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2018\samples\tutorial\api\cstick.sldprt&quot;
    Set swModel = swApp.<b>OpenDoc6</b>(fileName, swDocumentTypes_e.swDocPART, swOpenDocOptions_e.swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)
    Set swPart = swModel
    Set swModelDocExt = swModel.Extension    </pre>
<pre>    ' Move rollback bar to above Sweep1
    status = swModelDocExt.<b>SelectByID2</b>(&quot;Sweep1&quot;, &quot;BODYFEATURE&quot;, 0, 0, 0, False, 0, Nothing, 0)
    swPart.<b>EditRollback</b>    </pre>
<pre>    Stop
    'Examine graphics area, then press F5    </pre>
<pre>    ' Move rollback bar to below Sweep1
    Set swFeatureMgr = swModel.<b>FeatureManager</b>
    status = swFeatureMgr.<b>EditRollback</b>(swMoveRollbackBarTo_e.swMoveRollbackBarToBeforeFeature, &quot;&quot;)
    </pre>
<pre>End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
