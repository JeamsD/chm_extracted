<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Show Components and Component Configurations Names and Descriptions Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples,configurations">
<meta name=MS-HKWD content="VBA examples,components">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=2974>
<meta name=layout-width content=750>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Show Components and Component Configurations Names and Descriptions 
 Example (VBA)</h1>

<p>This example shows how to show and hide component and configuration 
 names and descriptions in the FeatureManager design tree.</p>

<pre>'-------------------------------------------------------
' Preconditions:
' 1. Open <i>public_documents</i><b>\samples\tutorial\smartcomponents\pillow_block.sldasm</b>.
' 2. Collapse the <b>bearing&lt;1&gt;</b> component.
' 3. Widen the FeatureManager design tree.
' 4. Open the Immediate window.
'
' Postconditions:
' 1. At each Stop statement, read the comments and press F5
'    to continue.
' 2. Examine the Immediate window.
'-------------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim Part As SldWorks.ModelDoc2
Dim SelMgr As SldWorks.SelectionMgr
Dim swFeatMgr As SldWorks.FeatureManager</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = Application.SldWorks
    Set Part = swApp.<b>ActiveDoc</b>
    Set SelMgr = Part.<b>SelectionManager</b>
    Set swFeatMgr = Part.<b>FeatureManager</b>
    </pre>
<pre>    Debug.Print &quot;Tree Display settings upon opening document&quot;
    Debug.Print vbTab &amp; &quot;Show Component Names                      : &quot; &amp; swFeatMgr.<b>ShowComponentNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Descriptions               : &quot; &amp; swFeatMgr.<b>ShowComponentDescriptions</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Names        : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Descriptions : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> &amp; vbCrLf</pre>
<pre>    Stop
    ' To verify the settings, right-click pillow_block at the
    ' the top of the FeatureManager design tree and point at Tree Display
    ' Compare the settings with the output in the Immediate window
    ' Then click anywhere in the graphics area to close the short-cut menu</pre>
<pre>    ' Examine the FeatureManager design tree to
    ' verify that the names of the components are not shown
</pre>
<pre>    If (swFeatMgr.<b>ShowComponentDescriptions</b>) Then
        swFeatMgr.<b>ShowComponentDescriptions</b> = False
    Else
        swFeatMgr.<b>ShowComponentDescriptions</b> = True
    End If</pre>
<pre>    Stop
    ' Show Component Descriptions is set to true    </pre>
<pre>    ' Examine the FeatureManager design tree, and
    ' verify that the descriptions of the components
    ' are shown
</pre>
<pre>    If (swFeatMgr.<b>ShowComponentConfigurationNames</b>) Then
        swFeatMgr.<b>ShowComponentConfigurationNames</b> = False
    Else
        swFeatMgr.<b>ShowComponentConfigurationNames</b> = True
    End If    </pre>
<pre>    Stop
    ' Show Component Configuration Names is set to false    </pre>
<pre>    ' Examine the FeatureManager design tree, and
    ' verify that the names of the configurations are
    ' not shown</pre>
<pre>    If (swFeatMgr.<b>ShowComponentConfigurationDescriptions</b>) Then
        swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> = False
    Else
        swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> = True
    End If    </pre>
<pre>    Stop
    ' Show Component Configuration Descriptions is set to true    </pre>
<pre>    ' Examine the FeatureManager design tree, and
    ' verify that the descriptions of the configurations
    ' are shown</pre>
<pre>    Debug.Print &quot;Display modified settings&quot;
    Debug.Print vbTab &amp; &quot;Show Component Names                      : &quot; &amp; swFeatMgr.<b>ShowComponentNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Descriptions               : &quot; &amp; swFeatMgr.<b>ShowComponentDescriptions</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Names        : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Descriptions : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> &amp; vbCrLf</pre>
<pre>    ' FeatureManager::ShowComponentNames and FeatureManager::ShowComponentDescriptions
    ' cannot both be set to false
    swFeatMgr.<b>ShowComponentDescriptions</b> = True
    If (swFeatMgr.<b>ShowComponentNames</b>) Then
        swFeatMgr.<b>ShowComponentNames</b> = False
    End If
    </pre>
<pre>    Debug.Print &quot;Try to set FeatureManager::ShowComponentDescriptions to false while FetureManager::ShowComponentNames is false&quot;
    Debug.Print vbTab &amp; &quot;Before call to Show Component Descriptions : &quot; &amp; swFeatMgr.ShowComponentDescriptions
    swFeatMgr.ShowComponentDescriptions = False  ' This call does not work because FeatureManager::ShowComponentNames display is set to false
    Debug.Print vbTab &amp; &quot;After call to Show Component Descriptions  : &quot; &amp; swFeatMgr.ShowComponentDescriptions &amp; vbCrLf</pre>
<pre>    ' Restore original settings
    If (swFeatMgr.<b>ShowComponentDescriptions</b>) Then
        swFeatMgr.<b>ShowComponentNames</b> = True
        swFeatMgr.<b>ShowComponentDescriptions</b> = False
    Else
        swFeatMgr.<b>ShowComponentNames</b> = True
    End If
    </pre>
<pre>    If (swFeatMgr.<b>ShowComponentConfigurationNames</b>) Then
        swFeatMgr.<b>ShowComponentConfigurationNames</b> = False
    Else
        swFeatMgr.<b>ShowComponentConfigurationNames</b> = True
    End If</pre>
<pre>    If (swFeatMgr.<b>ShowComponentConfigurationDescriptions</b>) Then
        swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> = False
    Else
        swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> = True
    End If</pre>
<pre>    Debug.Print &quot;Original settings restored&quot;
    Debug.Print vbTab &amp; &quot;Show Component Names                      : &quot; &amp; swFeatMgr.<b>ShowComponentNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Descriptions               : &quot; &amp; swFeatMgr.<b>ShowComponentDescriptions</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Names        : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationNames</b>
    Debug.Print vbTab &amp; &quot;Show Component Configuration Descriptions : &quot; &amp; swFeatMgr.<b>ShowComponentConfigurationDescriptions</b> &amp; vbCrLf
    </pre>
<pre>    Debug.Print &quot;Macro done executing!&quot;</pre>
<pre>End Sub</pre>

</body>

</html>
