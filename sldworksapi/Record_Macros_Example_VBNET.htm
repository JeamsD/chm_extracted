<html>

<head>
<title>Record Macros Example (VB.NET)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VB.NET examples,macros">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Record Macros Example (VB.NET)</h1>
<p>This example shows how to add two lines to one or more macro recording 
sessions.</p>
<p class="APICODE"><font color="Green" face="Courier New" size="-1">
'---------------------------------------------------------------------------<br>
' Preconditions: Add a reference to <b>SolidWorks.Interop.swcommands.dll</b>.<br>
'<br>
' Postconditions:<br>
' 1. Displays a message box informing you that<br>
'&nbsp;&nbsp;&nbsp;&nbsp;macro recording has started. Click <b>OK</b>.<br>
' 2. Displays the Save as dialog.<br>
</font><font color="#008000">' 3. Type <b>Macro2</b> in <b>File name</b> and 
select the languages<br>
'&nbsp;&nbsp;&nbsp;&nbsp;to which to save macros in <b>Save as type</b>.</font><font face="Courier New" size="-1"><font color="Green"><br>
' 4. Writes two lines of text to the macros in the languages<br>
'&nbsp;&nbsp;&nbsp;&nbsp;corresponding to the <b>Save as type</b> that you selected.<br>
' 5. Displays a message box informing you that<br>
'&nbsp;&nbsp;&nbsp;&nbsp;macro recording has ended. Click <b>OK</b>.<br>
' 6. Displays a message box asking you if you<br>
'&nbsp;&nbsp;&nbsp;&nbsp;want to stop debugging. Click <b>Yes</b>.<br>
' 7. Run the just-recorded macros to verify.<br>
'---------------------------------------------------------------------------<br>
</font><font color="Blue">Imports</font><font color="Black"> 
SolidWorks.Interop.sldworks<br>
</font><font color="Blue">Imports</font><font color="Black"> 
SolidWorks.Interop.swconst<br>
</font><font color="Blue">Imports</font><font color="Black"> 
SolidWorks.Interop.swcommands<br>
</font><font color="Blue">Imports</font><font color="Black"> System<br>
<br>
</font><font color="Blue">Partial</font><font color="Black"> </font>
<font color="Blue">Class</font><font color="Black"> SolidWorksMacro<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Public</font><font color="Black"> </font>
<font color="Blue">WithEvents</font><font color="Black"> swAppEvents </font>
<font color="Blue">As</font><font color="Black"> SldWorks<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Public</font><font color="Black"> </font>
<font color="Blue">Sub</font><font color="Black"> Main()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">' Set up events<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAppEvents = swApp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AttachEventHandlers()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">' Start macro recording<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RunCommand</b>(swCommands_e.swCommands_RecordPauseMacro,
</font><font color="#a31515">&quot;&quot;</font><font color="Black">)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">' Write to VBA macro<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLine</b>(</font><font color="#a31515">&quot;' 
Test&quot;</font><font color="Black">)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLine</b>(</font><font color="#a31515">&quot;MsgBox(&quot;</font><font color="Black"> 
&amp; Chr(34) &amp; </font><font color="#a31515">&quot;C:\Test\&quot;</font><font color="Black"> &amp; 
Chr(34) &amp; </font><font color="#a31515">&quot;)&quot;</font><font color="Black">)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">' Write to C# macro<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLineCSharp</b>(</font><font color="#a31515">&quot;// 
Test&quot;</font><font color="Black">)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLineCSharp</b>(</font><font color="#a31515">&quot;System.Windows.Forms.MessageBox.Show(&quot;</font><font color="Black"> 
+ Chr(34) + </font><font color="#a31515">&quot;C:\\Test\\&quot;</font><font color="Black"> 
+ Chr(34) + </font><font color="#a31515">&quot;);&quot;</font><font color="Black">)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">' Write to VB.NET macro<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLineVBnet</b>(</font><font color="#a31515">&quot;' 
Test&quot;</font><font color="Black">)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RecordLineVBnet</b>(</font><font color="#a31515">&quot;MsgBox(&quot;</font><font color="Black"> 
&amp; Chr(34) &amp; </font><font color="#a31515">&quot;C:\Test\&quot;</font><font color="Black"> &amp; 
Chr(34) &amp; </font><font color="#a31515">&quot;)&quot;</font><font color="Black">)<br>
<br>
&nbsp;</font><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Stop 
macro recording</font><font color="Green"><br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swApp.<b>RunCommand</b>(swCommands_e.swCommands_StopMacro,
</font><font color="#a31515">&quot;&quot;</font><font color="Black">)</font></font></p>
<p class="APICODE"><font face="Courier New" size="-1"><font color="Black"><br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Sub<br>
<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Sub</font><font color="Black"> 
AttachEventHandlers()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AttachSWEvents()<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Sub<br>
<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Sub</font><font color="Black"> 
AttachSWEvents()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">AddHandler</font><font color="Black"> 
swAppEvents.BeginRecordNotify, </font><font color="Blue">AddressOf</font><font color="Black">
</font><font color="Blue">Me</font><font color="Black">.SwAppEvents_BeginRecordNotify<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">AddHandler</font><font color="Black"> 
swAppEvents.EndRecordNotify, </font><font color="Blue">AddressOf</font><font color="Black">
</font><font color="Blue">Me</font><font color="Black">.swAppEvents_EndRecordNotify<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Sub<br>
<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Private</font><font color="Black">
</font><font color="Blue">Function</font><font color="Black"> swAppEvents_<b>BeginRecordNotify</b>()
</font><font color="Blue">As</font><font color="Black"> </font>
<font color="Blue">Integer<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">'Send message when 
the macro recording starts<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox(</font><font color="#a31515">&quot;Macro 
recording starting.&quot;</font><font color="Black">)<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Function<br>
<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Private</font><font color="Black">
</font><font color="Blue">Function</font><font color="Black"> swAppEvents_<b>EndRecordNotify</b>()
</font><font color="Blue">As</font><font color="Black"> </font>
<font color="Blue">Integer<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">'Send message when 
macro recording ends<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox(</font><font color="#a31515">&quot;Macro 
recording ended.&quot;</font><font color="Black">)<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Function<br>
<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">''' </font>
<font color="Gray">&lt;summary&gt;<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">''' The SldWorks swApp 
variable is pre-assigned for you.<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Green">''' </font>
<font color="Gray">&lt;/summary&gt;<br>
</font><font color="Black">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="Blue">Public</font><font color="Black"> 
swApp </font><font color="Blue">As</font><font color="Black"> SldWorks<br>
<br>
<br>
</font><font color="Blue">End</font><font color="Black"> </font>
<font color="Blue">Class</font></font></p>

</body>

</html>
