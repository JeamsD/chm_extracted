<html>

<head>
<title>Rebuild All Features in All Configurations Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,rebuild">
<meta name=MS-HKWD content="VBA examples,configurations">
<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Rebuild All Features in All Configurations Example (VBA)</h1>
<p>This example shows how to rebuild all features in all configurations without activating each configuration.</p>

<pre>'------------------------------------------------------------
' Preconditions:
' 1. Copy <i>public_documents</i><b>\samples\tutorial\PDMWorks</b> to <b>c:\temp</b>.
' 2. Open <b>c:\temp\membrane.sldprt</b>.
'    a. Expand <b>Revolve-Thin1</b>, click <b>Sketch1</b> &gt; <b>Edit Sketch</b>.
'    b. Click <b>R30</b> and change 30 to 60.
'    c. Click <b>File &gt; Save All &gt; Rebuild and save document</b>
'       <b>(recommended)</b>.
'    d. Click <b>File &gt; Close</b>.
' 3. Open <b>c:\temp\speaker.sldasm</b>.
' 4. Click <b>Don't rebuild</b>.
' 5. Open the Immediate window.
'
' Postconditions:
' 1. Rebuilds all features in all configurations without 
'    activating each configuration.
' 2. Examine the Immediate window.
'------------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swModelDocExt As SldWorks.ModelDocExtension
    Dim bRebuild As Boolean
    Dim bRet As Boolean    </pre>
<pre>    Set swApp = CreateObject(&quot;SldWorks.Application&quot;)
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swModelDocExt = swModel.<b>Extension</b>    </pre>
<pre>    bRet = swModelDocExt.<b>NeedsRebuild2</b>
    Debug.Print &quot;Features need to be rebuilt? &quot; &amp; bRet    </pre>
<pre>    If bRet Then
        bRebuild = swModelDocExt.<b>ForceRebuildAll</b>
        Debug.Print &quot;    All features rebuilt in all configurations without activating each configuration? &quot; &amp; bRebuild
    End If</pre>
<pre>End Sub
</pre>

<p>&nbsp;</p>

</body>

</html>
