<html>

<head>
<title>Expand Component in Specified FeatureManager Design Tree Pane Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,components">
<meta name=MS-HKWD content="VBA examples,FeatureManager design tree">
<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Expand Component in Specified FeatureManager Design Tree Pane Example (VBA)</h1>
<p>This example shows how to expand a component in the specified FeatureManager 
design tree pane.</p>

<pre>'-------------------------------------------------------------
' Preconditions:<b>
</b>' 1.<b> </b>Open<b> </b><i>public_documents</i><b>\samples\tutorial\pdmworks\speaker.sldasm</b>.
' 2. Select <b>speaker_frame&lt;1&gt;</b> in the FeatureManager design
'    tree.
'
' Postconditions:
' 1. Expands the selected component in the top pane of the 
'    FeatureManager design tree.
' 2. Examine the top pane of the FeatureManager design tree
'    and the Immediate window.
'
' NOTE: Because this assembly is used elsewhere, do not
' save changes.
'--------------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swAssy As SldWorks.AssemblyDoc
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swFeat As SldWorks.Feature
    Dim swComp As SldWorks.Component2
    Dim swFeatMgr As SldWorks.FeatureManager
    Dim featName As String
    Dim status As Boolean
    </pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swAssy = swModel
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swComp = swSelMgr.<b>GetSelectedObjectsComponent4</b>(1, -1)
    Set swFeat = swAssy.<b>FeatureByName</b>(&quot;speaker_frame-1&quot;)
    Set swFeat = swComp.<b>FeatureByName</b>(&quot;Cut-Extrude1&quot;)
    featName = swFeat.<b>Name</b>
    Set swFeatMgr = swModel.<b>FeatureManager</b>
    status = swFeatMgr.<b>ExpandFeature</b>(swComp, featName, swFeatMgrPane_e.swFeatMgrPaneTop)
    Debug.Print &quot;Selected component expanded in top pane of FeatureManager design tree? &quot; &amp; status
    </pre>
<pre>End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
