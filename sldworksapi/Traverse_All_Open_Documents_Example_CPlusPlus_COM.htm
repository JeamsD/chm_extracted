<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Traverse All Open Documents Example (C++ COM)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=date content="03 18, 2002 11:50:10 AM">
<meta name=MS-HAID content=ZExample_Traverse_All_Open_Documents>
<meta name=MS-HAID content=EXTraverseAllOpenDocuments>
<meta name=MS-HKWD content=Traverse>
<meta name=MS-HKWD content="Traverse,documents">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1050>
<meta name=layout-width content=630>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Traverse All Open Documents Example (C++ COM)</h1>

<p class=apiDescriptionText>This example shows how to traverse all open 
 documents. </p>

<p class=apiDescriptionText>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">bool CFileReferenceTests::isFileOpen(CString 
 fileSpec)</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">{</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;bool retval = FALSE;</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;HRESULT hres = S_FALSE;</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;if (fileSpec.IsEmpty())</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;return retval;</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;LPENUMDOCUMENTS pDocEnum 
 = NULL;</font></p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;hres = TheApplication-&gt;m_pSldWorks-&gt;<span 
 style="font-weight: bold;">EnumDocuments2</span>(&amp;pDocEnum);</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;</font>// No documents 
 open</p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;if (pDocEnum == NULL)&nbsp;&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;return retval;</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;int docNum = 0;</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;LPMODELDOC pModelDoc = 
 NULL;</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;hres = pDocEnum-&gt;Next(1, 
 &amp;pModelDoc, NULL);</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;while (S_OK == hres)</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;{</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;BSTR bdocName;</font></p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;&nbsp;hres = pModelDoc-&gt;<span 
 style="font-weight: bold;">GetPathName</span>(&amp;bdocName);</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;CString docName(bdocName);</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;</font>// 
 File name matches</p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;&nbsp;if (fileSpec.CompareNoCase(docName) 
 == 0)&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;&nbsp;retval = TRUE;</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;pModelDoc-&gt;Release();</font></p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;&nbsp;pModelDoc = NULL;</font></p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;&nbsp;hres = pDocEnum-&gt;<span 
 style="font-weight: bold;">Next</span>(1, &amp;pModelDoc, NULL);</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;}</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;if (pDocEnum != NULL) 
 pDocEnum-&gt;Release();</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">&nbsp;return retval;</font></p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New';">}</p>

<p class=apiCode>&nbsp;</p>

<p class=apiCode
	style="font-family: 'Courier New';">&nbsp;</p>

</body>

</html>
