<html>

<head>
<title>Create Bidirectional Linear Pattern Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,patterns">
<meta name=MS-HKWD content="VBA examples,linear patterns">
<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Create Bidirectional Linear Pattern Example (VBA)</h1>
<p>This example shows how to create a bidirectional linear pattern.</p>

<pre>'----------------------------------------------------
' Preconditions: Verify that the part exists.
'
' Postconditions:
' 1. Opens the part.
' 2. Selects the feature to pattern.
' 3. Selects the edges for Direction 1 and
'    Direction 2 for the bidirectional linear
'    pattern.
' 4. Creates a bidirectional linear pattern.
' 5. Examine the FeatureManager design tree and
'    graphics area.
'
' NOTE: Because the part is used elsewhere, do not save
' changes.
'------------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim swModel As SldWorks.ModelDoc2
Dim swModelDocExt As SldWorks.ModelDocExtension
Dim swFeatureManager As SldWorks.FeatureManager
Dim swFeature As SldWorks.Feature
Dim status As Boolean
Dim errors As Long
Dim warnings As Long
Dim fileName As String</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = Application.SldWorks
    fileName = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2018\samples\tutorial\api\box.sldprt&quot;
    Set swModel = swApp.<b>OpenDoc6</b>(fileName, swDocumentTypes_e.swDocPART, swOpenDocOptions_e.swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)
    Set swModelDocExt = swModel.<b>Extension</b>
    Set swFeatureManager = swModel.<b>FeatureManager</b>    </pre>
<pre>    'Select feature to pattern
    status = swModelDocExt.<b>SelectByID2</b>(&quot;CBORE for #6 Binding Head Machine Screw1&quot;, &quot;BODYFEATURE&quot;, 0, 0, 0, False, 4, Nothing, 0)

    'Select edges for Direction 1 and Direction 2
    status = swModelDocExt.<b>SelectByID2</b>(&quot;&quot;, &quot;EDGE&quot;, -3.41223962029176E-02, 3.00321434688158E-02, 4.60303188361877E-02, True, 1, Nothing, 0)
    status = swModelDocExt.<b>SelectByID2</b>(&quot;&quot;, &quot;EDGE&quot;, 4.36465176948104E-02, 3.01916139486593E-02, 1.14344277122314E-02, True, 2, Nothing, 0)</pre>
<pre>    'Create linear pattern
    Set swFeature = swFeatureManager.<b>FeatureLinearPattern5</b>(3, 0.01, 3, 0.01, False, False, &quot;NULL&quot;, &quot;NULL&quot;, True, False, False, False, False, False, True, True, False, False, 0, 0, False, False)    </pre>
<pre>End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
