<html>

<head>
<title>Create and Modify Cavity Feature Example (VB.NET)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VB.NET examples,feature">
<meta name=MS-HKWD content="VB.NET examples,cavity">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Create and Modify Cavity Feature Example (VB.NET)</h1>
<p>This example shows how to create and modify a cavity feature.</p>
<pre style="font-family: Courier New; color: black; background: white"><span style="color:green;"><font size="2">'-----------------------------------------------------------------------------------------------</font></span><font size="2">
<span style="color:green;">'&nbsp;Preconditions:</span>
<span style="color:green;">'&nbsp;1.&nbsp;Create&nbsp;a&nbsp;new&nbsp;folder&nbsp;and&nbsp;copy&nbsp;<i>public_documents</i><b>\samples\tutorial\molds\telephone.sldprt</b>&nbsp;to&nbsp;that</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;folder.</span>
<span style="color:green;">'&nbsp;2.&nbsp;</span></font><span style="color:green;">Click <b>File &gt; New &gt; Part</b> and <b>OK</b> to create&nbsp;a&nbsp;new&nbsp;part&nbsp;document.</span><font size="2">
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Insert&nbsp;a&nbsp;sketch&nbsp;of&nbsp;a&nbsp;rectangle&nbsp;with&nbsp;a&nbsp;length&nbsp;of&nbsp;240&nbsp;mm&nbsp;and&nbsp;width&nbsp;of&nbsp;350&nbsp;mm.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Using&nbsp;the&nbsp;sketch,&nbsp;create&nbsp;a&nbsp;boss&nbsp;extrude&nbsp;feature&nbsp;with&nbsp;a&nbsp;depth&nbsp;of&nbsp;160&nbsp;mm.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;part&nbsp;as&nbsp;<b>telephoneMoldBase.sldprt</b>&nbsp;in&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1.</span>
<span style="color:green;">'&nbsp;3.</span></font><span style="color:green;">Click <b>File &gt; New &gt; Assembly</b> and <b>OK</b> to create&nbsp;a&nbsp;new&nbsp;assembly&nbsp;document.</span><font size="2">
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Click&nbsp;<b>telephoneMoldBase</b>&nbsp;in&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>&nbsp;in&nbsp;the&nbsp;PropertyManager&nbsp;page.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Click&nbsp;<b>OK</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Click&nbsp;<b>Insert&nbsp;Components</b>&nbsp;on&nbsp;the&nbsp;Assembly&nbsp;toolbar,&nbsp;click&nbsp;<b>Browse</b>&nbsp;in</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>,&nbsp;click&nbsp;<b>telephone.sldprt</b>&nbsp;located&nbsp;in&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1,</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;click&nbsp;<b>Open</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Drop&nbsp;<b>telephone.sldprt</b>&nbsp;in&nbsp;the&nbsp;graphics&nbsp;area.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Click&nbsp;<b>View&nbsp;&gt;&nbsp;Display&nbsp;&gt;&nbsp;Hidden&nbsp;Lines&nbsp;Visible</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;In&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree,&nbsp;click&nbsp;<b>telephone&lt;1&gt;&nbsp;</b>and click&nbsp;<b>Move&nbsp;Component</b></span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;Assembly&nbsp;toolbar.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Move&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;into&nbsp;the&nbsp;center&nbsp;of&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>OK</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;h.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;Save&nbsp;All&nbsp;&gt;&nbsp;Rebuild&nbsp;and&nbsp;save&nbsp;the&nbsp;document&nbsp;(recommended)</b>,&nbsp;navigate&nbsp;to&nbsp;the</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1,&nbsp;type&nbsp;<b>AssemInterim.sldasm</b>&nbsp;in&nbsp;<b>File&nbsp;name</b>,&nbsp;and&nbsp;click&nbsp;<b>Save</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;In&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree,&nbsp;click&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>Edit&nbsp;Component</b></span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;Assembly&nbsp;toolbar.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;j.&nbsp;Click&nbsp;<b>Cavity</b>&nbsp;on&nbsp;the&nbsp;Mold&nbsp;Tools&nbsp;toolbar.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;k.&nbsp;Click&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree&nbsp;for&nbsp;the&nbsp;design&nbsp;component.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;l.&nbsp;Clear&nbsp;<b>Scale&nbsp;uniformly</b>&nbsp;and&nbsp;set&nbsp;<b>X,&nbsp;Y,&nbsp;</b>and&nbsp;<b>Z</b>&nbsp;to&nbsp;0,&nbsp;if&nbsp;necessary.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;m.&nbsp;Click&nbsp;<b>OK</b>&nbsp;to&nbsp;create&nbsp;the&nbsp;cavity&nbsp;feature&nbsp;and&nbsp;close&nbsp;the&nbsp;PropertyManager&nbsp;page.</span>
<span style="color:green;">'&nbsp;4.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;Save&nbsp;All</b>.</span>
<span style="color:green;">'&nbsp;5.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;Close</b>&nbsp;two&nbsp;times.</span>
<span style="color:green;">'&nbsp;6.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;AssemInterim.sldasm</b>.</span>
<span style="color:green;">'&nbsp;7.&nbsp;Open&nbsp;the&nbsp;Immediate&nbsp;window.</span>
<span style="color:green;">'&nbsp;8.&nbsp;Run&nbsp;the&nbsp;macro.</span>
<span style="color:green;">'</span>
<span style="color:green;">'&nbsp;Postconditions:</span>
<span style="color:green;">'&nbsp;1.&nbsp;Accesses&nbsp;<b>Cavity&lt;1&gt;</b>&nbsp;and&nbsp;gets&nbsp;and&nbsp;sets&nbsp;scale-related&nbsp;properties.</span>
<span style="color:green;">'&nbsp;2.&nbsp;When&nbsp;the&nbsp;macro&nbsp;finishes&nbsp;executing,&nbsp;click&nbsp;<b>File&nbsp;&gt;&nbsp;Close </b>and <b>Save&nbsp;All</b>.</span>
<span style="color:green;">'&nbsp;3.&nbsp;Open&nbsp;<b>AssemInterim.sldasm</b>,&nbsp;click&nbsp;<b>Yes</b>&nbsp;to&nbsp;roll&nbsp;forward,&nbsp;and&nbsp;click&nbsp;<b>Rebuild</b>&nbsp;to&nbsp;rebuild.</span>
<span style="color:green;">'&nbsp;4.&nbsp;Expand&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree.</span>
<span style="color:green;">'&nbsp;5.&nbsp;Right-click&nbsp;the&nbsp;<b>Cavity1</b>&nbsp;feature,&nbsp;click&nbsp;<b>Edit&nbsp;Feature</b>,&nbsp;click&nbsp;<b>OK</b>&nbsp;if a message&nbsp;box displays,&nbsp;and</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;compare&nbsp;the&nbsp;values&nbsp;in&nbsp;the&nbsp;PropertyManager&nbsp;page&nbsp;with&nbsp;the&nbsp;new&nbsp;values&nbsp;shown&nbsp;in&nbsp;the</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;Immediate&nbsp;window.</span>
<span style="color:green;">'&nbsp;6.&nbsp;Click&nbsp;<b>OK</b>.</span>
<span style="color:green;">'&nbsp;7.&nbsp;Close&nbsp;<b>File&nbsp;&gt;&nbsp;Close</b>&nbsp;<b>&gt;</b>&nbsp;<b>Save&nbsp;All</b>.</span>
<span style="color:green;">'-----------------------------------------------------------------------------------------------</span>
<span style="color:blue;">Imports</span>&nbsp;SolidWorks.Interop.sldworks
<span style="color:blue;">Imports</span>&nbsp;SolidWorks.Interop.swconst
<span style="color:blue;">Imports</span>&nbsp;System.Runtime.InteropServices
<span style="color:blue;">Imports</span>&nbsp;System
<span style="color:blue;">Imports</span>&nbsp;System.Diagnostics
 
<span style="color:blue;">Partial</span>&nbsp;<span style="color:blue;">Class</span>&nbsp;<span style="color:#2b91af;">SolidWorksMacro</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Sub</span>&nbsp;main()
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swModel&nbsp;<span style="color:blue;">As</span>&nbsp;ModelDoc2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swModelDocExt&nbsp;<span style="color:blue;">As</span>&nbsp;ModelDocExtension
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swSelectionMgr&nbsp;<span style="color:blue;">As</span>&nbsp;SelectionMgr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swFeature&nbsp;<span style="color:blue;">As</span>&nbsp;Feature
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swCavityFeatureData&nbsp;<span style="color:blue;">As</span>&nbsp;CavityFeatureData
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;status&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:blue;">Boolean</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;xScale&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:blue;">Double</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;yScale&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:blue;">Double</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;zScale&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:blue;">Double</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModel&nbsp;=&nbsp;swApp.<b>ActiveDoc</b>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModelDocExt&nbsp;=&nbsp;swModel.<b>Extension</b>
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'Select&nbsp;the&nbsp;Cavity1&nbsp;feature&nbsp;and&nbsp;get&nbsp;and&nbsp;set&nbsp;its&nbsp;properties</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;=&nbsp;swModelDocExt.<b>SelectByID2</b>(<span style="color:#a31515;">&quot;Cavity1@telephoneMoldBase-1@AssemInterim&quot;</span>,&nbsp;<span style="color:#a31515;">&quot;BODYFEATURE&quot;</span>,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;<span style="color:blue;">False</span>,&nbsp;0,&nbsp;<span style="color:blue;">Nothing</span>,&nbsp;0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swSelectionMgr&nbsp;=&nbsp;swModel.<b>SelectionManager</b>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swFeature&nbsp;=&nbsp;swSelectionMgr.<b>GetSelectedObject6</b>(1,&nbsp;-1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCavityFeatureData&nbsp;=&nbsp;swFeature.<b>GetDefinition</b>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;=&nbsp;swCavityFeatureData.<b>AccessSelections</b>(swModel,&nbsp;<span style="color:blue;">Nothing</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;Scale&nbsp;type:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;swCavityFeatureData.<b>ScaleType</b>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;Scale&nbsp;uniformly&nbsp;value:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;swCavityFeatureData.<b>UseUniformScale</b>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCavityFeatureData.<b>GetScale</b>(xScale,&nbsp;yScale,&nbsp;zScale)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;Scale&nbsp;values:&quot;</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;&nbsp;&nbsp;X:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;xScale)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;&nbsp;&nbsp;Y:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;yScale)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;&nbsp;&nbsp;Z:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;zScale)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;Value&nbsp;by&nbsp;which&nbsp;to&nbsp;scale&nbsp;this&nbsp;cavity&nbsp;feature&nbsp;in&nbsp;all&nbsp;directions:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;swCavityFeatureData.<b>UniformScale</b>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;&quot;</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCavityFeatureData.<b>UseUniformScale</b>&nbsp;=&nbsp;<span style="color:blue;">True</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;New&nbsp;scale&nbsp;uniformly&nbsp;value:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;swCavityFeatureData.<b>UseUniformScale</b>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCavityFeatureData.<b>UniformScale</b>&nbsp;=&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;New&nbsp;value&nbsp;by&nbsp;which&nbsp;to&nbsp;scale&nbsp;this&nbsp;cavity&nbsp;feature&nbsp;in&nbsp;all&nbsp;directions:&nbsp;&quot;</span>&nbsp;&amp;&nbsp;swCavityFeatureData.<b>UniformScale</b>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;=&nbsp;swFeature.<b>ModifyDefinition</b>(swCavityFeatureData,&nbsp;swModel,&nbsp;<span style="color:blue;">Nothing</span>)
 
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Sub</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;</span><span style="color:gray;">&lt;summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;The&nbsp;SldWorks&nbsp;swApp&nbsp;variable&nbsp;is&nbsp;pre-assigned&nbsp;for&nbsp;you.</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;</span><span style="color:gray;">&lt;/summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;swApp&nbsp;<span style="color:blue;">As</span>&nbsp;SldWorks
 
 
<span style="color:blue;">End</span>&nbsp;</font><span style="color:blue;"><font size="2">Class</font></span></pre>

</body>

</html>
