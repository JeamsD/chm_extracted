<html>

<head>
<title>Insert Spline Point Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,splines">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Insert Spline Point Example (VBA)</h1>
<p>This example shows how to insert a spline point in a spline sketch.</p>

<pre>'----------------------------------------------------------------------------
' Preconditions: Verify that the specified template exists.
'
' Postconditions:
' 1. Sketches a spline containing four spline points.
' 2. Inserts a fifth spline point.
' 3. Examine the graphics area.
'---------------------------------------------------------------------------
Dim swApp As SldWorks.SldWorks
Dim Part As SldWorks.ModelDoc2
Dim skSegment As SldWorks.SketchSegment</pre>
<pre>Option Explicit
Sub main()
    
</pre>
<pre>    Set swApp = Application.SldWorks
    Set Part = swApp.NewDocument(&quot;C:\ProgramData\SOLIDWORKS\SOLIDWORKS 2017\templates\Part.prtdot&quot;, 0, 0, 0)
    
</pre>
<pre>    Dim pointArray As Variant
    Dim points() As Double
    ReDim points(0 To 11) As Double
    points(0) = -6.25070182577474E-02
    points(1) = 7.39156869269664E-03
    points(2) = 0
    points(3) = -4.20233044773113E-02
    points(4) = 3.50529989729012E-02
    points(5) = 0
    points(6) = 2.78754181857153E-02
    points(7) = -1.65377796333246E-02
    points(8) = 0
    points(9) = 4.03878396197683E-02
    points(10) = 4.06222157061507E-02
    points(11) = 0
    pointArray = points
    
</pre>
<pre>    Set skSegment = Part.SketchManager.CreateSpline((pointArray))
    Part.InsertSplinePoint 3.82447809668287E-02, 7.81095184375528E-03, 0
    Part.SketchManager.InsertSketch True
    
</pre>
<pre>End Sub</pre>
<pre> </pre>

<p class="APICODE">
-</p>
<p class="APICODE">Dim swApp As SldWorks.SldWorks<br>
Dim Part As SldWorks.ModelDoc2<br>
Dim skSegment As SldWorks.SketchSegment</p>
<p class="APICODE">Option Explicit<br>
Sub main()<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set swApp = Application.<b>SldWorks</b><br>
&nbsp;&nbsp;&nbsp; Set Part = swApp.<b>NewDocument</b>(&quot;C:\ProgramData\SOLIDWORKS\SOLIDWORKS 
2012\templates\Part.prtdot&quot;, 0, 0, 0)<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Dim pointArray As Variant<br>
&nbsp;&nbsp;&nbsp; Dim points() As Double<br>
&nbsp;&nbsp;&nbsp; ReDim points(0 To 11) As Double<br>
&nbsp;&nbsp;&nbsp; points(0) = -6.25070182577474E-02<br>
&nbsp;&nbsp;&nbsp; points(1) = 7.39156869269664E-03<br>
&nbsp;&nbsp;&nbsp; points(2) = 0<br>
&nbsp;&nbsp;&nbsp; points(3) = -4.20233044773113E-02<br>
&nbsp;&nbsp;&nbsp; points(4) = 3.50529989729012E-02<br>
&nbsp;&nbsp;&nbsp; points(5) = 0<br>
&nbsp;&nbsp;&nbsp; points(6) = 2.78754181857153E-02<br>
&nbsp;&nbsp;&nbsp; points(7) = -1.65377796333246E-02<br>
&nbsp;&nbsp;&nbsp; points(8) = 0<br>
&nbsp;&nbsp;&nbsp; points(9) = 4.03878396197683E-02<br>
&nbsp;&nbsp;&nbsp; points(10) = 4.06222157061507E-02<br>
&nbsp;&nbsp;&nbsp; points(11) = 0<br>
&nbsp;&nbsp;&nbsp; pointArray = points<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set skSegment = Part.<b>SketchManager</b>.<b>CreateSpline</b>((pointArray))<br>
&nbsp;&nbsp;&nbsp; Part.<b>InsertSplinePoint</b> 3.82447809668287E-02, 
7.81095184375528E-03, 0<br>
&nbsp;&nbsp;&nbsp; Part.<b>SketchManager</b>.<b>InsertSketch</b> True<br>
&nbsp;&nbsp;&nbsp; </p>
<p class="APICODE">End Sub</p>

<p>&nbsp;</p>

</body>

</html>
