<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <title>RayIntersections Method (IModelDocExtension)</title>
    <link href="stylesheets/dotnet2005.css" type="text/css" rel="stylesheet">
    <script src="script/dotnet2005.js" type="text/javascript">
</script><xml>
<MSHelp:Keyword Index="F" Term="SolidWorks.Interop.sldworks.IModelDocExtension.RayIntersections" />
<MSHelp:Attr Name="DevLang" Value="CSharp" />
<MSHelp:Attr Name="DevLang" Value="VB" />
<MSHelp:Attr Name="DevLang" Value="JScript" />
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="LinkGroup" Value="Help"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
<MSHelp:Attr Name="HelpPriority" Value="1"/>
</xml>

    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
</head>

<body id="dxBody" topmargin="0">
    <form>
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset"> <img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/collapse.gif"> <img id="expandImage"
        style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id="collapseAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
        src="dotnetimages/collapse.gif"> <img id="expandAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id=
        "dropDownImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown.gif"> <img id="dropDownHoverImage" style=
        "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown_orange.gif"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src=
        "dotnetimages/copycode.gif"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/copycodeHighlight.gif"> 
        
    </form>

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">SOLIDWORKS API Help</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension~RayIntersections.html">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">RayIntersections Method (IModelDocExtension)</span></td>
                </tr>

                <tr id="pagetoptable1row3">
                    <td colspan="2"><a onclick="javascript:openSectionById('seeAlsoSectionHeader');" href="#seealsobookmark">
                    See Also</a>&nbsp; 
                    </td>
                </tr>
            </tbody>
        </table>

        <table id="pagetoptable2" cellspacing="0" cellpadding="0" width="100%">
            <tbody>
                <tr>
                    <td><span id="toggleExpandedAll"><img class="toggleAll" id="toggleExpandedAllImage" src="dotnetimages/collapse.gif"> <label id=
                    "collapseAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">Collapse All</label> <label id="expandAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">
                    Expand All</label></span> <span id="languageFilterToolTip"
                    onmouseover='document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' style="CURSOR: default"
                    onfocusout='document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;' onclick=
                    "showBox('dxlanguagemenu',event,document.getElementById('languageFilterImage'))" onfocusin=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' onmouseout=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;'><img id="languageFilterImage" src=
                    "dotnetimages/drpdown.gif"> <label id="showAllLabel" style="DISPLAY: none" for="languageFilterImage">
                    Language Filter: All</label> <label id="multipleLabel" style=
                    "DISPLAY: none" for="languageFilterImage">Language Filter: Multiple</label> 
                    
<label id="VBLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Declaration)</label>
<label id="VBUsageLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Usage)</label>
<label id="CSLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
<label id="CPP2005Label" for="languageFilterImage" style="display: none;">Language Filter: C++/CLI</label>
</span></td>
                </tr>
            </tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace.html">SolidWorks.Interop.sldworks Namespace</a>
 > <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension.html">IModelDocExtension Interface</a>
 : RayIntersections Method (IModelDocExtension)</td></tr></table>

        <div class="dxpopupbubble" id="dxlanguagemenu">
            
<input id="VBCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBCheckbox">
Visual Basic (Declaration)
</label>
<br /><input id="VBUsageCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBUsageCheckbox">
Visual Basic (Usage)
</label>
<br /><input id="CSCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CSCheckbox">
C#
</label>
<br /><input id="CPP2005Checkbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CPP2005Checkbox">
C++/CLI
</label>

        </div>
<div id="BodiesIn_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>BodiesIn</I></DT>
<DD class="popupbubble">Array of&nbsp;<A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IBody2.html">bodies</A>&nbsp;that are <!--kadov_tag{{</spaces>}}-->hit by the rays (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="BasePointsIn_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>BasePointsIn</I></DT>
<DD class="popupbubble">Array of doubles containing the x,y,z base points of each ray</DD></DL>
</div>
<div id="VectorsIn_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>VectorsIn</I></DT>
<DD class="popupbubble">Array of doubles containing the direction vectors of each ray</DD></DL>
</div>
<div id="Options_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>Options</I></DT>
<DD class="popupbubble">Options as defined in <A href="ms-its:swconst.chm::/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRayPtsOpts_e.html"><FONT color=#0066cc>swRayPtsOpts_e</FONT></A>&nbsp;(see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="HitRadius_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>HitRadius</I></DT>
<DD class="popupbubble">Radius of hit cylinder; this is used mainly in grazing cases to establish a hit (see <STRONG>Remarks</STRONG>)</DD></DL>
</div>
<div id="Offset_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>Offset</I></DT>
<DD class="popupbubble">Length tolerance to use to establish whether a hit on a face represents the entry or exit of the ray from the body (see <SPAN style="FONT-WEIGHT: bold">Remarks</SPAN>)</DD></DL>
</div>
<div id="HighPrecision_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>HighPrecision</I></DT>
<DD class="popupbubble">True to&nbsp;use maximum precision when evaluating intersections close to the ray boundary, false to use dynamic precision based on the ray radius&nbsp;(see <STRONG>Remarks</STRONG>)</DD></DL>
</div>

    </div>

    <div id="pagebody" valign="bottom">
        <a name="topBookmark"></a>

        <div id="mainbody">
            <div class="saveHistory" id="allHistory" onsave="saveAll()" onload="loadAll()"></div>
             Finds the intersections between the specified set of rays and the specified set of bodies. 
             
             
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>.NET Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection"><DIV class=LanguageSpecific id=Syntax_VB><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Declaration)</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>Function RayIntersections( _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="BodiesIn" href="#" onclick="javascript:showParamBox(event);">BodiesIn</a></i> As System.Object, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="BasePointsIn" href="#" onclick="javascript:showParamBox(event);">BasePointsIn</a></i> As System.Object, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="VectorsIn" href="#" onclick="javascript:showParamBox(event);">VectorsIn</a></i> As System.Object, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="Options" href="#" onclick="javascript:showParamBox(event);">Options</a></i> As System.Integer, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="HitRadius" href="#" onclick="javascript:showParamBox(event);">HitRadius</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="Offset" href="#" onclick="javascript:showParamBox(event);">Offset</a></i> As System.Double, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="HighPrecision" href="#" onclick="javascript:showParamBox(event);">HighPrecision</a></i> As System.Boolean _
) As System.Integer</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_VBUsage><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Usage)</th><th><span class="copyCode" onclick="copyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="dotnetimages/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Dim instance As <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension.html">IModelDocExtension</a>
Dim BodiesIn As System.Object
Dim BasePointsIn As System.Object
Dim VectorsIn As System.Object
Dim Options As System.Integer
Dim HitRadius As System.Double
Dim Offset As System.Double
Dim HighPrecision As System.Boolean
Dim value As System.Integer
&nbsp;
value = instance.RayIntersections(BodiesIn, BasePointsIn, VectorsIn, Options, HitRadius, Offset, HighPrecision)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CS><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C#</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.int RayIntersections( 
&nbsp;&nbsp;&nbsp;System.object <i><a class="parameter" id="BodiesIn" href="#" onclick="javascript:showParamBox(event);">BodiesIn</a></i>,
&nbsp;&nbsp;&nbsp;System.object <i><a class="parameter" id="BasePointsIn" href="#" onclick="javascript:showParamBox(event);">BasePointsIn</a></i>,
&nbsp;&nbsp;&nbsp;System.object <i><a class="parameter" id="VectorsIn" href="#" onclick="javascript:showParamBox(event);">VectorsIn</a></i>,
&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="Options" href="#" onclick="javascript:showParamBox(event);">Options</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="HitRadius" href="#" onclick="javascript:showParamBox(event);">HitRadius</a></i>,
&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="Offset" href="#" onclick="javascript:showParamBox(event);">Offset</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="HighPrecision" href="#" onclick="javascript:showParamBox(event);">HighPrecision</a></i>
)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CPP2005><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C++/CLI</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.int RayIntersections( 
&&nbsp;&nbsp;&nbsp;System.Object^ <i><a class="parameter" id="BodiesIn" href="#" onclick="javascript:showParamBox(event);">BodiesIn</a></i>,
&&nbsp;&nbsp;&nbsp;System.Object^ <i><a class="parameter" id="BasePointsIn" href="#" onclick="javascript:showParamBox(event);">BasePointsIn</a></i>,
&&nbsp;&nbsp;&nbsp;System.Object^ <i><a class="parameter" id="VectorsIn" href="#" onclick="javascript:showParamBox(event);">VectorsIn</a></i>,
&&nbsp;&nbsp;&nbsp;System.int <i><a class="parameter" id="Options" href="#" onclick="javascript:showParamBox(event);">Options</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="HitRadius" href="#" onclick="javascript:showParamBox(event);">HitRadius</a></i>,
&&nbsp;&nbsp;&nbsp;System.double <i><a class="parameter" id="Offset" href="#" onclick="javascript:showParamBox(event);">Offset</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="HighPrecision" href="#" onclick="javascript:showParamBox(event);">HighPrecision</a></i>
) </pre></tr></table></div>
 
            <b><font color=RED>NOTE:</font></b> See <a href=DifferencesBetweenUnManagedAndCPPCLI.htm>Differences Between Unmanaged C++ and C++/CLI Code</a>.<h4 class=dxh4>Parameters</h4><DL><DT><I>BodiesIn</I></DT>
<DD>Array of&nbsp;<A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IBody2.html">bodies</A>&nbsp;that are <!--kadov_tag{{</spaces>}}-->hit by the rays (see <STRONG>Remarks</STRONG>)</DD><DT><I>BasePointsIn</I></DT>
<DD>Array of doubles containing the x,y,z base points of each ray</DD><DT><I>VectorsIn</I></DT>
<DD>Array of doubles containing the direction vectors of each ray</DD><DT><I>Options</I></DT>
<DD>Options as defined in <A href="ms-its:swconst.chm::/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRayPtsOpts_e.html"><FONT color=#0066cc>swRayPtsOpts_e</FONT></A>&nbsp;(see <STRONG>Remarks</STRONG>)</DD><DT><I>HitRadius</I></DT>
<DD>Radius of hit cylinder; this is used mainly in grazing cases to establish a hit (see <STRONG>Remarks</STRONG>)</DD><DT><I>Offset</I></DT>
<DD>Length tolerance to use to establish whether a hit on a face represents the entry or exit of the ray from the body (see <SPAN style="FONT-WEIGHT: bold">Remarks</SPAN>)</DD><DT><I>HighPrecision</I></DT>
<DD>True to&nbsp;use maximum precision when evaluating intersections close to the ray boundary, false to use dynamic precision based on the ray radius&nbsp;(see <STRONG>Remarks</STRONG>)</DD></DL> 
             
            <h4 class=dxh4>Return Value</h4>Number of intersections</div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="visualbasic6syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Visual Basic for Applications (VBA) Syntax</span></h1><div id="visualbasic6syntaxSection" class="section" name="collapseableSection">See <A href="ms-its:sldworksapivb6.chm::/sldworks~ModelDocExtension~RayIntersections.html">ModelDocExtension::RayIntersections</A>.</div> 
             
             <a name="exampleBookmark"></a>
             
             
            
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection"><P>The method performs intersection operations between the specified bodies and the specified ray vectors. To get the results (a set of intersection points, intersection normals, and the bodies&nbsp;from your BodiesIn array that were hit), you must call <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IModelDoc2~GetRayIntersectionsPoints.html">IModelDoc2::GetRayIntersectionsPoints</A> and <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IModelDoc2~GetRayIntersectionsTopology.html">IModelDoc2::GetRayIntersectionTopology</A>.</P>
<P>Information returned by IModelDoc2::GetRayIntersectionsPoints and IModelDoc2::GetRayIntersectionTopology depends partially on the value of the Options parameter. Valid Option values can be combined using bitwise operations. See IModelDoc2::GetRayIntersectionsPoints&nbsp;to&nbsp;determine which data is always output regardless of the values specified&nbsp;by Options.</P>
<P>For each ray that hits an edge or a vertex, the Offset value is added in both the positive and negative directions along the ray, and the points computed are tested for spatial inclusion in the hit body. This determines&nbsp;whether the ray was entering, leaving, or just grazing the body at the hit point. Entry and exit for faces can be computed and does not require an offset.</P>
<P>The difference between this method and the now obsolete IModelDoc2::RayIntersections and IModelDoc2::IRayIntersections is the HighPrecision&nbsp;parameter. Setting HighPrecision to true forces use of the highest possible precision when evaluating intersections close to ray profile boundaries. Setting&nbsp;HighPrecision to false&nbsp;forces use of a&nbsp;dynamic tolerance that is based on the&nbsp;HitRadius, which&nbsp;is&nbsp;the behavior of the&nbsp;obsolete methods.</P>
<P>The actual ray profile is polygonal, approximating an ideal circular ray profile of HitRadius. Evaluating intersections very close to the ray profile boundary may produce unexpected results due to this polygonal approximation. Experimentation with HighPrecision is recommended.</P></div>&nbsp;
            <a name="seealsobookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><h4 class="dxh4"></h4><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension.html">IModelDocExtension Interface</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension_members.html">IModelDocExtension Members</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2~MultiSelectByRay.html">IModelDoc2::MultiSelectByRay Method ()</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2~SelectByRay.html">IModelDoc2::SelectByRay Method ()</a>
</p>
</div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="availabilityToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Availability</span></h1><div id="availabilitySection" class="section" name="collapseableSection">SOLIDWORKS 2018 SP02, Revision Number 26.2</div>
        </div>

        <div id="pagefooter"></div>
    </div>
</body>
</html>