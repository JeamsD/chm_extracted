<html>

<head>
<title>Modify Multiple Drawing Sheets Setups Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,sheets">
<meta name=MS-HKWD content="VBA examples,drawing sheets">
<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Modify Multiple Drawing Sheets Setups Example (VBA)</h1>
<p>This example shows how to modify the setups of multiple drawing sheets.</p>

<pre>'--------------------------------------------------------------
' Preconditions:
' 1. Verify that the drawing and sheet format files exist.
' 2. Open the Immediate window.
'
' Postconditions:
' 1. Opens the drawing.
' 2. Sets <b>Sheet1</b>, <b>Sheet2</b> and <b>Sheet3</b> drawing sheet formats 
'    to portrait.
' 3. Rebuilds the drawing.
' 4. Click each sheet tab, click <b>Zoom to Fit</b>, and examine
'    the sheet.
'
' NOTE: Because the drawing is used elsewhere, do not
' save changes.
'--------------------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim swModel As SldWorks.ModelDoc2
Dim swModelDocExt As SldWorks.ModelDocExtension
Dim swDrawing As SldWorks.DrawingDoc
Dim fileName As String
Dim status As Boolean
Dim errors As Long
Dim warnings As Long
Dim sheetNameArray As Variant
Dim sheetNames(1) As String</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = Application.SldWorks
    fileName = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2018\samples\tutorial\advdrawings\foodprocessor.slddrw&quot;
    Set swModel = swApp.<b>OpenDoc6</b>(fileName, swDocumentTypes_e.swDocDRAWING, swOpenDocOptions_e.swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)
    Set swModelDocExt = swModel.<b>Extension</b>
    Set swDrawing = swModel    </pre>
<pre>    sheetNames(0) = &quot;Sheet2&quot;
    sheetNames(1) = &quot;Sheet3&quot;
    sheetNameArray = sheetNames
    swDrawing.<b>SetSheetsSelected</b> (sheetNameArray)
    status = swDrawing.<b>SetupSheet6</b>(&quot;Sheet3&quot;, swDwgPaperSizes_e.swDwgPapersUserDefined, swDwgTemplates_e.swDwgTemplateCustom, 1, 1, True, &quot;C:\ProgramData\SOLIDWORKS\SOLIDWORKS 2017\lang\english\sheetformat\a4 - portrait.slddrt&quot;, 0.2794, 0.2159, &quot;Default&quot;, True, 0, 0, 0, 0, 0, 0)

    swModel.<b>ForceRebuild3</b> True
    swModel.<b>ViewZoomtofit2</b>    </pre>
<pre>End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
