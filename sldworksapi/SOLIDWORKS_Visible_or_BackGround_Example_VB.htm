<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>SOLIDWORKS Visible or BackGround Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=date content="10 25, 2002 4:05:30 PM">
<meta name=MS-HAID content=SOLIDWORKS_Visible_or_BackGround_Example>
<meta name=MS-HAID content=EXVisibleOrBackground>
<meta name=MS-HKWD content="SOLIDWORKS session,background">
<meta name=MS-HKWD content="SOLIDWORKS session,visible">
<meta name=MS-HKWD content="VBA examples,SOLIDWORKS session">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1953>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>SOLIDWORKS Visible or Background Example (VBA)</h1>

<p class=apiDescriptionText>These examples shows several situations for 
 running or attaching to SOLIDWORKS session through the API.</p>

<h2>SOLIDWORKS not running: Launch invisibly and end SOLIDWORKS session</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro1()</font></p>

<p class=apiCode
	style="font-family: 'Courier New';"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode
	style="font-family: 'Courier New';"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode
	style="font-family: 'Courier New'"><span>&nbsp;&nbsp;&nbsp;&nbsp; ' Close 
 the SOLIDWORKS application. If you do not perform this step, SOLIDWORKS<br>
&nbsp;&nbsp;&nbsp;&nbsp;
' continues to run. If SOLIDWORKS is running in the background, the user 
 is<br>
&nbsp;&nbsp;&nbsp;&nbsp;
' unaware that SOLIDWORKS is running and consuming their system resources.</span></p>

<p class=apiCode
	style="font-family: 'Courier New'">&nbsp;&nbsp;&nbsp;&nbsp; swApp.ExitApp<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p class=apiCode
	style="font-family: 'Courier New'">&nbsp;</p>
<p class=apiCode
	style="font-family: 'Courier New';"><!--kadov_tag{{</spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp; Set 
 swApp = Nothing</p>

<p class=apiCode>
<font style="font-family: 'Courier New';"
						face="Courier New">End Sub</font></p>

<p class=apiCode>&nbsp;</p>

<h2>SOLIDWORKS running: Attach to existing SOLIDWORKS session and end SOLIDWORKS 
 session</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro2()</font></p>

<p class=apiCode
	style="font-family: 'Courier New';"><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode
	style="font-family: 'Courier New';"><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}--><!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode
	style="font-family: 'Courier New'">&nbsp;&nbsp;&nbsp;&nbsp; swApp.ExitApp</p>

<p class=apiCode
	style="font-family: 'Courier New';"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 swApp = Nothing</p>

<p class=apiCode>
<font style="font-family: 'Courier New';"
						face="Courier New">End Sub</font></p>

<p class=apiCode>&nbsp;</p>

<h2>SOLIDWORKS not running: Launch invisibly, become visible, and end SOLIDWORKS 
 session</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro3()</font></p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 Part As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">Visible</span> = True</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.ExitApp</p>
<p class=apiCode>&nbsp;&nbsp;&nbsp;&nbsp; Set 
 swApp = Nothing</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">End Sub</font></p>

<p class=apiCode>&nbsp;</p>

<h2>SOLIDWORKS not running: Launch invisibly, become visible, and leave 
 SOLIDWORKS running</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro4()</font></p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}--><!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">Visible</span> = True</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">UserControl</span> = True</p>

<p class=apiCode><span style="font-family: 'Courier New';"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->' 
 Give control to the user, which leaves SOLIDWORKS running</p>

<p class=apiCode>End Sub</p>

<p class=apiCode>&nbsp;</p>

<h2>SOLIDWORKS not running: Launch invisibly, create part invisibly, close 
 part, and end SOLIDWORKS session</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro5()</font></p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 Part As Object</p>

<p class=apiCode><span style="font-family: 'Courier New';"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->' 
 This must be explicitly defined for ISldWorks::ActivateDoc2</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 errors As Long&nbsp;</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 Part = swApp.<span style="font-weight: bold;">NewPart</span></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 Part = swApp.<span style="font-weight: bold;">ActivateDoc2</span>(&quot;Part1&quot;,True,errors)</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Set 
 Part = Nothing</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">CloseDoc</span> &quot;Part1&quot;</p>
<p class=apiCode>&nbsp;&nbsp;&nbsp;&nbsp; swApp.ExitApp</p>
<p class=apiCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 swApp = Nothing</p>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">End Sub</font></p>

<p class=apiCode>&nbsp;</p>

<h2>SOLIDWORKS not running: Launch invisibly, create part invisibly, make 
 the part and SOLIDWORKS visible, and leave SOLIDWORKS running</h2>

<p class=apiCode><font style="font-family: 'Courier New';"
						face="Courier New">Sub Macro6()</font></p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 swApp As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Dim 
 Part As Object</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Set 
 swApp = CreateObject(&quot;SldWorks.Application&quot;)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 Part = swApp.<span style="font-weight: bold;">NewPart</span></p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Set 
 Part = swApp.<span style="font-weight: bold;">ActivateDoc</span>(&quot;Part1&quot;)</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Part.<span 
 style="font-weight: bold;">Visible</span> = True&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p class=apiCode><span style="font-family: 'Courier New';"><font style="font-family: 'Courier New';"
	face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;</font>&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->' 
 Make the part and SOLIDWORKS visible</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">UserControl</span> = True&nbsp;&nbsp;&nbsp;</p>

<p class=apiCode><span style="font-family: 'Courier New';"><font style="font-family: 'Courier New';"
	face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;</font>&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->' 
 Give control to the user, which leaves SOLIDWORKS running</p>

<p class=apiCode><span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><!--kadov_tag{{</spaces>}}-->Set 
 Part = Nothing</p>

<p class=apiCode><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">CloseDoc</span> &quot;Part1&quot;</p>

<p class=apiCode>End Sub</p>

<p class=apiCode>&nbsp;</p>

<p style="font-family: 'Courier New';">&nbsp;</p>

</body>

</html>
