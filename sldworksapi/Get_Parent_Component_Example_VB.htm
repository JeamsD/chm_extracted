<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Get Parent Component Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples,components">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=988>
<meta name=layout-width content=750>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Get Parent Component Example (VBA)</h1>

<p>This example shows how to get the parent component of the selected assembly 
or subassembly component.</p>
<pre>'--------------------------------------------------------
' Preconditions:
' 1. Open an assembly document.
' 2. Select an assembly or subassembly component.
' 3. Open the Immediate window.
'
' Postconditions:
' 1. Gets the parent component of the selected assembly
'    or subassembly component.
' 2. Examine the Immediate window.
'-------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swConfigMgr As SldWorks.ConfigurationManager
    Dim swConf As SldWorks.Configuration
    Dim swComp As SldWorks.Component2
    Dim swParentComp As SldWorks.Component2
    Dim bRet As Boolean</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swComp = swSelMgr.<b>GetSelectedObjectsComponent4</b>(1, -1)</pre>
<pre>    ' Returns Nothing if selected component is a top-level assembly component
    Set swParentComp = swComp.<b>GetParent</b>
    If Nothing Is swParentComp Then
        Set swConfigMgr = swModel.<b>ConfigurationManager</b><b>
</b>        Set swConf = swConfigMgr.<b>ActiveConfiguration</b>
        Set swParentComp = swConf.<b>GetRootComponent3</b>(True)
    End If</pre>
<pre>    Debug.Assert Not swParentComp Is Nothing</pre>
<pre>    Debug.Print &quot;File = &quot; &amp; swModel.<b>GetPathName</b>
    Debug.Print &quot;  Component = &quot; &amp; swComp.<b>Name2</b> &amp; &quot; [&quot; &amp; swComp.<b>GetPathName</b> &amp; &quot;]&quot;
    Debug.Print &quot;    Parent component = &quot; &amp; swParentComp.<b>Name2</b> &amp; &quot; [&quot; &amp; swParentComp.<b>GetPathName</b> &amp; &quot;]&quot;</pre>
<pre>End Sub
</pre>

</body>

</html>
