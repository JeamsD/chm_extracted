<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Close Document Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=date content="10 11, 2002 4:08:49 PM">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1435>
<meta name=layout-width content=723>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">

 <META NAME="MS-HKWD" CONTENT="VBA examples,documents">

</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Close Document Example (VBA)</h1>

<p class=apiDescriptionText>This example shows how to create new parts 
 and close the parts by name.</p>

<pre>'---------------------------------------------
' Preconditions: Open the Immediate window.
'
' Postconditions:
' 1. Opens a new part document titled Part1 and gets its title.
' 2. Opens another new part document titled Part2 and gets
'    its title.
' 3. Release the pointer to Part2 and closes Part2.
' 4. Activates Part1.
'---------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim Part1 As SldWorks.PartDoc
Dim Part2 As SldWorks.PartDoc
Dim partTitle1 As String
Dim partTitle2 As String
Dim errors As Long</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = CreateObject(&quot;SldWorks.Application&quot;)    </pre>
<pre>    ' Open a new part
    Set Part1 = swApp.<b>NewPart</b></pre>
<pre>    ' Get the part's title
    partTitle1 = Part1.<b>GetTitle</b>
    Debug.Print &quot;Part1's title: &quot; &amp; partTitle1</pre>
<pre>    ' Open another new part
    Set Part2 = swApp.<b>NewPart</b></pre>
<pre>    ' Get the part's title
    partTitle2 = Part2.<b>GetTitle</b>
    Debug.Print &quot;Part2's title: &quot; &amp; partTitle2</pre>
<pre>    ' Release the pointer to Part2
    Set Part2 = Nothing</pre>
<pre>    ' Close the Part2
    swApp.<b>CloseDoc</b> partTitle2</pre>
<pre>    ' Activate Part1
    Set Part1 = swApp.ActivateDoc2(partTitle1, True, errors)
    If ((errors &lt;&gt; 0) Or (Part1 Is Nothing)) Then
        swApp.<b>SendMsgToUser</b> &quot;Error activating Part1 document&quot;
    End If</pre>
<pre>End Sub</pre>

</body>

</html>
