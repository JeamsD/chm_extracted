<html>

<head>
<title>Fire Notification When Activating a Sheet Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,sheets">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1><a name="Top"></a>Fire Notification When Activating a Sheet Example (VBA)</h1>
<p>This example shows how to fire a notification when a sheet is activated in a 
drawing document.</p>

<p class="APICODE">
'---------------------------------------------------------------<br>
' Preconditions: <br>
' 1. Copy <a href="#Main">Main</a> into the macro.<br>
' 2. Click <b>Insert &gt; Class Module </b>and copy <a href="#Class">Class1</a> 
into that<br>
'&nbsp;&nbsp;&nbsp; module.<br>
' 3. Open a drawing with two or more sheets.<br>
' <br>
' Postconditions:<br>
' 1. Click an inactive sheet's tab to activate it.<br>
'&nbsp;2. Displays a message box informing you that a sheet is about <br>
'&nbsp;&nbsp;&nbsp; to be 
activated.<br>
'&nbsp;3. Click <b>OK</b> to close the message box.<br>
'&nbsp;4. Displays a message box informing you that a sheet was activated.<br>
'&nbsp;5. Click <b>OK</b> to close the message box.<br>
'---------------------------------------------------------------</p>
<p class="APICODE">
<a name=Main></a>'Main <br>
Option Explicit</p>
<p class="APICODE">Dim swApp As SldWorks.SldWorks<br>
Dim swModel As SldWorks.ModelDoc2<br>
Dim swDraw As SldWorks.DrawingDoc<br>
Dim swDrawEvents As Class1</p>
<p class="APICODE">Sub main()</p>
<blockquote>
	<p class="APICODE">Set swApp = Application.<b>SldWorks</b><br>
	Set swModel = swApp.<b>ActiveDoc</b></p>
	<p class="APICODE">'Set up events<br>
	Set swDraw = swModel<br>
	Set swDrawEvents = New Class1<br>
	Set swDrawEvents.<b>swDraw</b> = swApp.<b>ActiveDoc</b></p>
</blockquote>
<p class="APICODE">End Sub</p>

<p class=APICODE align="center"><a href="#Top">Back to top</a></p>

<h5><span style="font-weight: 400"><font face="Courier New" size="2"><a name=Class></a>
'Class1</font></span> </h5>

<p class="APICODE">Option Explicit</p>
<p class="APICODE">Public WithEvents swDraw As SldWorks.DrawingDoc</p>
<p class="APICODE">Private Function swDraw_<b>ActivateSheetPreNotify</b>(ByVal 
SheetName As String) As Long<br>
&nbsp;&nbsp;&nbsp;
MsgBox &quot;A sheet is about to be activated.&quot;<br>
End Function</p>
<p class="APICODE">Private Function swDraw_<b>ActivateSheetPostNotify</b>(ByVal 
SheetName As String) As Long<br>
&nbsp;&nbsp;&nbsp;
MsgBox &quot;A sheet was activated.&quot;<br>
End Function</p>

<p align="center"><font face="Courier New" size="2"><a href="#Top">Back to top</a></font></p>

</body>

</html>
