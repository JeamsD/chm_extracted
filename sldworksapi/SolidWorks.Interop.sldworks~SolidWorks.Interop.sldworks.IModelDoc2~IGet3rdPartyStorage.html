<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <title>IGet3rdPartyStorage Method (IModelDoc2)</title>
    <link href="stylesheets/dotnet2005.css" type="text/css" rel="stylesheet">
    <script src="script/dotnet2005.js" type="text/javascript">
</script><xml>
<MSHelp:Keyword Index="F" Term="SolidWorks.Interop.sldworks.IModelDoc2.IGet3rdPartyStorage" />
<MSHelp:Attr Name="DevLang" Value="CSharp" />
<MSHelp:Attr Name="DevLang" Value="VB" />
<MSHelp:Attr Name="DevLang" Value="JScript" />
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="LinkGroup" Value="Help"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
<MSHelp:Attr Name="HelpPriority" Value="1"/>
</xml>

    
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script>
</head>

<body id="dxBody" topmargin="0">
    <form>
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset"> <img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/collapse.gif"> <img id="expandImage"
        style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id="collapseAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
        src="dotnetimages/collapse.gif"> <img id="expandAllImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/expand.gif"> <img id=
        "dropDownImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown.gif"> <img id="dropDownHoverImage" style=
        "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/drpdown_orange.gif"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src=
        "dotnetimages/copycode.gif"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="dotnetimages/copycodeHighlight.gif"> 
        
    </form>

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">SOLIDWORKS API Help</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:apihelp.feedback@3ds.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2~IGet3rdPartyStorage.html">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">IGet3rdPartyStorage Method (IModelDoc2)</span></td>
                </tr>

                <tr id="pagetoptable1row3">
                    <td colspan="2"><a onclick="javascript:openSectionById('seeAlsoSectionHeader');" href="#seealsobookmark">
                    See Also</a>&nbsp; 
                    </td>
                </tr>
            </tbody>
        </table>

        <table id="pagetoptable2" cellspacing="0" cellpadding="0" width="100%">
            <tbody>
                <tr>
                    <td><span id="toggleExpandedAll"><img class="toggleAll" id="toggleExpandedAllImage" src="dotnetimages/collapse.gif"> <label id=
                    "collapseAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">Collapse All</label> <label id="expandAllLabel" style="DISPLAY: none" for="toggleExpandedAllImage">
                    Expand All</label></span> <span id="languageFilterToolTip"
                    onmouseover='document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' style="CURSOR: default"
                    onfocusout='document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;' onclick=
                    "showBox('dxlanguagemenu',event,document.getElementById('languageFilterImage'))" onfocusin=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownHoverImage").src;' onmouseout=
                    'document.getElementById("languageFilterImage").src=document.getElementById("dropDownImage").src;'><img id="languageFilterImage" src=
                    "dotnetimages/drpdown.gif"> <label id="showAllLabel" style="DISPLAY: none" for="languageFilterImage">
                    Language Filter: All</label> <label id="multipleLabel" style=
                    "DISPLAY: none" for="languageFilterImage">Language Filter: Multiple</label> 
                    
<label id="VBLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Declaration)</label>
<label id="VBUsageLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic (Usage)</label>
<label id="CSLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
<label id="CPP2005Label" for="languageFilterImage" style="display: none;">Language Filter: C++/CLI</label>
</span></td>
                </tr>
            </tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace.html">SolidWorks.Interop.sldworks Namespace</a>
 > <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2.html">IModelDoc2 Interface</a>
 : IGet3rdPartyStorage Method (IModelDoc2)</td></tr></table>

        <div class="dxpopupbubble" id="dxlanguagemenu">
            
<input id="VBCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBCheckbox">
Visual Basic (Declaration)
</label>
<br /><input id="VBUsageCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="VBUsageCheckbox">
Visual Basic (Usage)
</label>
<br /><input id="CSCheckbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CSCheckbox">
C#
</label>
<br /><input id="CPP2005Checkbox" type="checkbox" name="languageFilter" onClick="setLanguage(this)" />
<label class="languageFilter" for="CPP2005Checkbox">
C++/CLI
</label>

        </div>
<div id="StringIn_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>StringIn</I></DT>
<DD class="popupbubble"><P>Name&nbsp;of the&nbsp;stream; the name should be less than 30 characters and must be unique and qualified among all parties choosing to store within the current session</P></DD></DL>
</div>
<div id="IsStoring_box" class="dxpopupbubble">
<DL><DT class="popupbubble"><I>IsStoring</I></DT>
<DD class="popupbubble"><P>True if you are storing data, false if you are reading data</P></DD></DL>
</div>

    </div>

    <div id="pagebody" valign="bottom">
        <a name="topBookmark"></a>

        <div id="mainbody">
            <div class="saveHistory" id="allHistory" onsave="saveAll()" onload="loadAll()"></div>
             Gets&nbsp;the IStream interface to the specified third-party stream inside this SOLIDWORKS document. 
             
             
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>.NET Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection"><DIV class=LanguageSpecific id=Syntax_VB><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Declaration)</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>Function IGet3rdPartyStorage( _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="StringIn" href="#" onclick="javascript:showParamBox(event);">StringIn</a></i> As System.String, _
&nbsp;&nbsp;&nbsp;ByVal <i><a class="parameter" id="IsStoring" href="#" onclick="javascript:showParamBox(event);">IsStoring</a></i> As System.Boolean _
) As System.Object</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_VBUsage><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>Visual Basic (Usage)</th><th><span class="copyCode" onclick="copyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="dotnetimages/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Dim instance As <a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2.html">IModelDoc2</a>
Dim StringIn As System.String
Dim IsStoring As System.Boolean
Dim value As System.Object
&nbsp;
value = instance.IGet3rdPartyStorage(StringIn, IsStoring)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CS><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C#</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.object IGet3rdPartyStorage( 
&nbsp;&nbsp;&nbsp;System.string <i><a class="parameter" id="StringIn" href="#" onclick="javascript:showParamBox(event);">StringIn</a></i>,
&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="IsStoring" href="#" onclick="javascript:showParamBox(event);">IsStoring</a></i>
)</pre></tr></table></div>
<DIV class=LanguageSpecific id=Syntax_CPP2005><table class="syntaxtable" width="100%" cellpadding="0" cellspacing="0"><tr><th>C++/CLI</th><th>&nbsp;</th></tr><tr><td colspan="2"><pre>System.Object^ IGet3rdPartyStorage( 
&&nbsp;&nbsp;&nbsp;System.String^ <i><a class="parameter" id="StringIn" href="#" onclick="javascript:showParamBox(event);">StringIn</a></i>,
&&nbsp;&nbsp;&nbsp;System.bool <i><a class="parameter" id="IsStoring" href="#" onclick="javascript:showParamBox(event);">IsStoring</a></i>
) </pre></tr></table></div>
 
            <b><font color=RED>NOTE:</font></b> See <a href=DifferencesBetweenUnManagedAndCPPCLI.htm>Differences Between Unmanaged C++ and C++/CLI Code</a>.<h4 class=dxh4>Parameters</h4><DL><DT><I>StringIn</I></DT>
<DD><P>Name&nbsp;of the&nbsp;stream; the name should be less than 30 characters and must be unique and qualified among all parties choosing to store within the current session</P></DD><DT><I>IsStoring</I></DT>
<DD><P>True if you are storing data, false if you are reading data</P></DD></DL> 
             
            <h4 class=dxh4>Return Value</h4><P>IUnknown (see <STRONG>Remarks</STRONG>)</P></div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="visualbasic6syntaxToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Visual Basic for Applications (VBA) Syntax</span></h1><div id="visualbasic6syntaxSection" class="section" name="collapseableSection">See <A href="ms-its:sldworksapivb6.chm::/sldworks~ModelDoc2~IGet3rdPartyStorage.html">ModelDoc2::IGet3rdPartyStorage</A>.</div> 
             
             <a name="exampleBookmark"></a>
             
             
            
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection"><P>Call this interface when a SaveToStorageNotify or LoadFromStorageNotify notification is received. Do not call this method to save or load from storage in reaction to the FileSaveNotify or FileOpenNotify2 events.</P>
<P>During a file-open operation, your application receives a <SPAN class=popuplk>LoadFromStorageNotify</SPAN> event if you have registered for document notifications. When you receive this event, it is safe to open your Stream for reading using IModelDoc2::<FONT style="BACKGROUND-COLOR: #316ac5" color=white>IGet3rdPartyStorage</FONT>. When a file is fully loaded, you can call this method for reading your data at any time. This provides you with access to read your storage node whenever needed. However, it is not a good idea to attempt this while in the middle of a FileSaveNotify or FileOpenNotify2 as unforeseen conflicts can occur.</P>
<P>If your application is loaded in the middle of a SOLIDWORKS session, then you can traverse all open documents using <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.ISldWorks~EnumDocuments2.html">ISldworks::EnumDocuments2</A>, <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.ISldWorks~IGetFirstDocument2.html">ISldWorks::IGetFirstDocument2</A>, or <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IModelDoc2~IGetNext.html">IModelDoc2::IGetNext</A> and read the storage from all existing open documents. From that point on, your application can use the LoadFromStorageNotify event to recognize when new documents have been opened and need reading.</P>
<P>For storage writing, IModelDoc2::<FONT style="BACKGROUND-COLOR: #316ac5" color=white>IGet3rdPartyStorage</FONT> interface is locked unless the <SPAN class=popuplk>SaveToStorageNotify</SPAN> event has been sent. Therefore, you can only write to your storage when the file is actually being saved and your application has received the <SPAN class=popuplk>SaveToStorageNotify</SPAN> event.</P>
<P>Your call to IModelDoc2::<FONT style="BACKGROUND-COLOR: #316ac5" color=white>IGet3rdPartyStorage</FONT> must be followed by a call to <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IModelDoc2~IRelease3rdPartyStorage.html">IModelDoc2::IRelease3rdPartyStorage</A>. This must be done even when you fail to obtain a Stream and the return value from IModelDoc2::<FONT style="BACKGROUND-COLOR: #316ac5" color=white>IGet3rdPartyStorage</FONT> is NULL. If you fail to call IModelDoc2::IRelease3rdPartyStorage, the third-party node may remain locked and prevent future access. You are not required to call IModelDoc2::IRelease3rdPartyStorage, under any circumstance, if you called IModelDoc2::<FONT style="BACKGROUND-COLOR: #316ac5" color=white>IGet3rdPartyStorage</FONT> in reaction to one of the <SPAN class=popuplk>SaveToStorageNotify</SPAN> or <SPAN class=popuplk>LoadFromStorageNotify</SPAN> events. However, calling IModelDoc2::IRelease3rdPartyStorage excessively does not cause problems.</P>
<P>As work progresses during an active session and you have information that needs to be stored, you may want to flag the document as dirty using <A href="SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IModelDoc2~SetSaveFlag.html">IModelDoc2::SetSaveFlag</A>. This causes a <SPAN style="FONT-WEIGHT: bold">Save Changes?</SPAN> prompt to display if the user tries to close the file without saving. If the user clicks <SPAN style="FONT-WEIGHT: bold">Yes</SPAN> to this prompt, then your application receives the <SPAN class=popuplk>SaveToStorageNotify</SPAN> event.</P>
<P><SPAN style="FONT-WEIGHT: bold">NOTE:</SPAN> The name given to the storage stream should be registered so that no conflicts occur. Once registered, the stream name is reserved exclusively for your application.</P>
<P>Passing the unique ID string and a flag to determine if data is being stored or loaded returns an IUnknown pointer. You must then use QueryInterface() to get the <STRONG>IStream</STRONG> interface. The stream is used for serialization and then released in the third-party code.</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">SwRootStorage --|&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|-- ThirdPty --|&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|-- &lt;SW Assigned IStream name 1&gt;&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|-- &lt;SW Assigned IStream name 2&gt;&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|-- &lt;SW Assigned IStream name 3&gt;&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">: : :&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">|-- &lt;SW Assigned IStream name n&gt;&nbsp;</P>
<P style="MARGIN-BOTTOM: 0px; MARGIN-TOP: 0px">&nbsp;</P>
<P>The IStream object used by the third party is written to IStream objects under an IStorage object called ThirdPty in the SOLIDWORKS compound document. Each third party writes to a single IStream object whose name is assigned by SOLIDWORKS.</P>
<P><SPAN style="FONT-WEIGHT: bold">NOTE:</SPAN> If you are using serialization, then be careful with the standard MFC macros; <!--kadov_tag{{</spaces>}}-->otherwise, you may get messages like <SPAN style="FONT-WEIGHT: bold">Unexpected File Format</SPAN> after your application is unloaded. One way of using IMPLEMENT_SERIAL is:</P>
<P style="MARGIN-LEFT: 8px">IMPLEMENT_SERIAL( CCustomAttr, CObject, VERSIONABLE_SCHEMA|0 )</P></div>&nbsp;
            <a name="seealsobookmark"></a>
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><h4 class="dxh4"></h4><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2.html">IModelDoc2 Interface</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html">IModelDoc2 Members</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DAssemblyDocEvents_LoadFromStorageNotifyEventHandler.html">DAssemblyDocEvents LoadFromStorageNotify Delegate</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DAssemblyDocEvents_SaveToStorageNotifyEventHandler.html">DAssemblyDocEvents SaveToStorageNotifyEventHandler Delegate</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DDrawingDocEvents_LoadFromStorageNotifyEventHandler.html">DDrawingDocEvents_LoadFromStorageNotifyEventHandler Delegate</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DDrawingDocEvents_SaveToStorageNotifyEventHandler.html">DDrawingDocEvents_SaveToStorageNotifyEventHandler Delegate</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DPartDocEvents_SaveToStorageNotifyEventHandler.html">DPartDocEvents_SaveToStorageNotifyEventHandler Delegate</a>
<br/><a href="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.DPartDocEvents_LoadFromStorageNotifyEventHandler.html">DPartDocEvents_LoadFromStorageNotifyEventHandler Delegate</a>
</p>
</div> 
            <h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="availabilityToggle" class="toggle" name="toggleSwitch" src="dotnetimages/collapse.gif"></img>Availability</span></h1><div id="availabilitySection" class="section" name="collapseableSection">SOLIDWORKS 2001Plus FCS, Revision Number 10.0</div>
        </div>

        <div id="pagefooter"></div>
    </div>
</body>
</html>