<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Load and Unload Add-in Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples,add-ins">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1026>
<meta name=layout-width content=750>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Load and Unload Add-in Example (VBA)</h1>

<p>This example shows how to prompt the user to load or unload an add-in.</p>

<pre>'---------------------------------------------
' Preconditions: 
' 1. Create a VB.NET add-in in Microsoft Visual Studio
'    2010, or later, in <b>C:\test,</b> following the instructions in 
'    <a href="Add_Shortcut_Menus_to_Add-ins_VBNET.htm">Add Shortcut Menu to Add-ins Example (VB.NET)</a>.
' 2. Open the Immediate window.
'
' Postconditions: 
' 1. Click <b>Yes</b> to load <b>SwVBAddin1</b> or click <b>No</b> to unload <b>
</b>'    <b>swVBAddin1</b>.
' 2. Examine the Immediate window.
'----------------------------------------------</pre>
<pre>Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    'Path to add-in
    Const sAddinName As String = &quot;C:\test\SwVBAddin1\SwVBAddin1\bin\SwVBAddin1.dll&quot;</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim response As Long
    Dim status As Long
    </pre>
<pre>    Set swApp = CreateObject(&quot;SldWorks.Application&quot;)</pre>
<pre>    response = MsgBox(&quot;Load add-in?&quot;, vbYesNo)</pre>
<pre>    If response = vbYes Then
        Debug.Print &quot;Loading: &quot; + sAddinName
        status = swApp.<b>LoadAddIn</b>(sAddinName)
    Else
        Debug.Print &quot;Unloading: &quot; + sAddinName
        status = swApp.<b>UnloadAddIn</b>(sAddinName)
    End If</pre>
<pre>    Debug.Print &quot;  Status = &quot; &amp; status</pre>
<pre>End Sub</pre>

</body>

</html>
