<html>

<head>
<title>Insert Cavity Example (VB.NET)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VB.NET examples,cavity">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Insert Cavity Example (VB.NET)</h1>
<p>This example shows how to insert a cavity in a mold base.</p>
<pre style="font-family: Courier New; font-size: 13; color: black; background: white"><font color="#008000">'------------------------------------------------------------------------------------</font>
<span style="color:green;">'&nbsp;Preconditions:</span>
<span style="color:green;">'&nbsp;1.&nbsp;Create&nbsp;a&nbsp;new&nbsp;folder&nbsp;and&nbsp;copy&nbsp;<i>public_documents</i><b>\samples\tutorial\molds\telephone.sldprt</b>&nbsp;</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;that&nbsp;folder.</span>
<span style="color:green;">'&nbsp;2.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;New&nbsp;&gt;&nbsp;Part&nbsp;&gt;&nbsp;OK&nbsp;</b>to&nbsp;create&nbsp;a&nbsp;new&nbsp;part&nbsp;document.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Insert&nbsp;a&nbsp;sketch&nbsp;of&nbsp;a&nbsp;rectangle&nbsp;with&nbsp;a&nbsp;length&nbsp;of&nbsp;240&nbsp;mm&nbsp;and&nbsp;width&nbsp;of&nbsp;350&nbsp;mm.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Using&nbsp;the&nbsp;sketch,&nbsp;create&nbsp;a&nbsp;boss&nbsp;extrude&nbsp;feature&nbsp;with&nbsp;a&nbsp;depth&nbsp;of&nbsp;160&nbsp;mm.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;part&nbsp;as&nbsp;<b>telephoneMoldBase.sldprt</b>&nbsp;in&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1.</span>
<span style="color:green;">'&nbsp;3.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;New&nbsp;&gt;&nbsp;Assembly&nbsp;&gt;&nbsp;OK&nbsp;</b>to&nbsp;create&nbsp;a&nbsp;new&nbsp;assembly&nbsp;document.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Click&nbsp;<b>telephoneMoldBase</b>&nbsp;in&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>&nbsp;in&nbsp;the&nbsp;PropertyManager&nbsp;page.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Click&nbsp;<b>OK</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Click&nbsp;<b>Insert&nbsp;Components</b>&nbsp;on&nbsp;the&nbsp;Assembly&nbsp;toolbar,&nbsp;click&nbsp;<b>Browse</b>&nbsp;in</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>,&nbsp;click&nbsp;<b>telephone.sldprt</b>&nbsp;located&nbsp;in&nbsp;the&nbsp;folder&nbsp;</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;created&nbsp;in&nbsp;step&nbsp;1,&nbsp;and&nbsp;click&nbsp;<b>Open</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Drop&nbsp;<b>telephone.sldprt</b>&nbsp;in&nbsp;the&nbsp;graphics&nbsp;area.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Click&nbsp;<b>View&nbsp;&gt;&nbsp;Display&nbsp;&gt;&nbsp;Hidden&nbsp;Lines&nbsp;Visible</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;In&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree,&nbsp;click&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>Move&nbsp;Component</b></span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;Assembly&nbsp;toolbar.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Move&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;into&nbsp;the&nbsp;center&nbsp;of&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>OK</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIP:&nbsp;Change&nbsp;the&nbsp;view&nbsp;orientation&nbsp;to&nbsp;<b>Top</b>&nbsp;and&nbsp;<b>Front</b>&nbsp;to&nbsp;help&nbsp;center&nbsp;<b>telephone&lt;1&gt;</b>.</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;h.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;Save&nbsp;All&nbsp;&gt;&nbsp;Rebuild&nbsp;and&nbsp;save&nbsp;the&nbsp;document&nbsp;(recommended)</b>,&nbsp;</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;navigate&nbsp;to&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1,&nbsp;type&nbsp;<b>AssemInterim.sldasm</b>&nbsp;in&nbsp;</span>
<span style="color:green;">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>File&nbsp;name</b>,&nbsp;and&nbsp;click&nbsp;<b>Save</b>.</span>
<span style="color:green;">'&nbsp;4.&nbsp;Click&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree.</span>
<span style="color:green;">'&nbsp;5.&nbsp;Ctrl+click&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree.</span>
<span style="color:green;">'</span>
<span style="color:green;">'&nbsp;Postconditions:</span>
<span style="color:green;">'&nbsp;1.&nbsp;Creates&nbsp;<b>Cavity1</b>&nbsp;in&nbsp;<b>telphoneMoldBase&lt;1</b>&gt;.</span>
<span style="color:green;">'&nbsp;2.&nbsp;Expand&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;to&nbsp;verify&nbsp;step&nbsp;1.</span>
<span style="color:green;">'-----------------------------------------------------------------------------------</span>
<span style="color:blue;">Imports</span>&nbsp;SolidWorks.Interop.sldworks
<span style="color:blue;">Imports</span>&nbsp;SolidWorks.Interop.swconst
<span style="color:blue;">Imports</span>&nbsp;System.Runtime.InteropServices
<span style="color:blue;">Imports</span>&nbsp;System
 
<span style="color:blue;">Partial</span>&nbsp;<span style="color:blue;">Class</span>&nbsp;<span style="color:#2b91af;">SolidWorksMacro</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Sub</span>&nbsp;main()
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swModel&nbsp;<span style="color:blue;">As</span>&nbsp;ModelDoc2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swSelMgr&nbsp;<span style="color:blue;">As</span>&nbsp;SelectionMgr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swAssy&nbsp;<span style="color:blue;">As</span>&nbsp;AssemblyDoc
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swMoldBaseComp&nbsp;<span style="color:blue;">As</span>&nbsp;Component2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;swCoreComp1&nbsp;<span style="color:blue;">As</span>&nbsp;Component2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;nRetval&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color: #0000FF">Integer</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;nInfo&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color: #0000FF">Integer</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;bRet&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:blue;">Boolean</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModel&nbsp;=&nbsp;swApp.<b>ActiveDoc</b>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy&nbsp;=&nbsp;swModel
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swSelMgr&nbsp;=&nbsp;swModel.<b>SelectionManager</b>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swMoldBaseComp&nbsp;=&nbsp;swSelMgr.<b>GetSelectedObjectsComponent2</b>(1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCoreComp1&nbsp;=&nbsp;swSelMgr.<b>GetSelectedObjectsComponent2</b>(2)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModel.<b>ClearSelection2</b>(<span style="color:blue;">True</span>)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRet&nbsp;=&nbsp;swMoldBaseComp.<b>Select2</b>(<span style="color:blue;">False</span>,&nbsp;0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nRetval&nbsp;=&nbsp;swAssy.<b>EditPart2</b>(<span style="color:blue;">True</span>,&nbsp;<span style="color:blue;">True</span>,&nbsp;nInfo)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRet&nbsp;=&nbsp;swCoreComp1.<b>Select2</b>(<span style="color:blue;">True</span>,&nbsp;0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy.<b>InsertCavity4</b>(0.0#,&nbsp;0,&nbsp;0.0#,&nbsp;<span style="color:blue;">True</span>,&nbsp;swCavityScaleType_e.swAboutCentroid,&nbsp;0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy.<b>EditAssembly</b>()
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Sub</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;</span><span style="color:gray;">&lt;summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;The&nbsp;SldWorks&nbsp;swApp&nbsp;variable&nbsp;is&nbsp;pre-assigned&nbsp;for&nbsp;you.</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">'''&nbsp;</span><span style="color:gray;">&lt;/summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;swApp&nbsp;<span style="color:blue;">As</span>&nbsp;SldWorks
 
 
<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Class</span></pre>

<p>&nbsp;</p>

</body>

</html>
