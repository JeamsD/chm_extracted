<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Change Text Format Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1612>
<meta name=layout-width content=723>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">

 <META NAME="MS-HKWD" CONTENT="VBA examples,text">
 <META NAME="MS-HKWD" CONTENT="VBA examples,annotations">
</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Change Text Format Example (VBA)</h1>

<p>This example shows how to change the text format of an annotation.</p>

<pre>'---------------------------------------------------
' Preconditions:
' 1. Open a part, assembly, or drawing that has at least
'    one annotation containing text.
' 2. Select that annotation.
' 3. Open the Immediate window.
'
' Postconditions:
' 1. Changes the text format of the selected annotation.
' 2. Examine the annotation in the graphics area and
'    the Immediate window.
'----------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp                       As SldWorks.SldWorks
    Dim swModel                     As SldWorks.ModelDoc2
    Dim swSelMgr                    As SldWorks.SelectionMgr
    Dim swAnnObj                    As Object
    Dim swAnn                       As SldWorks.Annotation
    Dim swTextFormat                As SldWorks.TextFormat
    Dim i                           As Long
    Dim bRet                        As Boolean</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swAnnObj = swSelMgr.<b>GetSelectedObject6</b>(1, -1)
    Set swAnn = swAnnObj.<b>GetAnnotation</b></pre>
<pre>    'Get text format information
    Debug.Print &quot;File = &quot; &amp; swModel.<b>GetPathName</b>
    Debug.Print &quot;  &quot; &amp; swAnn.<b>GetName</b> &amp; &quot; &lt;&quot; &amp; swAnn.<b>GetType</b> &amp; &quot;&gt;&quot;</pre>
<pre>    For i = 0 To swAnn.<b>GetTextFormatCount</b> - 1
        Set swTextFormat = swAnn.<b>GetTextFormat</b>(i)</pre>
<pre>        'Change text to be 10mm, bold, italic, and Comic Sans MS font
        swTextFormat.<b>CharHeight</b> = 0.01
        swTextFormat.<b>Bold</b> = True
        swTextFormat.<b>Italic</b> = True
        swTextFormat.<b>TypeFaceName</b> = &quot;Comic Sans MS&quot;
        bRet = swAnn.<b>SetTextFormat</b>(i, False, swTextFormat)
    Next</pre>
<pre>End Sub</pre>

</body>

</html>
