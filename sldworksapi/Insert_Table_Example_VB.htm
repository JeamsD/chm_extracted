<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Insert Table Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="Table,insert">
<meta name=MS-HKWD content="Annotation (see also IAnnotation Interface),table">
<meta name=MS-HKWD content="VBA examples,tables">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1310>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Insert Table Example (VBA)</h1>

<p>This example shows how to insert a table into a drawing.</p>
<pre>'-------------------------------------------
' Preconditions:
' 1. Open a drawing.
' 2. Select a drawing view.
'
' Postconditions: Inserts the table.
'-------------------------------------------</pre>
<pre>Option Explicit</pre>
<pre>Public Enum swBOMConfigurationAnchorType_e
    swBOMConfigurationAnchor_TopLeft = 1
    swBOMConfigurationAnchor_TopRight = 2
    swBOMConfigurationAnchor_BottomLeft = 3
    swBOMConfigurationAnchor_BottomRight = 4
End Enum</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swDraw As SldWorks.DrawingDoc
    Dim swTable As SldWorks.TableAnnotation
    Dim vPickPt As Variant
    Dim nNumCol As Long
    Dim nNumRow As Long
    Dim sRowStr As String
    Dim i As Long
    Dim j As Long
    Dim bRet As Boolean</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swDraw = swModel
    Set swSelMgr = swModel.<b>SelectionManager</b>
    vPickPt = swSelMgr.<b>GetSelectionPoint</b>(1)
    Set swTable = swDraw.<b>InsertTableAnnotation</b>(vPickPt(0), vPickPt(1), swBOMConfigurationAnchor_TopLeft, 6, 5)
    nNumCol = swTable.<b>ColumnCount</b>
    nNumRow = swTable.<b>RowCount</b>
    For i = 0 To nNumRow
        For j = 0 To nNumCol
            swTable.<b>Text</b>(i, j) = &quot;[&quot; &amp; i &amp; &quot;, &quot; &amp; j &amp; &quot;]&quot;
        Next j
    Next i</pre>
<pre>End Sub</pre>

</body>

</html>
