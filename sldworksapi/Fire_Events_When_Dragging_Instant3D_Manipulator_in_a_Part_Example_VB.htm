<html>

<head>
<title>Fire Events When Dragging Instant3D Manipulator in a Part Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<META NAME="MS-HKWD" CONTENT="VBA examples, Instant3D manipulators">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Fire Events When Dragging Instant3D Manipulator in a Part Example (VBA)</h1>
<p>This example shows how to fire events when dragging an Instant3D manipulator 
in a part document.</p>
<p class="APICODE">'------------------------------------<br>
' Preconditions:<br>
' 1. Open a part document.<br>
' 2. Copy and paste <a href="#Main">Main</a> into the main module.<br>
' 3. Click <b>Insert &gt; Class</b> module and copy and paste<br>
'&nbsp;&nbsp;&nbsp; <a href="#Class">Class</a> into the class module.<br>
' 4. Open the Immediate window.<br>
'<br>
' NOTE: Instant3D is enabled by the macro.<br>
'<br>
' Postconditions:<br>
' 1. Select an Instant3D manipulator in the<br>
'&nbsp;&nbsp;&nbsp; open part. For example,<br>
'&nbsp;&nbsp;&nbsp; double-click an extrude feature in a part,<br>
'&nbsp;&nbsp;&nbsp; then select one of the Instant3D manipulators<br>
'&nbsp;&nbsp;&nbsp; and drag it.<br>
' 2. Writes a debug statement to the Immediate window<br>
'&nbsp;&nbsp;&nbsp; informing you that dragging of an Instant3D<br>
'&nbsp;&nbsp;&nbsp; manipulator has started.<br>
' 3. Stop dragging the manipulator.<br>
' 4. Writes a debug statement to the Immediate<br>
'&nbsp;&nbsp;&nbsp; window informing you that dragging of<br>
'&nbsp;&nbsp;&nbsp; an Instant3D manipulator has stopped.<br>
' 5. Examine the Immediate window.<br>
'----------------------------------------<br>
<a name="Main"></a>' Main<br>
<br>
Option Explicit<br>
<br>
Dim swApp As SldWorks.SldWorks<br>
Dim swModel As SldWorks.ModelDoc2<br>
Dim swFeatMgr As SldWorks.FeatureManager<br>
Dim partDoc As New Class1<br>
<br>
<br>
Sub main()<br>
<br>
Set swApp = Application.SldWorks<br>
Set swModel = swApp.<b>ActiveDoc</b><br>
<br>
' Enable Instant3D<br>
Set swFeatMgr = swModel.<b>FeatureManager</b><br>
swFeatMgr.<b>MoveSizeFeatures</b> = True<br>
<br>
' Execute its class module<br>
partDoc.init swModel<br>
<br>
End Sub</p>
<p class="APICODE" align="center"><a href="#Top">Back to top</a></p>
<p><font face="Courier New" size="2"><b><a name="Class"></a>' </b>Class</font></p>
<p class="APICODE">Public WithEvents doc As partDoc<br><br>Public Function init(ByRef docIn As Object)<br>Set doc = docIn<br>End Function<br>
<br>Private Function <b>doc_DragStateChangeNotify</b>(ByVal State As Boolean) As 
Long<br>' Write debug statement when dragging of manipulator started and stopped<br>If State = True Then<br>&nbsp;&nbsp;&nbsp; Debug.Print &quot;Dragging of manipulator started.&quot;<br>Else<br>&nbsp;&nbsp;&nbsp; Debug.Print &quot;Dragging of manipulator stopped.&quot;<br>End If<br>End Function</p>

<p class="APICODE" align="center"><a href="#Top">Back to top</a></p>

</body>

</html>
