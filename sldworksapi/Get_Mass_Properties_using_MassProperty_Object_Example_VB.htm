<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Get and Override Mass Properties Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta NAME=MS-HAID CONTENT=MassProperty_Example>
<meta name=MS-HKWD content="Document,mass properties">
<meta name=MS-HKWD content="VBA examples,mass properties">
<meta name=MS-HKWD content="VBA examples,assemblies">
<meta name=MS-HKWD content="VBA examples,components">
<meta name=MS-HKWD content="Mass properties. See IMassProperty2 Interface">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1068>
<meta name=layout-width content=628>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Get and Override Mass Properties Example (VBA)</h1>

<p>This example shows how 
to<font color="Black"> </font>get<font color="Black"> 
and override some mass properties </font>of<font color="Black"> a part.</font></p>

<p class="apicode">
'-----------------------------------------------------------------------<o:p></o:p></p>
<p class="apicode">' Preconditions:<o:p></o:p></p>
<p class="apicode">' 1. Ensure the specified document exists.<o:p></o:p></p>
<p class="apicode">' 2. Open the Immediate window.<o:p></o:p></p>
<p class="apicode">'<o:p></o:p></p>
<p class="apicode">' Postconditions: Inspect the Immediate window.<o:p></o:p></p>
<p class="apicode">
'----------------------------------------------------------------------<o:p></o:p></p>
<p class="apicode">Dim swApp As SldWorks.SldWorks<o:p></o:p></p>
<p class="apicode">Dim Extn As SldWorks.ModelDocExtension<o:p></o:p></p>
<p class="apicode">Dim MyMassProp As SldWorks.MassProperty2<o:p></o:p></p>
<p class="apicode">Dim OvProp As SldWorks.MassPropertyOverrideOptions<o:p></o:p></p>
<p class="apicode">Dim swModelDoc As SldWorks.ModelDoc2<o:p></o:p></p>
<p class="apicode">Dim pmoi As Variant<o:p></o:p></p>
<p class="apicode">Dim vValue As Variant<o:p></o:p></p>
<p class="apicode">Dim value(2) As Double<o:p></o:p></p>
<p class="apicode">Dim errors As Long<o:p></o:p></p>
<p class="apicode">Dim warnings As Long<o:p></o:p></p>
<p class="apicode">Dim val As Double<o:p></o:p></p>
<p class="apicode">Dim params As Variant<o:p></o:p></p>
<p class="apicode"><o:p>&nbsp;</o:p></p>
<p class="apicode">Option Explicit<o:p></o:p></p>
<p class="apicode">Sub main()<o:p></o:p></p>
<p class="apicode"><o:p>&nbsp;</o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Set 
swApp = Application.SldWorks<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Set 
swModelDoc = swApp.OpenDoc6(&quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 
2020\samples\tutorial\advdrawings\98food processor.sldasm&quot;, swDocASSEMBLY, 
swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Set 
Extn = swModelDoc.Extension<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>' 
Create mass properties and override options<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Set 
MyMassProp = Extn.<b style="mso-bidi-font-weight: normal">CreateMassProperty2</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Set 
OvProp = MyMassProp.<b style="mso-bidi-font-weight: normal">GetOverrideOptions</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
OvProp.<b style="mso-bidi-font-weight: normal">OverrideMass</b> = True<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
OvProp.<b style="mso-bidi-font-weight: normal">SetOverrideMassValue</b> (100)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Dim 
comArr(8) As Double<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(0) = 0.1677<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(1) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(2) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(3) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(4) = 0.21358<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(5) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(6) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(7) = 0<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
comArr(8) = 0.34772<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
OvProp.<b style="mso-bidi-font-weight: normal">OverrideMomentsOfInertia</b> = 
True<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
OvProp.<b style="mso-bidi-font-weight: normal">SetOverrideMomentsOfInertiaValue</b> 
0, comArr, &quot;&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>' 
Use document property units (MKS)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
MyMassProp.<b style="mso-bidi-font-weight: normal">UseSystemUnits</b> = False<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Mass properties before override&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Mass</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Mass: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Volume</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Volume: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Density</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Density: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">SurfaceArea</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Surface area: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
pmoi = MyMassProp.<b style="mso-bidi-font-weight: normal">PrincipalMomentsOfInertia</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Principal moments of inertia: Px: &quot; &amp; pmoi(0) &amp; &quot;, 
Py: &quot; &amp; pmoi(1) &amp; &quot;, and Pz: &quot; &amp; pmoi(2)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
vValue = MyMassProp.<b style="mso-bidi-font-weight: normal">GetMomentOfInertia</b>(0)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Moments of inertia: Lxx: &quot; &amp; vValue(0) &amp; &quot;, Lxy: &quot; 
&amp; vValue(1) &amp; &quot;, Lxz: &quot; &amp; vValue(2) &amp; &quot;, Lyx: &quot; &amp; vValue(3) &amp; &quot;, Lyy: &quot; &amp; 
vValue(4) &amp; &quot;, Lyz: &quot; &amp; vValue(5) &amp; &quot;, Lzx: &quot; &amp; vValue(6) &amp; &quot;, Lzy: &quot; &amp; 
vValue(7) &amp; &quot;, Lzz: &quot; &amp; vValue(8)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
MyMassProp.<b style="mso-bidi-font-weight: normal">SetOverrideOptions</b> 
OvProp, swThisConfiguration, Empty<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp; &nbsp;</span>MyMassProp.<b style="mso-bidi-font-weight: normal">Recalculate</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Mass properties after override&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;&quot;<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p></o:p>
</p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Mass</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Mass: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Volume</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Volume: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">Density</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Density: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>val 
= MyMassProp.<b style="mso-bidi-font-weight: normal">SurfaceArea</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Surface area: &quot; &amp; val<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
pmoi = MyMassProp.<b style="mso-bidi-font-weight: normal">PrincipalMomentsOfInertia</b><o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Principal moments of inertia: Px: &quot; &amp; pmoi(0) &amp; &quot;, Py: &quot; &amp; pmoi(1) 
&amp; &quot;, and Pz: &quot; &amp; pmoi(2)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
vValue = MyMassProp.<b style="mso-bidi-font-weight: normal">GetMomentOfInertia</b>(0)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>
Debug.Print &quot;Moments of inertia: Lxx: &quot; &amp; vValue(0) &amp; &quot;, Lxy: &quot; &amp; vValue(1) &amp; &quot;, 
Lxz: &quot; &amp; vValue(2) &amp; &quot;, Lyx: &quot; &amp; vValue(3) &amp; &quot;, Lyy: &quot; &amp; vValue(4) &amp; &quot;, Lyz: &quot; &amp; 
vValue(5) &amp; &quot;, Lzx: &quot; &amp; vValue(6) &amp; &quot;, Lzy: &quot; &amp; vValue(7) &amp; &quot;, Lzz: &quot; &amp; 
vValue(8)<o:p></o:p></p>
<p class="apicode"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><o:p>
End Sub</o:p></p>

</body>

</html>
