<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Get Custom Properties for Weldment Cut-list Item Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples, cut lists">
<meta name=MS-HKWD content="VBA examples, weldment cut lists">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1009>
<meta name=layout-width content=628>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Get Custom Properties for Weldment Cut-list Item Example (VBA)</h1>

<p>This example shows how to get the custom properties for the selected 
 weldment cut-list item.</p>

<pre>'---------------------------------------------------------------
'&nbsp;Preconditions:
'&nbsp;1.&nbsp;Open&nbsp;<i>public_documents</i><b>\samples\tutorial\api\weldment_box3.sldprt</b>.
'&nbsp;2.&nbsp;Click&nbsp;<b>Tools&nbsp;&gt;&nbsp;Options&nbsp;&gt;&nbsp;Document&nbsp;Properties&nbsp;&gt;&nbsp;Weldments&nbsp;&gt;</b>
'&nbsp;&nbsp;&nbsp;&nbsp;<b>Rename&nbsp;cut&nbsp;list&nbsp;folders&nbsp;with&nbsp;Description&nbsp;property&nbsp;value &gt; OK</b>.
'&nbsp;3.&nbsp;Right-click&nbsp;<b>Cut&nbsp;list(31)</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree
'&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;click&nbsp;<b>Update</b>.
' 4. Expand <b>Cut list(31)</b> and click <b>TUBE, SQUARE 30 X 30 X 2.60&lt;1&gt;</b>.
'&nbsp;5.&nbsp;Open&nbsp;the&nbsp;Immediate&nbsp;window
'
' Postconditions:
' 1. Gets the custom properties for the selected cut-list item.
' 2. Examine the Immediate window.
'
' NOTE: Because the part document is used elsewhere, do not
' save changes.
'----------------------------------------
Option Explicit</pre>
<pre>Sub main() 
</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swCutlistItem As SldWorks.Feature
    Dim swCustPropMgr As SldWorks.CustomPropertyManager
    Dim names As Variant
    Dim name As Variant
    Dim textexp As String
    Dim evalval As String
    
    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swCutlistItem = swSelMgr.<b>GetSelectedObject6</b>(1, 0)    </pre>
<pre>    Set swCustPropMgr = swCutlistItem.<b>CustomPropertyManager</b>
    Debug.Print &quot;Custom properties for selected weldment cut-list item&quot;
    Debug.Print &quot;Number of custom properties = &quot; + CStr(swCustPropMgr.<b>Count</b>)
    Debug.Print &quot;Name&quot;, &quot;Text Expression&quot;, &quot;Value&quot;, &quot;Type&quot;    </pre>
<pre>    names = swCustPropMgr.<b>GetNames</b>
    For Each name In names
        swCustPropMgr.<b>Get2</b> name, textexp, evalval
        Debug.Print name, textexp, evalval, swCustPropMgr.<b>GetType</b>(name)
    Next name</pre>
<pre>End Sub</pre>

</body>

</html>
