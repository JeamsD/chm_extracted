<html>

<head>
<title>Add ActiveX Tabs to Model View Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,tabs">
<meta name=MS-HKWD content="VBA examples,model views">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Add ActiveX Tabs to Model View Example (VBA)</h1>

<p>This example shows how to add two ActiveX tabs to a model view.</p>
<pre>'----------------------------------------------------------
' Preconditions:
' 1. In the IDE:
'    a. Reference your ActiveX control file (click <b>Tools &gt; </b>
'       <b>References &gt; Browse &gt;</b> browse to the folder where the 
'       ActiveX control file resides and click the ActiveX 
'       control file <b>&gt; Open &gt; OK</b>).
'    a. Insert the ActiveX component (click <b>Insert &gt; Components &gt; </b>
'       ActiveX component's check box <b>&gt; OK</b>).
' 2. Verify that the specified part document exists.
' 3. Replace <i>activex_control_component_declaration </i>and 
'    <i>activex_control_CLSID_or_ProgID</i> with your ActiveX control's 
'    information.
'
' Postconditions:
' 1. Opens the part document and adds two new tabs to the model view.
' 2. Activates the model view.
' 3. To verify the ActiveX controls on the new tabs,
'    click each tab.
'
' NOTE: Because the part document is used elsewhere,
' do not save changes.
'------------------------------------------------------------</pre>
<pre>Option Explicit</pre>
<pre>Sub Main()</pre>
<pre>    Const calTabName1 As String = &quot;Tab 1&quot;
    Const calTabName2 As String = &quot;Tab 2&quot;</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swModViewMgr As SldWorks.ModelViewManager
    Dim calCtrl1 As <i>activex_control_component_declaration</i>
    Dim calCtrl2 As <i>activex_control_component_declaration</i>
    Dim fileName As String
    Dim errors As Long
    Dim warnings As Long
    Dim status  As Boolean</pre>
<pre>    Set swApp = CreateObject(&quot;SldWorks.Application&quot;)
    fileName = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2018\samples\tutorial\fillets\knob.sldprt&quot;
    Set swModel = swApp.<b>OpenDoc6</b>(fileName, swDocPART, swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)
    Set swModViewMgr = swModel.<b>ModelViewManager</b></pre>
<pre>    ' Add the ActiveX control tabs
    Set calCtrl1 = swModViewMgr.<b>AddControl</b>(calTabName1, &quot;<i>activex_control_CLSID_or_ProgID</i>&quot;, &quot;&quot;)
    Set calCtrl2 = swModViewMgr.<b>AddControl</b>(calTabName2, &quot;<i>activex_control_CLSID_or_ProgID</i>&quot;, &quot;&quot;)</pre>
<pre>    status = swModViewMgr.<b>ActivateControlTab</b>(calTabName1)
    status = swModViewMgr.<b>IsControlTabActive</b>(calTabName1)
    status = swModViewMgr.<b>IsModelTabActive</b></pre>
<pre>    ' Switch back to model view
    status = swModViewMgr.<b>ActivateModelTab</b></pre>
<pre>End Sub</pre>

</body>

</html>
