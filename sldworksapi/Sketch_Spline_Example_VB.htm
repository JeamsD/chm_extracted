<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Sketch Spline Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="Sketch (see also ISketch Interface),splines">
<meta name=MS-HKWD content="Splines,sketch">
<meta name=MS-HKWD content="VBA examples,splines">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1639>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Sketch Spline Example (VBA)</h1>

<p>This example shows how to sketch a spline.</p>

<p class="APICODE">
'---------------------------------------------------------------------------<br>
' Preconditions: Open a new part.<br>
'<br>
' Postconditions:<br>
' 1. Creates a sketch.<br>
' 2. Sketches a spline.<br>
' 3. Examine the graphics area.<br>
'----------------------------------------------------------------------------</p>
<p class="APICODE">Option Explicit</p>
<p class="APICODE">Sub main()</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Dim swApp 
As SldWorks.SldWorks<br>
&nbsp;&nbsp;&nbsp; Dim swModel 
As SldWorks.ModelDoc2<br>
&nbsp;&nbsp;&nbsp; Dim nPtData(35) 
As Double<br>
&nbsp;&nbsp;&nbsp; Dim vPtData 
As Variant<br>
&nbsp;&nbsp;&nbsp; Dim swSketchSeg 
As SldWorks.SketchSegment<br>
&nbsp;&nbsp;&nbsp; Dim bRet&nbsp; 
As Boolean</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; Set swApp = Application.SldWorks<br>
&nbsp;&nbsp;&nbsp; Set swModel = swApp.<b>ActiveDoc</b></p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; nPtData(0) = 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
'Dimension<br>
&nbsp;&nbsp;&nbsp; nPtData(1) = 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Order<br>
&nbsp;&nbsp;&nbsp; nPtData(2) = 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Number of 
control points<br>
&nbsp;&nbsp;&nbsp; nPtData(3) = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Periodicity</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; ' Knots<br>
&nbsp;&nbsp;&nbsp; nPtData(4) = 0<br>
&nbsp;&nbsp;&nbsp; nPtData(5) = 0<br>
&nbsp;&nbsp;&nbsp; nPtData(6) = 0<br>
&nbsp;&nbsp;&nbsp; nPtData(7) = 0<br>
&nbsp;&nbsp;&nbsp; nPtData(8) = 0.295784969875007<br>
&nbsp;&nbsp;&nbsp; nPtData(9) = 0.295784969875007<br>
&nbsp;&nbsp;&nbsp; nPtData(10) = 0.588801176674805<br>
&nbsp;&nbsp;&nbsp; nPtData(11) = 1<br>
&nbsp;&nbsp;&nbsp; nPtData(12) = 1<br>
&nbsp;&nbsp;&nbsp; nPtData(13) = 1<br>
&nbsp;&nbsp;&nbsp; nPtData(14) = 1</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; ' Control points<br>
&nbsp;&nbsp;&nbsp; nPtData(15) = -101.019623655914 / 1000#:&nbsp;&nbsp;&nbsp; 
nPtData(16) = -9.38844086021505 / 1000#:&nbsp;&nbsp;&nbsp; nPtData(17) = 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(18) = -119.993564790426 / 1000#:&nbsp;&nbsp;&nbsp; 
nPtData(19) = 13.6067814289365 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp; nPtData(20) = 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(21) = -138.967505924938 / 1000#:&nbsp;&nbsp;&nbsp; 
nPtData(22) = 36.602003718088 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nPtData(23) 
= 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(24) = 15.8143947928824 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp; 
nPtData(25) = 19.0600549700683 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp; nPtData(26) = 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(27) = -59.4979409454141 / 1000#:&nbsp;&nbsp;&nbsp; 
nPtData(28) = -24.6206927754025 / 1000#:&nbsp;&nbsp;&nbsp; nPtData(29) = 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(30) = 12.2077094083999 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp; 
nPtData(31) = -18.3231635953553 / 1000#:&nbsp;&nbsp;&nbsp; nPtData(32) = 0#<br>
&nbsp;&nbsp;&nbsp; nPtData(33) = 54.0774193548387 / 1000#:&nbsp;&nbsp;&nbsp;&nbsp; 
nPtData(34) = -14.6459677419355 / 1000#:&nbsp;&nbsp;&nbsp; nPtData(35) = 0#</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; vPtData = nPtData</p>
<p class="APICODE">&nbsp;&nbsp;&nbsp; swModel.<b>InsertSketch2</b> True<br>
&nbsp;&nbsp;&nbsp; bRet = swModel.<b>SketchSplineByEqnParams2</b>((vPtData))<br>
&nbsp;&nbsp;&nbsp; swModel.<b>InsertSketch2</b> True</p>
<p class="APICODE">&nbsp;End Sub</p>

</body>

</html>
