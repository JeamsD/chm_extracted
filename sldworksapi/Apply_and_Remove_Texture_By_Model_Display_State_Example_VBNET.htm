<html>

<head>
<title>Apply and Remove Texture To and From Model By Display State (VB.NET)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VB.NET examples,display states">
<meta name=MS-HKWD content="VB.NET examples,textures">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Apply and Remove Texture To and From Model By Display State (VB.NET)</h1>
<p>This example shows how to apply and remove texture to and from a model using 
the name of a display state of the model.</p>
<font SIZE="2" COLOR="#008000">
<p class="APICODE"><font size="2">'--------------------------------------------------------------------------<br>
' Preconditions:<br>
' 1. Verify that the specified part to open and texture exist.<br>
' 2. Open the Immediate window.<br>
'<br>
' Postconditions: <br>
' 1. Opens the specified part and applies texture to the part. <br>
' 2. Examine the part to verify.<br>
</font>' 3. In the IDE, click the <b>Continue</b> button at Stop.<br>
' 4. Removes the texture from the selected face.<br>
' 5. Examine the Immediate window and the <font size="2">part.<br>
'<br>
' NOTE: Because the part document is used elsewhere, do not save changes.<br>
'-------------------------------------------------------------------------</font></font><font SIZE="2" COLOR="#0000ff"><br>
Imports</font><font SIZE="2"> SolidWorks.Interop.sldworks</font><font SIZE="2" COLOR="#0000ff"><br>
Imports</font><font SIZE="2"> SolidWorks.Interop.swconst</font><font SIZE="2" COLOR="#0000ff"><br>
Imports</font><font SIZE="2"> System</font><font SIZE="2" COLOR="#0000ff"><br>
Imports</font><font SIZE="2"> System.Diagnostics</p>
</font><font SIZE="2" COLOR="#0000ff">
<blockquote>
	<p class="APICODE">Partial</font><font SIZE="2"> </font>
	<font SIZE="2" COLOR="#0000ff">Class</font><font SIZE="2"> SolidWorksMacro</p>
	<blockquote>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Public</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">Sub</font><font SIZE="2"> main()</font></p>
		<p class="APICODE">&nbsp;</p>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swModel </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		ModelDoc2</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swModelDocExt </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		ModelDocExtension</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		texture </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		Texture</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		displayState </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">String</p>
		</font><font SIZE="2">
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		errors </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">Long</p>
		</font><font SIZE="2">
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		warnings </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">Long</p>
		</font><font SIZE="2">
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		namStr </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">String</font></p>
		<p class="APICODE">&nbsp;</p>
		<font SIZE="2">
		<p class="APICODE"></font><font SIZE="2" COLOR="#008000">' Open document
		</p>
		</font><font SIZE="2">
		<p class="APICODE">swModel = swApp.<b>OpenDoc6</b>(</font><font SIZE="2" COLOR="#a31515">&quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 
		2018\samples\tutorial\motionstudies\valve.sldprt&quot;</font><font SIZE="2">, 
		swDocumentTypes_e.swDocPART, swOpenDocOptions_e.swOpenDocOptions_Silent,
		</font><font SIZE="2" COLOR="#a31515">&quot;&quot;</font><font SIZE="2">, errors, 
		warnings)</p>
		<p class="APICODE">swModelDocExt = swModel.<b>Extension</b></p>
		<p class="APICODE">&nbsp;</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#008000">' Set texture 
		on selected model in the</p>
		</font><font SIZE="2">
		<p class="APICODE"></font><font SIZE="2" COLOR="#008000">' specified 
		display state</p>
		</font><font SIZE="2">
		<p class="APICODE">displayState = </font><font SIZE="2" COLOR="#a31515">
		&quot;&lt;Default&gt;_Display State 1&quot;</p>
		</font><font SIZE="2">
		<p class="APICODE">namStr = </font><font SIZE="2" COLOR="#a31515">&quot;&lt;SystemTexture&gt;\images\textures\pattern\checker2.jpg&quot;</p>
		</font><font SIZE="2">
		<p class="APICODE">texture = swModelDocExt.<b>CreateTexture</b>(namStr, 
		5, 45, </font><font SIZE="2" COLOR="#0000ff">False</font><font SIZE="2">)</p>
		<p class="APICODE">Debug.Print(</font><font SIZE="2" COLOR="#a31515">&quot;Texture 
		set: &quot;</font><font SIZE="2"> &amp; swModelDocExt.<b>SetTextureByDisplayState</b>(displayState, 
		texture))</font></p>
		<p class="APICODE">&nbsp;</p>

<p class=APICODE><!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->
<font color="#008000">' 
 Examine the selected face to verify</font></p>

<p class=APICODE><font color="#008000"><!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->' 
 that the specified texture was set</font></p>

<p class=APICODE><font color="#008000"><!--kadov_tag{{<spaces>}}-->' 
 In the IDE, click the Continue button to </font> </p>

<p class=APICODE><font color="#008000"><!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->' 
 resume running macro</font></p>

<p class=APICODE><!--kadov_tag{{<spaces>}}-->Stop</p>

		<p class="APICODE">&nbsp;</p>
		<p class="APICODE"><font SIZE="2" COLOR="#008000"><br>
		' Remove texture from 
		model by display state</font><font SIZE="2"><br>
		Debug.Print(</font><font SIZE="2" COLOR="#a31515">&quot;Texture 
		removed: &quot;</font><font SIZE="2"> &amp; swModelDocExt.<b>RemoveTextureByDisplayState</b>(displayState))</font></p>
		<p class="APICODE"><font SIZE="2"></p>
		<p class="APICODE">swModel.<b>ForceRebuild3</b>(</font><font SIZE="2" COLOR="#0000ff">False</font><font SIZE="2">)</p>
	</blockquote>
</blockquote>
<p class="APICODE">&nbsp;</p>
<blockquote>
	<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">End</font><font SIZE="2">
	</font><font SIZE="2" COLOR="#0000ff">Sub</font></p>
	<p class="APICODE">&nbsp;</p>
	<font SIZE="2">
	<p class="APICODE"></font><font SIZE="2" COLOR="#008000">''' &lt;summary&gt;</p>
	</font><font SIZE="2">
	<p class="APICODE"></font><font SIZE="2" COLOR="#008000">''' The SldWorks 
	swApp variable is pre-assigned for you.</p>
	</font><font SIZE="2">
	<p class="APICODE"></font><font SIZE="2" COLOR="#008000">''' &lt;/summary&gt;</p>
	</font><font SIZE="2">
	<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Public</font><font SIZE="2"> 
	swApp </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
	SldWorks</font></p>
	<p class="APICODE">&nbsp;</p>
</blockquote>
<font SIZE="2" COLOR="#0000ff">
<p class="APICODE">End</font><font SIZE="2"> </font>
<font SIZE="2" COLOR="#0000ff">Class</p>
</font>

</body>

</html>
