<html>

<head>
<title>Fire Notification When Changing a Table in a Drawing Document Example (C#)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="C# examples,tables">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Fire Notification When Changing a Table in a Drawing Document Example (C#)</h1>
<p>This example shows how to fire a notification when a table is changed in a 
drawing document.</p>
<div style="font-family:Monospace; font-size: 10pt; background-color: white;">
	<div style="font-family:Monospace; font-size: 10pt; background-color: white;">
		<pre><font color="#008000">//---------------------------------------------------------------
// Preconditions:
// 1. Open a drawing document.
//&nbsp;2. Verify that the <b>Tools &gt; Options &gt; System Options &gt; </b>
// &nbsp;&nbsp;&nbsp;<b>Stop VSTA debugger on macro exit </b>check box is not selected.
// 3. Select a drawing view and click <b>Insert &gt; Tables &gt; Bill of Materials</b>.
//&nbsp;4. Click <b>OK</b> in the Bill of Materials PropertyManager page.
// 5. Run this macro (press F5).
//&nbsp;6. Right-click a column in the table and select <b>Delete &gt; Column</b>.
//
// Postconditions:
//&nbsp;1. Displays a message box informing you that the table was modified.
//&nbsp;&nbsp;&nbsp;&nbsp;NOTE: Check the taskbar for the message box if you don't 
//    see it.
// 2. Click <b>OK</b> to close the message box.
//&nbsp;3. Stop the debugger.
/---------------------------------------------------------------</font><span style="color:Green"> 					</span>
<span style="color:Blue">using</span><span style="color:Black"> SolidWorks.Interop.sldworks;
</span><span style="color:Blue">using</span><span style="color:Black"> SolidWorks.Interop.swconst;
</span><span style="color:Blue">using</span><span style="color:Black"> System;
</span><span style="color:Blue">using</span><span style="color:Black"> System.Diagnostics;
</span><span style="color:Blue">using</span><span style="color:Black"> System.Collections;
</span><span style="color:Blue">using</span><span style="color:Black"> System.Windows.Forms;
</span><span style="color:Blue">namespace</span><span style="color:Black"> ModifyTableNotification_CSharp.csproj
{
	</span><span style="color:Blue">partial</span><span style="color:Black"> </span><span style="color:Blue">class</span><span style="color:Black"> </span><span style="color:#2b91af">SolidWorksMacro
	</span><span style="color:Black">{
		</span><span style="color:Blue">public</span><span style="color:Black"> </span><span style="color:#2b91af">DrawingDoc</span><span style="color:Black"> swDrawingDoc;
		</span><span style="color:Blue">public</span><span style="color:Black"> </span><span style="color:Blue">void</span><span style="color:Black"> Main()
		{<br>
				</span><span style="color:#2b91af">ModelDoc2</span><span style="color:Black"> swModel = </span><span style="color:Blue">default</span><span style="color:Black">(</span><span style="color:#2b91af">ModelDoc2</span><span style="color:Black">);
				swModel = (</span><span style="color:#2b91af">ModelDoc2</span><span style="color:Black">)swApp.<b>ActiveDoc</b>;<br>
				</span><span style="color:Green">// Set up event 
				</span><span style="color:Black">swDrawingDoc = (</span><span style="color:#2b91af">DrawingDoc</span><span style="color:Black">)swModel;
				AttachEventHandlers();
		}<br>
		</span><span style="color:Blue">public</span><span style="color:Black"> </span><span style="color:Blue">void</span><span style="color:Black"> AttachEventHandlers()
		{
			AttachSWEvents();
		}<br><br>
		</span><span style="color:Blue">public</span><span style="color:Black"> </span><span style="color:Blue">void</span><span style="color:Black"> AttachSWEvents()						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			swDrawingDoc.ModifyTableNotify += </span><span style="color:Blue">this</span><span style="color:Black">.swDrawingDoc_ModifyTableNotify;
		}<br><br>
		</span><span style="color:Blue">private</span><span style="color:Black"> </span><span style="color:Blue">int</span><span style="color:Black"> <b>swDrawingDoc_ModifyTableNotify</b>(</span><span style="color:#2b91af">TableAnnotation</span><span style="color:Black"> TableAnnotation, </span><span style="color:Blue">int</span><span style="color:Black"> TableType, </span><span style="color:Blue">int</span><span style="color:Black"> reason, </span><span style="color:Blue">int</span><span style="color:Black"> RowInfo, </span><span style="color:Blue">int</span><span style="color:Black"> ColumnInfo, </span><span style="color:#2b91af">String</span><span style="color:Black"> DataInfo)
		{
			</span><span style="color:#2b91af">MessageBox</span><span style="color:Black">.Show(</span><span style="color:#a31515">&quot;A table was modified. Title: &quot;</span><span style="color:Black"> + TableAnnotation.<b>Title</b> + </span><span style="color:#a31515">&quot;, Type: &quot;</span><span style="color:Black"> + TableType + </span><span style="color:#a31515">&quot;, Reason code: &quot;</span><span style="color:Black"> + reason 	+ </span><span style="color:#a31515">&quot;, RowInfo: &quot;</span><span style="color:Black"> + RowInfo + </span><span style="color:#a31515">&quot;, ColumnInfo: &quot;</span><span style="color:Black"> + ColumnInfo + </span><span style="color:#a31515">&quot;, DataInfo: &quot;</span><span style="color:Black"> + DataInfo);
			</span><span style="color:Blue">return</span><span style="color:Black"> 0;
		}<br>
		</span><span style="color:Blue">public</span><span style="color:Black"> </span><span style="color:#2b91af">SldWorks</span><span style="color:Black"> swApp;
	}
}</span></pre></div></div>

</body>

</html>
