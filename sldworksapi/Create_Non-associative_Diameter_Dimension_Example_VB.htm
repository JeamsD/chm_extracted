<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Create Non-associative Diameter Dimension Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VBA examples,dimensions">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1878>
<meta name=layout-width content=750>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Create Non-associative Diameter Dimension Example (VBA)</h1>

<p>This example shows how to create a non-associative diameter dimension.</p>
<pre>'---------------------------------------
' Preconditions: Open a drawing.
'
' Postconditions:
' 1. Creates a non-associative diameter
'    dimension in the drawing.
' 2. Examine the drawing.
'---------------------------------------
Option Explicit 
</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swDraw As SldWorks.DrawingDoc
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swDispDim As SldWorks.DisplayDimension
    Dim nDimLoc(2) As Double
    Dim nCircPt1(2) As Double
    Dim nCircPt2(2) As Double
    Dim nPlaneNorm(2) As Double
    Dim nTextPt(2) As Double
    Dim vDimLoc As Variant
    Dim vCircPt1 As Variant
    Dim vCircPt2 As Variant
    Dim vPlaneNorm As Variant
    Dim vTextPt As Variant
    Dim nDimVal As Double
    Dim nTextHt As Double</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swDraw = swModel</pre>
<pre>    nDimLoc(0) = 0.1
    nDimLoc(1) = 0.1
    nDimLoc(2) = 0.1
    vDimLoc = nDimLoc</pre>
<pre>    nCircPt1(0) = 0.64
    nCircPt1(1) = 0.112
    nCircPt1(2) = 0#
    vCircPt1 = nCircPt1
    </pre>
<pre>    nCircPt2(0) = 0.125
    nCircPt2(1) = 0.14
    nCircPt2(2) = 0#
    vCircPt2 = nCircPt2</pre>
<pre>    nPlaneNorm(0) = 0#
    nPlaneNorm(1) = 0#
    nPlaneNorm(2) = 1#
    vPlaneNorm = nPlaneNorm</pre>
<pre>    nTextPt(2) = 0.2
    nTextPt(2) = 0.2
    nTextPt(2) = 0.2
    vTextPt = nTextPt</pre>
<pre>    nDimVal = 0.1255
    nTextHt = 0.01</pre>
<pre>    Set swDispDim = swDraw.<b>CreateDiamDim4</b>(vDimLoc, vCircPt1, vCircPt2, vPlaneNorm, vTextPt, nDimVal, nTextHt)
    swDispDim.<b>Diametric</b> = False</pre>
<pre>    swModel.<b>GraphicsRedraw2</b></pre>
<pre>End Sub</pre>

</body>

</html>
