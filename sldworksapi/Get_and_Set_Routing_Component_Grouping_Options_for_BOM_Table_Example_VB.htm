<html>

<head>
<title>Get and Set Routing Component Grouping Options for BOM Table Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,BOM tables">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Get and Set Routing Component Grouping Options for BOM Table Example (VBA)</h1>
<p>This example shows how to get and set the routing component grouping 
options&nbsp;for this BOM table in a drawing of an assembly containing routing 
components.</p>

<pre>'----------------------------------------------------------------------------------
' Preconditions:
' 1. Open <i>public_documents</i><b>\samples\tutorial\api\AutoRouteThroughSketchEntities.sldddrw</b>.
' 2. Open the Immediate window.
'
' Postconditions:
' 1. Selects the <b>Bill of Materials1</b> feature.
' 2. Examine the Immediate window.
'
' NOTE: Because the drawing is used elsewhere, do not save changes.
'---------------------------------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swModelDocExt As SldWorks.ModelDocExtension
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swBomFeature As SldWorks.BomFeature
    Dim status As Boolean
    Dim options As Long    </pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swModelDocExt = swModel.<b>Extension</b>    </pre>
<pre>    status = swModelDocExt.<b>SelectByID2</b>(&quot;Bill of Materials1&quot;, &quot;BOMFEATURE&quot;, 0, 0, 0, False, 0, Nothing, 0)
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swBomFeature = swSelMgr.<b>GetSelectedObject6</b>(1, -1)
    Debug.Print &quot;Name of configuration used for BOM table: &quot; &amp; swBomFeature.<b>Configuration</b>    </pre>
<pre>    'Get current routing component grouping options
    Debug.Print &quot;Current routing component grouping options: &quot; &amp; swBomFeature.<b>RoutingComponentGrouping</b>        </pre>
<pre>    'Set new routing component grouping options
    options = swRoutingComponentGroupingOption_e.swShowOnlyRoutingComponentsInBOM + swRoutingComponentGroupingOption_e.swDisplayUnitsInBOM
    swBomFeature.<b>RoutingComponentGrouping</b> = options
    Debug.Print &quot;Modified routing component grouping options: &quot; &amp; swBomFeature.<b>RoutingComponentGrouping
</b>    
End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
