<html>

<head>
<title>Insert Cavity Example (C#)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="C# examples,cavity">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Insert Cavity Example (C#)</h1>
<p>This example shows how to insert a cavity in a mold base.</p>

<pre style="font-family: Courier New; font-size: 13; color: black; background: white"><span style="color:green;">//------------------------------------------------------------------------------------</span>
<span style="color:green;">//&nbsp;Preconditions:</span>
<span style="color:green;">//&nbsp;1.&nbsp;Create&nbsp;a&nbsp;new&nbsp;folder&nbsp;and&nbsp;copy&nbsp;<i>public_documents</i><b>\samples\tutorial\molds\telephone.sldprt</b>&nbsp;</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;that&nbsp;folder.</span>
<span style="color:green;">//&nbsp;2.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;New&nbsp;&gt;&nbsp;Part&nbsp;&gt;&nbsp;OK</b>&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;part&nbsp;document.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Insert&nbsp;a&nbsp;sketch&nbsp;of&nbsp;a&nbsp;rectangle&nbsp;with&nbsp;a&nbsp;length&nbsp;of&nbsp;240&nbsp;mm&nbsp;and&nbsp;width&nbsp;of&nbsp;350&nbsp;mm.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Using&nbsp;the&nbsp;sketch,&nbsp;create&nbsp;a&nbsp;boss&nbsp;extrude&nbsp;feature&nbsp;with&nbsp;a&nbsp;depth&nbsp;of&nbsp;160&nbsp;mm.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;part&nbsp;as&nbsp;<b>telephoneMoldBase.sldprt&nbsp;</b>in&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1.</span>
<span style="color:green;">//&nbsp;3.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;New&nbsp;&gt;&nbsp;Assembly&nbsp;&gt;&nbsp;OK</b>&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;assembly&nbsp;document.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Click&nbsp;<b>telephoneMoldBase</b>&nbsp;in&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>&nbsp;in&nbsp;the&nbsp;PropertyManager&nbsp;page.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Click&nbsp;<b>OK</b>.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Click&nbsp;<b>Insert&nbsp;Components&nbsp;</b>on&nbsp;the&nbsp;Assembly&nbsp;toolbar,&nbsp;click&nbsp;<b>Browse</b>&nbsp;in</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Part/Assembly&nbsp;to&nbsp;Insert</b>,&nbsp;click&nbsp;<b>telephone.sldprt</b>&nbsp;located&nbsp;in&nbsp;the&nbsp;folder&nbsp;</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;created&nbsp;in&nbsp;step&nbsp;1,&nbsp;and&nbsp;click&nbsp;<b>Open</b>.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Drop&nbsp;<b>telephone.sldprt</b>&nbsp;in&nbsp;the&nbsp;graphics&nbsp;area.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Click&nbsp;<b>View&nbsp;&gt;&nbsp;Display&nbsp;&gt;&nbsp;Hidden&nbsp;Lines&nbsp;Visible</b>.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;In&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree,&nbsp;click&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>Move&nbsp;Component</b></span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;Assembly&nbsp;toolbar.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Move&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;into&nbsp;the&nbsp;center&nbsp;of&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;and&nbsp;click&nbsp;<b>OK</b>.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIP:&nbsp;Change&nbsp;the&nbsp;view&nbsp;orientation&nbsp;to&nbsp;<b>Top</b>&nbsp;and&nbsp;<b>Front</b>&nbsp;to&nbsp;help&nbsp;center&nbsp;<b>telephone&lt;1&gt;</b>.</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;h.&nbsp;Click&nbsp;<b>File&nbsp;&gt;&nbsp;Save&nbsp;All&nbsp;&gt;&nbsp;Rebuild&nbsp;and&nbsp;save&nbsp;the&nbsp;document&nbsp;(recommended</b>),&nbsp;</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;navigate&nbsp;to&nbsp;the&nbsp;folder&nbsp;created&nbsp;in&nbsp;step&nbsp;1,&nbsp;type&nbsp;<b>AssemInterim.sldasm</b>&nbsp;in&nbsp;</span>
<span style="color:green;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>File&nbsp;name</b>,&nbsp;and&nbsp;click&nbsp;<b>Save</b>.</span>
<span style="color:green;">//&nbsp;4.&nbsp;Click&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree.</span>
<span style="color:green;">//&nbsp;5.&nbsp;Ctrl+click&nbsp;<b>telephone&lt;1&gt;</b>&nbsp;in&nbsp;the&nbsp;FeatureManager&nbsp;design&nbsp;tree.</span>
<span style="color:green;">//</span>
<span style="color:green;">//&nbsp;Postconditions:</span>
<span style="color:green;">//&nbsp;1.&nbsp;Creates&nbsp;<b>Cavity1</b>&nbsp;in&nbsp;<b>telphoneMoldBase&lt;1&gt;</b>.</span>
<span style="color:green;">//&nbsp;2.&nbsp;Expand&nbsp;<b>telephoneMoldBase&lt;1&gt;</b>&nbsp;to&nbsp;verify&nbsp;step&nbsp;1.</span>
<span style="color:green;">//-----------------------------------------------------------------------------------</span>
<span style="color:blue;">using</span>&nbsp;SolidWorks.Interop.sldworks;
<span style="color:blue;">using</span>&nbsp;SolidWorks.Interop.swconst;
<span style="color:blue;">using</span>&nbsp;System.Runtime.InteropServices;
<span style="color:blue;">using</span>&nbsp;System;
 
<span style="color:blue;">namespace</span>&nbsp;Macro1CSharp.csproj
{
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">partial</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">SolidWorksMacro</span>
&nbsp;&nbsp;&nbsp;&nbsp;{
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">void</span>&nbsp;Main()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ModelDoc2&nbsp;swModel&nbsp;=&nbsp;<span style="color:blue;">default</span>(ModelDoc2);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SelectionMgr&nbsp;swSelMgr&nbsp;=&nbsp;<span style="color:blue;">default</span>(SelectionMgr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AssemblyDoc&nbsp;swAssy&nbsp;=&nbsp;<span style="color:blue;">default</span>(AssemblyDoc);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Component2&nbsp;swMoldBaseComp&nbsp;=&nbsp;<span style="color:blue;">default</span>(Component2);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Component2&nbsp;swCoreComp1&nbsp;=&nbsp;<span style="color:blue;">default</span>(Component2);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">int</span>&nbsp;nRetval&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">int</span>&nbsp;nInfo&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">bool</span>&nbsp;bRet&nbsp;=&nbsp;<span style="color:blue;">false</span>;
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModel&nbsp;=&nbsp;(ModelDoc2)swApp.<b>ActiveDoc</b>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy&nbsp;=&nbsp;(AssemblyDoc)swModel;
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swSelMgr&nbsp;=&nbsp;(SelectionMgr)swModel.<b>SelectionManager</b>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swMoldBaseComp&nbsp;=&nbsp;(Component2)swSelMgr.<b>GetSelectedObjectsComponent2</b>(1);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swCoreComp1&nbsp;=&nbsp;(Component2)swSelMgr.<b>GetSelectedObjectsComponent2</b>(2);
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swModel.<b>ClearSelection2</b>(<span style="color:blue;">true</span>);
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRet&nbsp;=&nbsp;swMoldBaseComp.<b>Select2</b>(<span style="color:blue;">false</span>,&nbsp;0);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nRetval&nbsp;=&nbsp;swAssy.<b>EditPart2</b>(<span style="color:blue;">true</span>,&nbsp;<span style="color:blue;">true</span>,&nbsp;<span style="color:blue;">ref</span>&nbsp;nInfo);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRet&nbsp;=&nbsp;swCoreComp1.<b>Select2</b>(<span style="color:blue;">true</span>,&nbsp;0);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy.<b>InsertCavity4</b>(0.0,&nbsp;0,&nbsp;0.0,&nbsp;<span style="color:blue;">true</span>,&nbsp;(<span style="color:blue;">int</span>)swCavityScaleType_e.swAboutCentroid,&nbsp;0);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swAssy.<b>EditAssembly</b>();
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">///</span><span style="color:green;">&nbsp;&nbsp;The&nbsp;SldWorks&nbsp;swApp&nbsp;variable&nbsp;is&nbsp;pre-assigned&nbsp;for&nbsp;you.</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;/summary&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;SldWorks&nbsp;swApp;
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre>

</body>

</html>
