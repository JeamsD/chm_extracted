<html>

<head>
<title>Disable Equation Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,equations">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Disable Equation Example (VBA)</h1>
<p>This example shows how to disable an equation.</p>

<pre>'-----------------------------------------------------------------
' Preconditions:
' 1. Open <i>public_documents</i><b>\samples\tutorial\api\partequations.sldprt</b>.
' 2. Open the Immediate window.
'
' Postconditions:
' 1. Disables an equation.
' 2. Examine the Immediate window.
'
' NOTE: Because the part is used elsewhere, do not save changes.
'------------------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swEqnMgr  As SldWorks.EquationMgr
    Dim i As Long
    Dim count As Long
    Dim disabledCount As Long    </pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swEqnMgr = swModel.<b>GetEquationMgr</b>
    count = swEqnMgr.<b>GetCount</b>
    Debug.Print &quot;Number of equations in part = &quot; &amp; count
    For i = 0 To count - 1
        Debug.Print &quot;  Eqn(&quot; &amp; i &amp; &quot;)  = &quot; &amp; swEqnMgr.<b>Equation</b>(i)
    Next i    </pre>
<pre>    Debug.Print &quot;&quot;    </pre>
<pre>    disabledCount = swEqnMgr.<b>GetDisabledEquationCount</b>
    Debug.Print &quot;Number of disabled equations in part before running macro = &quot; &amp; disabledCount    </pre>
<pre>    swEqnMgr.<b>Disabled</b>(count - 1) = True
    Debug.Print &quot;Eqn(&quot; &amp; (count - 1) &amp; &quot;) disabled? &quot; &amp; swEqnMgr.<b>Disabled</b>(count - 1)</pre>
<pre>    disabledCount = swEqnMgr.<b>GetDisabledEquationCount</b>
    Debug.Print &quot;Number of disabled equations in part after running macro = &quot; &amp; disabledCount    </pre>
<pre>    Debug.Print &quot;&quot;    </pre>
<pre>    count = swEqnMgr.<b>GetCount</b>
    Debug.Print &quot;Number of equations in part = &quot; &amp; count
    For i = 0 To count - 1
        Debug.Print &quot;  Eqn(&quot; &amp; i &amp; &quot;)  = &quot; &amp; swEqnMgr.<b>Equation</b>(i)
    Next i</pre>
<pre>End Sub</pre>

</body>

</html>
