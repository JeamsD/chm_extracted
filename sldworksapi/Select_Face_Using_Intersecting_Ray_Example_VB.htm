<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html LANG=EN-US>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Select Face Using Intersecting Ray Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta NAME=MS-HAID CONTENT=SelectByRay_Example>
<meta name=date content="07 25, 2001 2:52:06 PM">
<meta name=MS-HKWD content="VBA examples,intersecting rays">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=774>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body LANG=EN-US>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Select Face Using Intersecting Ray Example (VBA)</h1>

<p>This example shows how to select the first face that is intersected by a ray 
that starts at the specified point and runs parallel to the specified direction 
vector within the specified radius.</p>
<pre>'---------------------------------------------------------------
' Preconditions:
' 1. Open <i>public_documents</i><b>\samples\tutorial\api\box.sldrpt</b>.
' 2. Open the Immediate window.
'
' Postconditions:
<font face="Courier New">'&nbsp;1.&nbsp;Selects&nbsp;the&nbsp;first&nbsp;face&nbsp;intersected&nbsp;by&nbsp;a&nbsp;ray&nbsp;that starts 
'    at the specified point and runs parallel to the specified 
'    direction vector within the specified radius<font color="#008000">.</font></font>
' 2. Examine the graphics area and Immediate window.
'-----------------------------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>   Dim swApp As SldWorks.SldWorks
   Dim swModel As SldWorks.ModelDoc2
   Dim swModelDocExt As SldWorks.ModelDocExtension
   Dim startPointX As Double
   Dim startPointY As Double
   Dim startPointZ As Double
   Dim rayVecX As Double
   Dim rayVecY As Double
   Dim rayVecZ As Double
   Dim radius As Double
   Dim status As Boolean   </pre>
<pre>   Set swApp = Application.SldWorks
   Set swModel = swApp.<b>ActiveDoc</b>
   Set swModelDocExt = swModel.<b>Extension</b>   </pre>
<pre>   startPointX = 0.1
   startPointY = 0#
   startPointZ = 0#   </pre>
<pre>   rayVecX = -1#
   rayVecY = 0#
   rayVecZ = 0#   </pre>
<pre>   radius = 1#    </pre>
<pre>   status = swModelDocExt.<b>SelectByRay</b>(startPointX, startPointY, startPointZ, rayVecX, rayVecY, rayVecZ, radius, swSelectType_e.swSelFACES, False, 0, swSelectOption_e.swSelectOptionDefault)
   Debug.Print &quot;Selection status: &quot; &amp; status   </pre>
<pre>End Sub</pre>

</body>

</html>
