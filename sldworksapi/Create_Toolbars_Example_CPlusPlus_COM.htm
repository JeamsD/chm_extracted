<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Create Toolbars Example (C++ COM)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=767>
<meta name=layout-width content=630>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



 <META NAME="MS-HAID" CONTENT="EXCreateToolbars">
 <META NAME="MS-HKWD" CONTENT="C++ examples,toolbars">
 <META NAME="MS-HKWD" CONTENT="Toolbars">
</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Create Toolbars Example (C++ COM)</h1>

<p>Toolbars are added automatically by the C++ 
 COM Addin Wizard, so you should examine the code that the wizard generates. 
 An example is also included in this topic. </p>

<p>ISldWorks::AddToolbar4 takes bitmap filenames as arguments. You can 
 create those filenames from resources using CreateBitmapFIleFromResource().</p>

<p>&nbsp;</p>

<p class=apiCode
	style="margin-left: 49px;">//This method adds the user toolbar to the 
 SOLIDWORKS user interface</p>

<p class=apiCode
	style="margin-left: 49px;">void CswSampleAddin::AddToolbar()</p>

<p class=apiCode
	style="margin-left: 49px;">{</p>

<p class=apiCode
	style="margin-left: 89px;">long docType = swDocTemplateTypePART;</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR title;</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR callback;</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR enable;</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR tip;</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR hint;</p>

<p class=apiCode
	style="margin-left: 89px;">VARIANT_BOOL added;</p>

<p class=apiCode
	style="margin-left: 89px;">long menuPos = 0; //Not used</p>

<p class=apiCode
	style="margin-left: 89px;">title.LoadString(IDS_TOOLBAR_TITLE);</p>

<p class=apiCode
	style="margin-left: 89px;">CComBSTR smallImageFile, largeImageFile;</p>

<p class=apiCode
	style="margin-left: 89px;">bmp-&gt;CreateBitmapFileFromResource(IDB_TOOLBAR_SMALL, 
 &amp;smallImageFile);</p>

<p class=apiCode
	style="margin-left: 89px;">bmp-&gt;CreateBitmapFileFromResource(IDB_TOOLBAR_LARGE, 
 &amp;largeImageFile);</p>

<p class=apiCode
	style="margin-left: 89px;">iSwApp-&gt;<span style="font-weight: bold;">AddToolbar4</span>(addinID, 
 title, smallImageFile, largeImageFile, menuPos, docType, &amp;toolbarID);</p>

<p class=apiCode
	style="margin-left: 89px;">&nbsp;</p>

<p class=apiCode
	style="margin-left: 89px;">callback.LoadString(IDS_TOOLBAR_CALLBACK0);</p>

<p class=apiCode
	style="margin-left: 89px;">enable.LoadString(IDS_TOOLBAR_ENABLE0);</p>

<p class=apiCode
	style="margin-left: 89px;">tip.LoadString(IDS_TOOLBAR_TIP0);</p>

<p class=apiCode
	style="margin-left: 89px;">hint.LoadString(IDS_TOOLBAR_HINT0);</p>

<p class=apiCode
	style="margin-left: 89px;">iSwApp-&gt;<span style="font-weight: bold;">AddToolbarCommand2</span>(addinID, 
 toolbarID, 0, callback, enable, tip, hint, &amp;added);</p>

<p class=apiCode
	style="margin-left: 89px;">iSwApp-&gt;<span style="font-weight: bold;">AddToolbarCommand2</span>(addinID, 
 toolbarID, 1, callback, enable, tip, hint, &amp;added);</p>

<p class=apiCode
	style="margin-left: 89px;">iSwApp-&gt;<span style="font-weight: bold;">AddToolbarCommand2</span>(addinID, 
 toolbarID, 2, callback, enable, tip, hint, &amp;added);</p>

</body>

</html>
