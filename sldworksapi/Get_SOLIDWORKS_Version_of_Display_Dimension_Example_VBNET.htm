<html>

<head>
<title>Get SOLIDWORKS Version of Display Dimension (VB.NET)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VB.NET examples,display dimensions">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Get SOLIDWORKS Version of Display Dimension (VB.NET)</h1>
<font SIZE="2">
<p>This example shows how to find out if a display dimension in a drawing was 
created in SOLIDWORKS 2011 or later.</p>
<font SIZE="2" COLOR="#008000">
<p class="APICODE">'------------------------------------------------</p>
<p class="APICODE">' Preconditions:</p>
<p class="APICODE">' 1. Open a drawing document in which a display</p>
<p class="APICODE">'&nbsp;&nbsp;&nbsp; dimension exists.</p>
<p class="APICODE">' 2. Open the Immediate window.</p>
<p class="APICODE">' 3. Select the display dimension.</p>
<p class="APICODE">'</p>
<p class="APICODE">' Postconditions: Examine the Immediate window</p>
<p class="APICODE">' to see if the selected display dimension</p>
<p class="APICODE">' was created in SOLIDWORKS 2011 or later.</p>
<p class="APICODE">'-------------------------------------------------</p>
</font><font SIZE="2" COLOR="#0000ff">
<p class="APICODE">Imports</font><font SIZE="2"> SolidWorks.Interop.sldworks</p>
</font><font SIZE="2" COLOR="#0000ff">
<p class="APICODE">Imports</font><font SIZE="2"> SolidWorks.Interop.swconst</p>
</font><font SIZE="2" COLOR="#0000ff">
<p class="APICODE">Imports</font><font SIZE="2"> System</p>
</font><font SIZE="2" COLOR="#0000ff">
<p class="APICODE">Imports</font><font SIZE="2"> System.Diagnostics</p>
</font><font SIZE="2" COLOR="#0000ff">
<p class="APICODE">Partial</font><font SIZE="2"> </font>
<font SIZE="2" COLOR="#0000ff">Class</font><font SIZE="2"> SolidWorksMacro</font></p>
<blockquote>
	<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Public</font><font SIZE="2">
	</font><font SIZE="2" COLOR="#0000ff">Sub</font><font SIZE="2"> Main(</font>)</p>
	<blockquote>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swModel </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		ModelDoc2</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swSelMgr </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		SelectionMgr</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swDispDim </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2"> 
		DisplayDimension</p>
		<p class="APICODE"></font><font SIZE="2" COLOR="#0000ff">Dim</font><font SIZE="2"> 
		swSelObj </font><font SIZE="2" COLOR="#0000ff">As</font><font SIZE="2">
		</font><font SIZE="2" COLOR="#0000ff">Object</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Dim</font> selCount
		<font SIZE="2" COLOR="#0000ff">As</font> <font SIZE="2" COLOR="#0000ff">
		Long</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Dim</font> selType
		<font SIZE="2" COLOR="#0000ff">As</font> <font SIZE="2" COLOR="#0000ff">
		Long</font></p>
		<p class="APICODE">swModel = swApp.<b>ActiveDoc</b></p>
		<p class="APICODE">swSelMgr = swModel.<b>SelectionManager</b></p>
		<p class="APICODE">selCount = swSelMgr.<b>GetSelectedObjectCount2</b>(-1)</p>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">If</font> selCount &lt; 1
		<font SIZE="2" COLOR="#0000ff">Then</p>
		</font>
		<p class="APICODE">&nbsp;&nbsp;&nbsp; Debug.Print(<font SIZE="2" COLOR="#a31515">&quot;Select 
		a display dimension and rerun the macro.&quot;</font>)</p>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">&nbsp;&nbsp;&nbsp; 
		Exit</font> <font SIZE="2" COLOR="#0000ff">Sub</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">End</font>
		<font SIZE="2" COLOR="#0000ff">If</font></p>
		<p class="APICODE"><br>
		selType = swSelMgr.<b>GetSelectedObjectType3</b>(1, 0)</p>
		<p class="APICODE">swSelObj = swSelMgr.<b>GetSelectedObject6</b>(1, 0)</p>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Select</font>
		<font SIZE="2" COLOR="#0000ff">Case</font> selType</p>
		<blockquote>
			<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Case</font> 
			swSelectType_e.swSelDIMENSIONS</p>
			<p class="APICODE">swDispDim = swSelObj</p>
			<p class="APICODE">Debug.Print(<font SIZE="2" COLOR="#a31515">&quot;Was 
			display dimension created in SOLIDWORKS 2011 or later? &quot;</font> &amp; 
			swDispDim.<b>GetSupportsGenericText</b>)</p>
		</blockquote>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">End</font>
		<font SIZE="2" COLOR="#0000ff">Select</font></p>
	</blockquote>
	<p class="APICODE"><font SIZE="2" COLOR="#0000ff">End</font>
	<font SIZE="2" COLOR="#0000ff">Sub</p>
	</font>
	<blockquote>
		<p class="APICODE"><font SIZE="2" COLOR="#008000">''' &lt;summary&gt;</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#008000">''' The SldWorks swApp 
		variable is pre-assigned for you.</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#008000">''' &lt;/summary&gt;</p>
		</font>
		<p class="APICODE"><font SIZE="2" COLOR="#0000ff">Public</font> swApp
		<font SIZE="2" COLOR="#0000ff">As</font> SldWorks</p>
	</blockquote>
</blockquote>
<font SIZE="2" COLOR="#0000ff">
<p class="APICODE">End</font><font SIZE="2"> </font>
<font SIZE="2" COLOR="#0000ff">Class</p>
</font></font>

</body>

</html>
