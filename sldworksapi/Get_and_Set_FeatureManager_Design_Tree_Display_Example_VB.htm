<html>

<head>
<title>Get and Set FeatureManager Design Tree Display (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,FeatureManager design tree">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>
<h1>Get and Set FeatureManager Design Tree Display (VBA)</h1>
<p>This example shows how to get and set properties related to displaying 
the FeatureManager design tree.</p>

<pre>'----------------------------------------------------
' Preconditions:
' 1. Verify that the specified document exists.
' 2. Open the Immediate window.
'
' Postconditions:
' 1. Opens the assembly and gets the FeatureManager
'    design tree's display-related property values.
' 2. Examine both the Immediate window and the FeatureManager
'    design tree, then press F5.
' 3. Re-examine both the Immediate window the
'    FeatureManager design tree to verify the changes.
'
' NOTE: Because this assembly document is used
' elsewhere, do not save changes.
'----------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim swModelDoc As SldWorks.ModelDoc2
Dim swFeatMgr As SldWorks.FeatureManager
Dim document As String
Dim errors As Long
Dim warnings As Long</pre>
<pre>Sub main()</pre>
<pre>document = &quot;C:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2018\samples\tutorial\advdrawings\bladed shaft.sldasm&quot;</pre>
<pre>Set swApp = Application.SldWorks
Set swModelDoc = swApp.<b>OpenDoc6</b>(document, swDocASSEMBLY, swOpenDocOptions_Silent, &quot;&quot;, errors, warnings)
Set swFeatMgr = swModelDoc.<b>FeatureManager</b></pre>
<pre>Debug.Print &quot;----------------- Before changing FeatureManager design tree properties -----------------&quot;
Debug.Print &quot;View dependencies     = &quot; &amp; swFeatMgr.<b>ViewDependencies</b>
Debug.Print &quot;View features         = &quot; &amp; swFeatMgr.<b>ViewFeatures</b>
Debug.Print &quot;Show feature details  = &quot; &amp; swFeatMgr.<b>ShowFeatureDetails</b>
Debug.Print &quot;Show hierarchy only   = &quot; &amp; swFeatMgr.<b>ShowHierarchyOnly</b></pre>
<pre>Stop
' Examine the Immediate window and
' FeatureManager design tree before
' resuming the macro</pre>
<pre>' Change details, dependencies, hierarchy, and
' features-related properties
    If (swFeatMgr.<b>ViewDependencies</b>) Then
        swFeatMgr.<b>ViewFeatures</b> = True
    Else
        swFeatMgr.<b>ViewDependencies</b> = True
    End If    </pre>
<pre>    If (swFeatMgr.<b>ShowFeatureDetails</b>) Then
        swFeatMgr.<b>ShowHierarchyOnly</b> = True
    Else
        swFeatMgr.<b>ShowFeatureDetails</b> = True
    End If    </pre>
<pre>Debug.Print &quot;----------------- After changing FeatureManager design tree properties -----------------&quot;
Debug.Print &quot;View dependencies     = &quot; &amp; swFeatMgr.ViewDependencies
Debug.Print &quot;View features         = &quot; &amp; swFeatMgr.ViewFeatures
Debug.Print &quot;Show feature details  = &quot; &amp; swFeatMgr.ShowFeatureDetails
Debug.Print &quot;Show hierarchy only   = &quot; &amp; swFeatMgr.ShowHierarchyOnly</pre>
<pre>End Sub</pre>

<p>&nbsp;</p>

</body>

</html>
