<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Create Ruled Surface Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=938>
<meta name=layout-width content=611>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">

 <META NAME="MS-HKWD" CONTENT="VBA examples,surfaces">
 <META NAME="MS-HKWD" CONTENT="Ruled surfaces. See IRuledSurfaceFeatureData Interface">
</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Create Ruled Surface Example (VBA)</h1>

<p>This example shows how to create a ruled surface.</p>

<pre>'-------------------------------------------
' Preconditions:
' 1. Open a part that has two edges created
'    using b-curves.
' 2. Select those two edges.
' 3. Open the Immediate window.
'
' Postconditions:
' 1. Creates a ruled surface.
' 2. Examine the Immediate window.
'-------------------------------------------
Option Explicit</pre>
<pre>Sub main()</pre>
<pre>    Dim swApp As SldWorks.SldWorks
    Dim swModel As SldWorks.ModelDoc2
    Dim swModeler As SldWorks.Modeler
    Dim swSelMgr As SldWorks.SelectionMgr
    Dim swEdge(1) As SldWorks.Edge
    Dim swCurve(1) As SldWorks.Curve
    Dim nApex(2) As Double
    Dim vApex As Variant
    Dim swSurf As SldWorks.Surface</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModeler = swApp.<b>GetModeler</b>
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swEdge(0) = swSelMgr.<b>GetSelectedObject5</b>(1)
    Set swCurve(0) = swEdge(0).GetCurve
    Debug.Print &quot;Is b-curve? &quot; &amp; swCurve(0).<b>IsBcurve</b>
    Set swEdge(1) = swSelMgr.<b>GetSelectedObject5</b>(2)
    Set swCurve(1) = swEdge(1).<b>GetCurve</b>
    Debug.Print &quot;Is b-curve? &quot; &amp; swCurve(1).<b>IsBcurve</b>
    nApex(0) = 0#: nApex(1) = 0#: nApex(2) = 0#
    vApex = nApex
    Set swSurf = swModeler.<b>CreateRuledSurface</b>(swCurve(0), swCurve(1), (vApex))
    Debug.Print &quot;Type of surface? &quot; &amp; swSurf.<b>Identity</b>
    Debug.Print &quot;Is parametric? &quot; &amp; swSurf.<b>IsParametric</b></pre>
<pre>End Sub</pre>

</body>

</html>
