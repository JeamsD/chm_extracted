<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Set Spline Tangency and Curvature Controls Example (VBA)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="Splines,tangency">
<meta name=MS-HKWD content="Splines,curvature controls">
<meta name=MS-HKWD content="VBA examples,splines">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1165>
<meta name=layout-width content=786>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="./APIHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API Help</span></h1>

<h1>Set Spline Tangency and Curvature Controls Example (VBA)</h1>

<p>This example show how to set a spline's tangency and curvature controls.</p>

<pre>'-------------------------------------------------
' Preconditions:
' 1. Open a part containing a sketch of a spline.
' 2. Select the spline in the graphics area.
' 3. Open the Immediate window.
'
' Postconditions:
' 1. Sets the tangency and curvature control
'    for the specified points.
' 2. Examine the Immediate window.
'-------------------------------------------------
Option Explicit</pre>
<pre>Dim swApp As SldWorks.SldWorks
Dim swModel As SldWorks.ModelDoc2
Dim swSelMgr As SldWorks.SelectionMgr
Dim swModelDocExt As SldWorks.ModelDocExtension
Dim swSpline As SldWorks.SketchSpline
Dim swSplineH1 As SldWorks.SplineHandle
Dim swSplineH2 As SldWorks.SplineHandle
Dim boolstatus As Boolean</pre>
<pre>Sub main()</pre>
<pre>    Set swApp = Application.SldWorks
    Set swModel = swApp.<b>ActiveDoc</b>
    Set swSelMgr = swModel.<b>SelectionManager</b>
    Set swModelDocExt = swModel.<b>Extension</b>
    boolstatus = swModelDocExt.<b>SelectByID2</b>(&quot;Spline1&quot;, &quot;SKETCHSEGMENT&quot;, 0, 0, 0, False, 0, Nothing, 0)
    Set swSpline = swSelMgr.<b>GetSelectedObject6</b>(1, 0)</pre>
<pre>    ' Set tangency control; substitute coordinates of a point in your spline
    Set swSplineH1 = swSpline.<b>AddTangencyControl</b>(-48.92 / 1000, -5.07 / 1000, 0)
    Debug.Print &quot;Spline point number: &quot; &amp; swSplineH1.<b>SplinePointNumber</b>()</pre>
<pre>    ' Add curvature control; substitute coordinates of a point in your spline
    Set swSplineH2 = swSpline.<b>AddCurvatureControl</b>(6.3 / 1000, 15.075 / 1000, 0)
    Debug.Print &quot;Spline point number: &quot; &amp; swSplineH2.<b>SplinePointNumber</b>()

    ' Reset all handles    
    swSpline.<b>ResetAllHandles</b>
    ' Relax spline
    swSpline.<b>RelaxSpline</b></pre>
<pre>    swModel.<b>WindowRedraw</b></pre>
<pre>End Sub</pre>

</body>

</html>
