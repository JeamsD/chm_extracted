<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Create and Edit Circular Sketch Pattern Example (VB.NET)</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=MS-HKWD content="VB.NET examples,patterns">
<meta name=MS-HKWD content="VB.NET examples,sketch patterns">
<meta name=MS-HKWD content="VB.NET examples,circular sketch patterns">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=2060>
<meta name=layout-width content=931>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="ApiHelp.css">



</head>

<!--(Body)==========================================================-->


<body>

<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS API 
 Help</span></h1>

<h1>Create and Edit Circular Sketch Pattern Example (VB.NET)</h1>

<p>This example shows how to create and edit a circular sketch pattern.</p>

<p><font face="Courier New" size="2" color="#008000">'------------------------------------------------------------<br>
' Preconditions: Verify that the specified part document template<br>
' exists.<br>
'<br>
' Postconditions:<br>
' 1. Opens a new part document and creates a sketch.<br>
' 2. Inserts a circular sketch pattern of four instances.<br>
' 3. Closes the sketch.<br>
' 4. Opens the circular sketch pattern for editing.<br>
' 5. Deletes an instance of circular sketch pattern, leaving<br>
'&nbsp;&nbsp;&nbsp; three instances.<br>
' 6. Examine the graphics area.<br>
'------------------------------------------------------------<br>
</font><font face="Courier New" size="2">Imports SolidWorks.Interop.sldworks</font><font face="Courier New"><br>
<font size="2">Imports SolidWorks.Interop.swconst<br>
Imports System</font></font></p>

<p class=APICODE><font face="Courier New">Partial Class SolidWorksMacro</font></p>

<p class=APICODE><font face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Public 
 Sub main()</font></p>

<p class=APICODE><font face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swModel As ModelDoc2<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swModelDocExt As ModelDocExtension<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swSketchMgr As SketchManager<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 swSketchSegment As SketchSegment<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 vSkLines As Object<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 boolstatus As Boolean<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Dim 
 longstatus As Long</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Reset the counts for untitled documents for this macro<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">ResetUntitledCount</span>(0, 0, 0)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Create and activate a part document<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel 
 = swApp.<span style="font-weight: bold;">NewDocument</span>(&quot;C:\ProgramData\SOLIDWORKS\SOLIDWORKS 2008\templates\Part.prtdot&quot;, 
 0, 0, 0)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swApp.<span 
 style="font-weight: bold;">ActivateDoc2</span>(&quot;Part1&quot;, False, 
 longstatus)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel 
 = swApp.<span style="font-weight: bold;">ActiveDoc</span></font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swSketchMgr 
 = swModel.<span style="font-weight: bold;">SketchManager<br>
</span><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModelDocExt 
 = swModel.<span style="font-weight: bold;">Extension</span></font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Sketch a circle<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swSketchSegment 
 = swSketchMgr.<span style="font-weight: bold;">CreateCircle</span>(0.0#, 
 0.0#, 0.0#, 0.045549, 0.013926, 0.0#)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Clear any selections and change<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 the view orientation to Front<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel.<span 
 style="font-weight: bold;">ClearSelection2</span>(True)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel.<span 
 style="font-weight: bold;">ShowNamedView2</span>(&quot;*Front&quot;, 1)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Create a rectangle<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->vSkLines 
 = swSketchMgr.<span style="font-weight: bold;">CreateCornerRectangle</span>(-0.005867589431389, 
 0.03694408160504, 0, 0.004563680668858, 0.02673012963188, 0)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Create a circular sketch pattern <br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 using the rectangle<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->boolstatus 
 = swSketchMgr.<span style="font-weight: bold;">CreateCircularSketchStepAndRepeat</span>(0.03184378021964, 
 4.732863934409, 4, 1.570796326795, True, &quot;&quot;, True, True, True)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel.<span 
 style="font-weight: bold;">ClearSelection2</span>(True)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Close the sketch and rebuild<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swSketchMgr.<span 
 style="font-weight: bold;">InsertSketch</span>(True)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Select an entity in the circular sketch pattern<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 and open the circular sketch pattern to edit it<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->boolstatus 
 = swModelDocExt.<span style="font-weight: bold;">SelectByID2</span>(&quot;Line1@Sketch1&quot;, 
 &quot;EXTSKETCHSEGMENT&quot;, -0.002390499397973, 0.03694408160504, 0, 
 False, 0, Nothing, 0)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel.<span 
 style="font-weight: bold;">EditSketch</span>()</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 Delete an instance of the circular<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->' 
 sketch pattern and close the sketch<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->boolstatus 
 = swSketchMgr.<span style="font-weight: bold;">EditCircularSketchStepAndRepeat</span>(0.03184378021964, 
 4.732863934409, 3, 1.570796326795, True, &quot;&quot;, True, True, True, 
 &quot;Line2_Line1_Line4_Line3_&quot;)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swModel.<span 
 style="font-weight: bold;">ClearSelection2</span>(True)<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->swSketchMgr.<span 
 style="font-weight: bold;">InsertSketch</span>(True)</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->End 
 Sub</font></p>

<p class=APICODE><font face="Courier New"><br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->''' 
 &lt;summary&gt;</font></p>
<p class=APICODE><font face="Courier New"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->''' 
 The SldWorks swApp variable is pre-assigned for you.<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->''' 
 &lt;/summary&gt;<br>
<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Public 
 swApp As SldWorks</font></p>

<p class=APICODE><font face="Courier New"><br>
End Class</font></p>

</body>

</html>
