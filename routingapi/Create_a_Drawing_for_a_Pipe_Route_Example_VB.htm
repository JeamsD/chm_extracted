<html>

<head>
<title>Create a Drawing for a Pipe Route Example (VBA)</title>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="ApiHelp.css">
</head>
<meta name=MS-HKWD content="VBA examples,drawings">

<body>
<h1><span style="font-weight: normal; font-size: 7.5pt;">SOLIDWORKS Routing 
 API Help</span></h1>
<h1>Create a Drawing for a Pipe Route Example (VBA)</h1>
<p>This example shows how to create a drawing of a pipe assembly.</p>

<p class="APICODE">
<font size="2">
'---------------------------------------------------------------------------
<br>
' Preconditions:<br>
'&nbsp;1. Add SOLIDWORKS Routing as an add-in <br>
'&nbsp;&nbsp; (in SOLIDWORKS, 
select <b>Tools &gt; Add-Ins &gt; SOLIDWORKS routing</b>).<br>
'&nbsp;2. Add the <b>SOLIDWORKS</b> <i>&lt;version&gt;</i> <b>Routing Type 
Library </b>as a reference <br>
'&nbsp;&nbsp; (in the IDE select <b>Tools &gt; References</b>).<br>
'&nbsp;3. Create a piping BOM template named <b>
piping_template.sldbomtbt</b>.<br>
'&nbsp;4. Add a column with header &quot;Length&quot; to the piping BOM 
template.<br>
'&nbsp;5. Ensure that the specified paths to piping BOM and 
sheet <br>
'&nbsp;&nbsp;&nbsp; format templates exist.<br>
'&nbsp;6. In <b>Tools &gt; Options &gt; Routing &gt; Routing File 
Locations</b>,<br>
'&nbsp;&nbsp;&nbsp; add the locations of your SOLIDWORKS Routing files.<br>
'&nbsp;7. In <b>Tools &gt; Options &gt; File Locations &gt; Sheet 
formats</b>, <br>
'&nbsp;&nbsp;&nbsp; add the location of your sheet format templates.<br>
'&nbsp;8. Open:<br>
' <i>&nbsp;&nbsp; public_documents</i><b>\samples\tutorial\routing-pipes\fittings\reducerroute.sldasm</b>.<br>
'<br>
' Postconditions: A drawing of the pipe assembly is created <br>
' in a 
standard format and includes auto balloons, a bill of <br>
' materials, and a route 
sketch.<br>
'<br>
'&nbsp;<b>NOTE</b>: Because this assembly is used elsewhere,<br>
' do not save any changes to it.</font></p>
<p class="APICODE">
<font size="2">'-------------------------------------------------------------------------</font></p>
<p class="APICODE"><font size="2">Option Explicit<br>
<br>
Sub main()</font></p>
<blockquote>
	<p class="APICODE"><font size="2">Dim swApp As SldWorks.SldWorks</font></p>
	<p class="APICODE"><font size="2">Dim Part As SldWorks.AssemblyDoc</font></p>
	<p class="APICODE"><font size="2">Set swApp = Application.SldWorks</font></p>
	<p class="APICODE"><font size="2">Set Part = swApp.ActiveDoc<br>Dim RouteMgr As SWRoutingLib.RouteManager<br>Set RouteMgr = Part.GetRouteManager()<br>Dim bomtemplatepath As String<br>bomtemplatepath = &quot;<i>Piping_BOM_template_path</i>&quot;<br>Dim bomtemplatename As String<br>bomtemplatename = &quot;piping_template.sldbomtbt&quot;<br>Dim sheettemplatepath As String<br>sheettemplatepath = &quot;<i>install_dir</i>\lang\english\sheetformat&quot;<br>Dim sheettemplatename As String<br>sheettemplatename = &quot;a - landscape.slddrt&quot;<br>Dim insertballoons As Boolean<br>insertballoons = True<br>Dim insertBOM As Boolean<br>insertBOM = True<br>Dim showRouteSketch As Boolean<br>showRouteSketch = True<br>Dim subAssembly As Boolean<br>subAssembly = True<br>Dim userSheetWidth As Double<br>userSheetWidth = 500#<br>Dim userSheetHeight As Double<br>userSheetHeight = 500#<br>Dim displayFormat As Boolean<br>displayFormat = True<br>Dim dwgTemplates As Long<br>dwgTemplates = 0</font></p>
	<p class="APICODE"><font size="2">RouteMgr.<b>CreatePipeDrawingforPipeRoute</b>(bomtemplatepath, 
bomtemplatename, insertballoons, insertBOM, showRouteSketch, subAssembly, 
userSheetWidth, userSheetHeight, sheettemplatepath, sheettemplatename, 
displayFormat, dwgTemplates)</font></p>
</blockquote>
<p class="APICODE"><font size="2"><br>End Sub</font></p>

</body>

</html>
